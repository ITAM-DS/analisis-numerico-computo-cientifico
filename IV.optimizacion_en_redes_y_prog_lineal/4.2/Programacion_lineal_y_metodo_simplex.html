
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.2 Programación lineal (PL) y método símplex</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.3 Ejemplo del método símplex de redes" href="../4.3/Ejemplo_metodo_simplex_de_redes.html" />
    <link rel="prev" title="4.1 Definiciones generales de flujo en redes" href="../4.1/Definiciones_generales_de_flujo_en_redes.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.3/Ejemplo_metodo_simplex_de_redes.html">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.4/Dualidad.html">
   4.4 Dualidad
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Algoritmos de optimizacion convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.1/Puntos_interiores.html">
   5.1 Puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.2/Problemas_CECO.html">
   5.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.3/Problemas_CIECO.html">
   5.2 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/IV.optimizacion_en_redes_y_prog_lineal/4.2/Programacion_lineal_y_metodo_simplex.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/IV.optimizacion_en_redes_y_prog_lineal/4.2/Programacion_lineal_y_metodo_simplex.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#forma-estandar-de-un-pl">
   Forma estándar de un PL
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplo-de-flujo-en-redes">
   Ejemplo de flujo en redes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplo-prototipo">
   Ejemplo prototipo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modelo-de-pl">
   Modelo de PL
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#terminologia-en-pl">
     Terminología en PL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#formas-de-un-pl">
     Formas de un PL
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplo-metodo-grafico">
   Ejemplo: método gráfico
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tipo-de-soluciones-en-un-pl">
   Tipo de soluciones en un PL
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-que-le-llamamos-solucion-en-un-pl">
     ¿A qué le llamamos solución en un PL?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-mas-de-una-solucion-optima">
     Ejemplo: más de una solución óptima
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-pl-s-sin-solucion">
     Ejemplo: PL’s sin solución
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#metodo-simplex">
   Método símplex
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#soluciones-fev-y-nfev">
     Soluciones FEV y NFEV
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fev-adyacentes">
     FEV adyacentes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pasos-que-sigue-el-metodo-simplex">
     Pasos que sigue el método símplex
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#forma-aumentada-de-un-pl">
     Forma aumentada de un PL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#soluciones-bf-adyacentes">
     Soluciones BF adyacentes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables-basicas-y-no-basicas">
     Variables básicas y no básicas
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#variables-basicas-no-degeneradas-y-degeneradas">
     Variables básicas no degeneradas y degeneradas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplo-del-metodo-simplex">
   Ejemplo del método símplex
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#paso-inicial">
     Paso inicial
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prueba-de-optimalidad">
     Prueba de optimalidad
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prueba-del-cociente-minimo">
     Prueba del cociente mínimo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prueba-del-cociente-minimo-forma-general-y-con-notacion-matricial-y-vectorial">
     Prueba del cociente mínimo: forma general y con notación matricial y vectorial
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#actualizacion-del-vector-x-b">
     Actualización del vector
     <span class="math notranslate nohighlight">
      \(x_B\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iteracion-1">
     Iteración 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Prueba de optimalidad
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Prueba del cociente mínimo
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iteracion-2">
     Iteración 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Prueba de optimalidad
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#consideraciones-sobre-el-metodo-simplex">
   Consideraciones sobre el método símplex
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pl-s-large-scale">
   PL’s
   <em>
    large scale
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#enunciado-de-un-ejemplo-para-un-problema-large-scale">
     Enunciado de un ejemplo para un problema
     <em>
      large scale
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#unas-palabras-sobre-pl-entera-y-metodos">
   Unas palabras sobre PL entera y métodos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo-prototipo-de-peb">
     Ejemplo prototipo de PEB
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#el-modelo-peb">
     El modelo PEB
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#consideraciones-sobre-los-modelos-de-pe">
     Consideraciones sobre los modelos de PE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sobre-algoritmos-de-pe">
     Sobre algoritmos de PE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sobre-metodos-heuristicos-en-optimizacion-combinatoria">
     Sobre métodos heurísticos en optimización combinatoria
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplos-vehicle-routing-problem-aka-vrp-y-travelling-salesman-problem-aka-tsp">
     Ejemplos:
     <em>
      Vehicle routing problem
     </em>
     ,
     <em>
      aka VRP
     </em>
     , y
     <em>
      Travelling Salesman Problem
     </em>
     ,
     <em>
      aka TSP
     </em>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplos-de-algoritmos-heuristicos-o-meta-heuristicas">
     Ejemplos de algoritmos heurísticos o meta heurísticas
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="programacion-lineal-pl-y-metodo-simplex">
<span id="proglineal"></span><h1>4.2 Programación lineal (PL) y método símplex<a class="headerlink" href="#programacion-lineal-pl-y-metodo-simplex" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion_2</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li><p>Conocerá el modelo de programación lineal, su interpretación y diferentes formas del mismo.</p></li>
<li><p>Comprenderá el método gráfico y aspectos esenciales del método de símplex para resolver programas lineales.</p></li>
</ul>
</div>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia …</p>
<p>El desarrollo de la programación lineal (PL) ha sido clasificado como uno de los avances científicos más importantes de mediados del siglo XX. Es quizás el modelo prototipo de la optimización con restricciones. El efecto que ha tenido en la práctica y en áreas del conocimiento desde 1950 es en verdad grande. El tipo más común de aplicación abarca el problema general de asignar de la mejor manera posible, esto es, de forma óptima, recursos limitados a actividades que compiten entre sí por ellos. Con más precisión, se desea elegir el nivel de ciertas actividades que compiten por recursos escasos necesarios para realizarlas y se puedan asignar recursos a tales actividades. El desarrollo por Dantzig del método símplex para resolver programas lineales en los <span class="math notranslate nohighlight">\(40\)</span>’s marcó el inicio de la era moderna en optimización.</p>
<p>La PL utiliza un modelo matemático para describir el problema. El adjetivo lineal significa que todas las funciones del modelo deben ser funciones lineales. En este caso, la palabra programación no se refiere a términos computacionales; en esencia es sinónimo de planeación. Por lo tanto, la PL involucra la planeación de actividades para obtener un resultado óptimo; esto es, el resultado que mejor alcance la meta establecida, de acuerdo con el modelo matemático, entre todas las alternativas factibles.</p>
<p>Aunque la asignación de recursos a las actividades es la aplicación más frecuente en PL, cualquier problema cuyo  modelo se ajuste al formato general del modelo de PL, es un problema de PL.</p>
</div>
<div class="section" id="forma-estandar-de-un-pl">
<span id="formaestpl"></span><h2>Forma estándar de un PL<a class="headerlink" href="#forma-estandar-de-un-pl" title="Permalink to this headline">¶</a></h2>
<p>Un programa lineal (PL) <strong>en su forma estándar</strong> es un problema de optimización con una función lineal objetivo, un conjunto de restricciones lineales de igualdad y un conjunto de restricciones no negativas impuestas a las variables. Es un <strong>modelo de optimización</strong> de la forma:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[Ax=b\]</div>
<div class="math notranslate nohighlight">
\[x \geq 0\]</div>
<p>donde: <span class="math notranslate nohighlight">\(c \in \mathbb{R}^n\)</span> es un vector de costos, <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span>, se <strong>asume</strong> <span class="math notranslate nohighlight">\(m \leq n\)</span> y tiene <em>rank</em> completo por renglones y la última desigualdad se refiere a que todas las componentes del vector <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span> son mayores o iguales a cero. La función objetivo es <span class="math notranslate nohighlight">\(f_o(x) = c^Tx\)</span> y se busca minimizar el costo. El modelo anterior realiza suposiciones como son: proporcionalidad y aditividad para la función objetivo y restricciones. Tales supuestos se deben mantener respecto a las variables en <span class="math notranslate nohighlight">\(x\)</span>. La proporcionalidad se resume en que los exponentes de cada componente de <span class="math notranslate nohighlight">\(x\)</span> deben ser igual a uno y la aditividad en cuanto a que las contribuciones individuales de las componentes de <span class="math notranslate nohighlight">\(x\)</span> es su suma en la función objetivo y restricciones.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El PL es un problema convexo pues una función lineal es convexa y cóncava al mismo tiempo. Obsérvese que la forma estándar de un problema convexo pide que el problema se escriba con desigualdades del tipo <span class="math notranslate nohighlight">\(\leq\)</span>. Tal forma se puede obtener si se definen <span class="math notranslate nohighlight">\(h(x) = Ax-b\)</span>, <span class="math notranslate nohighlight">\(f(x) = -x\)</span> con <span class="math notranslate nohighlight">\(x \in \mathbb{R}^n\)</span>, ver <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html#proboptconvest"><span class="std std-ref">problemas de optimización convexa en su forma estándar o canónica</span></a>.</p>
</div>
</div>
<div class="section" id="ejemplo-de-flujo-en-redes">
<span id="ejflujoenredesypl"></span><h2>Ejemplo de flujo en redes<a class="headerlink" href="#ejemplo-de-flujo-en-redes" title="Permalink to this headline">¶</a></h2>
<p>Considérese el problema de satisfacer el flujo neto de todos los nodos con etiquetas “A, B, C, D” y “E” de la siguiente red de acuerdo a las capacidades de cada uno de ellos al menor costo posible:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pprint</span>

<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">linprog</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes_pos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.18181818181818182</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.18181818181818182</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.36363636363636365</span><span class="p">,</span> <span class="mf">0.5454545454545454</span><span class="p">]]</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>

<span class="n">nodes_and_pos</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">nodes_pos</span><span class="p">))</span>

<span class="n">G_min_cost_flow</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;A [50]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;B [40]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>   <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;C [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;D [-30]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;E [-60]&quot;</span><span class="p">)</span>

<span class="n">edge_labels_min_cost_flow</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
                            <span class="p">}</span>


<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_labels_min_cost_flow</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
        <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                       <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                             <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels_min_cost_flow</span><span class="p">,</span> <span class="n">label_pos</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                             <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">nodes_pos_modified</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">y_off</span> <span class="o">=</span> <span class="mf">0.03</span>

<span class="n">nodes_and_pos_modified</span> <span class="o">=</span> <span class="n">nodes_and_pos</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_off</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_off</span><span class="p">]</span>
        
    
<span class="n">labels</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos_modified</span><span class="p">,</span> 
                        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                       <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_16_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_16_0.png" />
</div>
</div>
<p>En la red anterior el arco <span class="math notranslate nohighlight">\((D, E)\)</span> tiene costo igual a <span class="math notranslate nohighlight">\(3\)</span> y el arco <span class="math notranslate nohighlight">\((E, D)\)</span> tiene costo igual a <span class="math notranslate nohighlight">\(2\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Obsérvese que es ligeramente distinta la nomenclatura de este problema en cuanto a los términos de flujo neto y demanda que tiene un nodo de acuerdo a lo que se describió en el <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#ejredflujocostomin"><span class="std std-ref">ejemplo de flujo de costo mínimo</span></a></p>
</div>
<p>Al lado de cada nodo en corchetes se presenta el flujo neto generado por el nodo. Los nodos origen tienen un flujo neto positivo y en la red son los nodos “A” y “B” (por ejemplo fábricas). Los nodos destino tienen un flujo neto negativo que en la red son los nodos “D” y “E” (por ejemplo clientes). El único nodo de transbordo es el nodo “C” que tiene flujo neto igual a cero (centro de distribución por ejemplo). Los valores de los costos se muestran en los arcos. Es una red sin capacidades.</p>
<p>Entonces el modelo de PL que minimiza el costo de transferencia de flujo de modo que el <strong>flujo neto</strong> satisfaga lo representado en la red, considerando el flujo neto como el flujo total que sale del nodo menos el flujo total que entra al nodo es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min 2 x_{AB} + 4 x_{AC} + 9 x_{AD} + 3 x_{BC} + x_{CE} + 3 x_{DE} + 2x_{ED}\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
&amp;x_{AB}&amp;  + &amp;x_{AC}&amp; + &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 50 \nonumber \\
&amp;-x_{AB}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{BC}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 40 \nonumber \\
&amp;&amp;        - &amp;x_{AC}&amp;   &amp;&amp;       - &amp;x_{BC}&amp; + &amp;x_{CE}&amp;   &amp;&amp;         &amp;&amp;       &amp;=&amp; 0 \nonumber \\
&amp;&amp;          &amp;&amp;       - &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{DE}&amp; - &amp;x_{ED}&amp; &amp;=&amp; -30 \nonumber \\
&amp;&amp;          &amp;&amp;         &amp;&amp;         &amp;&amp;       - &amp;x_{CE}&amp; - &amp;x_{DE}&amp; + &amp;x_{ED}&amp; &amp;=&amp; -60 \nonumber
\end{eqnarray}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[x_{ij} \geq 0 \forall i,j\]</div>
<p>La primer restricción de igualdad representa el flujo neto para el nodo <span class="math notranslate nohighlight">\(A\)</span> y la última el flujo neto para el nodo <span class="math notranslate nohighlight">\(E\)</span>. A tales ecuaciones de las restricciones de igualdad se les conoce con el nombre de <strong>ecuaciones de conservación de flujo</strong>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que la matriz que representa a las restricciones de igualdad es la matriz de incidencia nodo-arco.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Multiplicamos por <span class="math notranslate nohighlight">\(-1\)</span> pues el resultado de la función <code class="docutils literal notranslate"><span class="pre">incidence_matrix</span></code> está volteado respecto a la definición de la matriz de incidencia nodo-arco.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">nx</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.  1.  1.  0.  0.  0.  0.]
 [-1.  0.  0.  1.  0.  0.  0.]
 [ 0. -1.  0. -1.  1.  0.  0.]
 [ 0.  0. -1.  0.  0.  1. -1.]
 [ 0.  0.  0.  0. -1. -1.  1.]]
</pre></div>
</div>
</div>
</div>
<p>El problema anterior lo podemos resolver directamente con <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.linprog.html#scipy-optimize-linprog">scipy-optimize-linprog</a> que es una función que resuelve PL’s:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">A_eq</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">nx</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A_eq</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.  1.  1.  0.  0.  0.  0.]
 [-1.  0.  0.  1.  0.  0.  0.]
 [ 0. -1.  0. -1.  1.  0.  0.]
 [ 0.  0. -1.  0.  0.  1. -1.]
 [ 0.  0.  0.  0. -1. -1.  1.]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> 
                                <span class="s2">&quot;netflow&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Cada tupla hace referencia a las cotas inferiores y superiores que tiene cada variable.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">linprog</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq</span><span class="p">,</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     con: array([ 1.23415534e-06,  1.05034484e-06,  2.62587889e-08, -7.61500058e-07,
       -1.54925893e-06])
     fun: 469.9999898969424
 message: &#39;Optimization terminated successfully.&#39;
     nit: 5
   slack: array([], dtype=float64)
  status: 0
 success: True
       x: array([3.62017054e-07, 4.99999977e+01, 7.19274437e-07, 3.99999993e+01,
       8.99999970e+01, 3.55827520e-09, 2.99999985e+01])
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: OptimizeWarning: A_eq does not appear to be of full row rank. To improve performance, check the problem formulation for redundant equality constraints.
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Los <em>solvers</em> son paquetes de software para resolver modelos de programación lineal y modelos relacionados que se encuentran en los lenguajes de modelado.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se instala <a class="reference external" href="http://cvxopt.org/userguide/intro.html">cvxopt</a>, un paquete de <em>Python</em> para resolver problemas de optimización convexa que ya trae el <em>solver</em> GLPK, ver <a class="reference external" href="https://www.cvxpy.org/install/#install-with-cvxopt-and-glpk-support">cvxpy: install-with-cvxopt-and-glpk-support</a>.</p>
</div>
<p>También con <code class="docutils literal notranslate"><span class="pre">cvxpy</span></code> podemos resolver el PL anterior. Para mostrar la flexibilidad que tienen los lenguajes de modelado como <code class="docutils literal notranslate"><span class="pre">cvxpy</span></code> se define <span class="math notranslate nohighlight">\(x\)</span> como variable entera. <code class="docutils literal notranslate"><span class="pre">cvxpy</span></code> puede resolver este tipo de problemas si se instala el <em>solver</em> <a class="reference external" href="https://www.gnu.org/software/glpk/glpk.html">GLPK</a>  :</p>
<div class="cell tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install --quiet cvxopt
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Yellow">WARNING: You are using pip version 20.3.3; however, version 21.0.1 is available.</span>
<span class=" -Color -Color-Yellow">You should consider upgrading via the &#39;/usr/bin/python3 -m pip install --upgrade pip&#39; command.</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Ver <a class="reference external" href="https://www.cvxpy.org/examples/basic/linear_program.html">cvxpy: linear_program</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cvxpy</span> <span class="k">as</span> <span class="nn">cp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="ne">RuntimeError</span>: module compiled against API version 0xe but this version of numpy is 0xd
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span> <span class="c1">#number of variables</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1">#x as integer optimization variable</span>
<span class="n">fo_cvxpy</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">T</span><span class="nd">@x</span> <span class="c1">#objective function</span>

<span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span><span class="n">A_eq</span><span class="nd">@x</span> <span class="o">==</span> <span class="n">b</span><span class="p">,</span>
               <span class="n">x</span> <span class="o">&gt;=</span><span class="mi">0</span>
               <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">opt_objective</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">fo_cvxpy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prob</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">opt_objective</span><span class="p">,</span> <span class="n">constraints</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">prob</span><span class="o">.</span><span class="n">solve</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>470.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print result.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The optimal value is&quot;</span><span class="p">,</span> <span class="n">prob</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A solution x is&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The optimal value is 470.0
A solution x is
[ 0. 50.  0. 40. 90.  0. 30.]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ejemplo-prototipo">
<span id="ejprototipo"></span><h2>Ejemplo prototipo<a class="headerlink" href="#ejemplo-prototipo" title="Permalink to this headline">¶</a></h2>
<p>Supóngase que una compañía tiene tres plantas en las que se producen dos productos. La compañía nos entrega los siguientes datos relacionados con:</p>
<ol class="simple">
<li><p>Número de horas de producción disponibles por semana en cada planta para fabricar estos productos.</p></li>
<li><p>Número de horas de fabricación para producir cada lote de los productos.</p></li>
<li><p>La ganancia por lote de cada producto.</p></li>
</ol>
<p>Lo anterior se resume en la siguiente tabla:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p>Tiempo de producción por lote en horas</p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>Planta</p></td>
<td class="text-align:center"><p>Producto 1</p></td>
<td class="text-align:center"><p>Producto 2</p></td>
<td class="text-align:center"><p>Tiempo de producción disponible a la semana en horas</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>4</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>12</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>18</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Ganancia por lote</p></td>
<td class="text-align:center"><p>3000</p></td>
<td class="text-align:center"><p>5000</p></td>
<td class="text-align:center"><p></p></td>
</tr>
</tbody>
</table>
<p>La tabla anterior indica por ejemplo en su primer renglón que cada lote del producto 1 que se produce por semana emplea una hora de producción en la planta 1 y sólo se dispone de 4 horas semanales (<strong>recursos disponibles</strong>). Como se lee en la tabla, cada producto se fabrica en lotes de modo que la tasa de producción está definida como el número de lotes que se producen a la semana.</p>
<p>Obsérvese que el producto 1 requiere parte de la capacidad de producción en las plantas 1, 3 y nada en la planta 2. El producto 2 necesita trabajo en las plantas 2 y 3. Por lo anterior no está claro cuál <strong>mezcla de productos</strong> sería la más rentable.</p>
<p>Se permite cualquier combinación de tasas de producción que satisfaga estas restricciones, incluso no fabricar uno de los productos y elaborar todo lo que sea posible del otro. La tasa de producción está definida como el número de lotes que se producen a la semana.</p>
<p>Se desea determinar cuáles tasas de producción (no negativas) deben tener los dos productos con el fin de maximizar las <strong>ganancias</strong> totales sujetas a las restricciones impuestas por las capacidades de producción limitadas disponibles en las tres plantas.</p>
<p>Se asume que las plantas únicamente destinan su producción a estos dos productos y la ganancia incremental de cada lote adicional producido es constante sin importar el número total de lotes producidos. La ganancia total de cada producto es aproximadamente la ganancia por lote que se produce multiplicada por el número de lotes.</p>
<p>Se modela el problema anterior como un PL con las siguientes variables:</p>
<p><span class="math notranslate nohighlight">\(x_1\)</span>: número de lotes del producto 1 que se fabrican por semana.</p>
<p><span class="math notranslate nohighlight">\(x_2\)</span>: número de lotes del producto 2 que se fabrican por semana.</p>
<p><span class="math notranslate nohighlight">\(f_o(x_1, x_2)\)</span>: ganancia semanal total (en miles de pesos) que generan estos dos productos.</p>
<p>Se debe resolver el PL siguiente:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<p>El término <span class="math notranslate nohighlight">\(3x_1\)</span> representa la ganancia generada (en miles de pesos) cuando se fabrica el producto 1 a una tasa de <span class="math notranslate nohighlight">\(x_1\)</span> lotes por semana. Se tienen contribuciones individuales de cada producto a la ganancia.</p>
</div>
<div class="section" id="modelo-de-pl">
<h2>Modelo de PL<a class="headerlink" href="#modelo-de-pl" title="Permalink to this headline">¶</a></h2>
<p>Algunas características generales de los problemas de PL se presentan a continuación</p>
<div class="section" id="terminologia-en-pl">
<h3>Terminología en PL<a class="headerlink" href="#terminologia-en-pl" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Ejemplo prototipo</p></th>
<th class="text-align:center head"><p>Problema general</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>Capacidad  producción de las plantas</p></td>
<td class="text-align:center"><p>Recursos</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>3 plantas</p></td>
<td class="text-align:center"><p>m recursos</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Fabricación de productos</p></td>
<td class="text-align:center"><p>Actividades</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2 productos</p></td>
<td class="text-align:center"><p>n actividades</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>Tasa de producción del producto</p></td>
<td class="text-align:center"><p>Nivel de la actividad</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>Ganancia</p></td>
<td class="text-align:center"><p>Medida global de desempeño</p></td>
</tr>
</tbody>
</table>
<p>Y en la terminología del problema general se desea determinar la asignación de recursos a ciertas actividades. Lo anterior implica elegir los niveles de las actividades (puntos óptimos) que lograrán el mejor valor posible (valor óptimo) de la medida global de desempeño.</p>
<p>En el PL:</p>
<p><span class="math notranslate nohighlight">\(f_o\)</span>: valor de la medida global de desempeño (función objetivo).</p>
<p><span class="math notranslate nohighlight">\(x_j\)</span>: nivel de la actividad <span class="math notranslate nohighlight">\(j\)</span> con <span class="math notranslate nohighlight">\(j=1, 2, \dots, n\)</span>. También se les conoce con el nombre de variables de decisión (variables de optimización).</p>
<p><span class="math notranslate nohighlight">\(c_j\)</span>: incremento en <span class="math notranslate nohighlight">\(f_o\)</span> que se obtiene al aumentar una unidad en el nivel de la actividad j.</p>
<p><span class="math notranslate nohighlight">\(b_i\)</span>: cantidad de recurso <span class="math notranslate nohighlight">\(i\)</span> disponible para asignarse a las actividades con <span class="math notranslate nohighlight">\(i=1, 2, \dots, m\)</span>.</p>
<p><span class="math notranslate nohighlight">\(a_{ij}\)</span>: cantidad del recurso <span class="math notranslate nohighlight">\(i\)</span> consumido por cada unidad de la actividad <span class="math notranslate nohighlight">\(j\)</span>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Los valores de <span class="math notranslate nohighlight">\(c_j, b_i, a_{ij}\)</span> son las constantes o parámetros del modelo.</p>
</div>
</div>
<div class="section" id="formas-de-un-pl">
<h3>Formas de un PL<a class="headerlink" href="#formas-de-un-pl" title="Permalink to this headline">¶</a></h3>
<p>Es posible que se encuentren con PL en diferentes formas por ejemplo:</p>
<p>1.Minimizar en lugar de maximizar la función objetivo.</p>
<p>2.Restricciones con desigualdad en sentido mayor, menor o igual que.</p>
<p>3.Restricciones en forma de igualdad.</p>
<p>4.Variables de decisión sin la restricción de no negatividad (variables libres).</p>
<p>Pero siempre que se cumpla con que la función objetivo y las restricciones son funciones lineales entonces tal problema se clasifica como un PL.</p>
</div>
</div>
<div class="section" id="ejemplo-metodo-grafico">
<span id="ejmetgraficopl"></span><h2>Ejemplo: método gráfico<a class="headerlink" href="#ejemplo-metodo-grafico" title="Permalink to this headline">¶</a></h2>
<p>A continuación se muestra un procedimiento gráfico para resolver el PL del ejemplo prototipo. Esto es posible realizar pues tenemos sólo dos variables. Se tomará <span class="math notranslate nohighlight">\(x_1\)</span> como el eje horizontal y <span class="math notranslate nohighlight">\(x_2\)</span> el eje vertical.</p>
<p>Recordando las variables del ejemplo prototipo:</p>
<p><span class="math notranslate nohighlight">\(x_1\)</span>: número de lotes del producto 1 que se fabrican por semana.</p>
<p><span class="math notranslate nohighlight">\(x_2\)</span>: número de lotes del producto 2 que se fabrican por semana.</p>
<p><span class="math notranslate nohighlight">\(f_o(x_1, x_2)\)</span>: ganancia semanal total (en miles de pesos) que generan estos dos productos.</p>
<p>Y el PL es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<p>Entonces se tiene la siguiente región definida por las desigualdades del PL:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#x_1 ≤ 4</span>

<span class="n">point1_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point2_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point1_point2_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_1</span><span class="p">,</span> <span class="n">point2_x_1</span><span class="p">))</span>

<span class="c1">#x_1 ≥ 0</span>
<span class="n">point3_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point3_point4_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_1</span><span class="p">,</span> <span class="n">point4_x_1</span><span class="p">))</span>

<span class="c1">#2x_2 ≤ 12 or x_2 ≤ 6</span>

<span class="n">point1_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point2_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point1_point2_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_2</span><span class="p">,</span> <span class="n">point2_x_2</span><span class="p">))</span>

<span class="c1">#x_2 ≥ 0</span>

<span class="n">point3_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point3_point4_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_2</span><span class="p">,</span> <span class="n">point4_x_2</span><span class="p">))</span>

<span class="c1">#3x_1 + 2x_2 ≤ 18</span>

<span class="n">x_1_region_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_region_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1_region_1</span><span class="p">)</span>


<span class="n">x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_80_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_80_0.png" />
</div>
</div>
<p>La región sombreada es la región factible. Cualquier punto que se elija en la región factible satisface las desigualdades definidas en el PL. Ahora tenemos que seleccionar dentro de la región factible el punto que maximiza el valor de la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span>.</p>
<p>El procedimiento gráfico consiste en dar a <span class="math notranslate nohighlight">\(f_o\)</span> algún valor arbitrario, dibujar la recta definida por tal valor  y “mover tal recta de forma paralela” en la dirección que <span class="math notranslate nohighlight">\(f_o\)</span> crece (si se desea maximizar y en la dirección en la que <span class="math notranslate nohighlight">\(f_o\)</span> decrece si se desea minimizar) hasta que se mantenga en la región factible.</p>
<p>Para la función objetivo del PL anterior queda como sigue:</p>
<div class="math notranslate nohighlight">
\[y = f(x) = 3x_1 + 5x_2\]</div>
<p>y vamos dando valores arbitrarios a <span class="math notranslate nohighlight">\(y\)</span>:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Todas las rectas tienen la misma pendiente por lo que son paralelas. Cada una de las rectas son las curvas de nivel de <span class="math notranslate nohighlight">\(f_o\)</span></p>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>

<span class="n">x_1_line_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_line_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_1</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">x_1_line_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_line_2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_2</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>

<span class="n">x_1_line_3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_line_3</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x_1_line_3</span> <span class="o">+</span> <span class="mi">36</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1_line_1</span><span class="p">,</span> <span class="n">x_2_line_1</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
         <span class="n">x_1_line_2</span><span class="p">,</span> <span class="n">x_2_line_2</span><span class="p">,</span> <span class="s2">&quot;indigo&quot;</span><span class="p">,</span>
         <span class="n">x_1_line_3</span><span class="p">,</span> <span class="n">x_2_line_3</span><span class="p">,</span> <span class="s2">&quot;darkturquoise&quot;</span>
         <span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$10 = 3x_1 + 5x_2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$20 = 3x_1 + 5x_2$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$36 = 3x_1 + 5x_2$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_84_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_84_0.png" />
</div>
</div>
<p>Si realizamos este proceso para valores de <span class="math notranslate nohighlight">\(y\)</span> iguales a <span class="math notranslate nohighlight">\(36, 20, 10\)</span> observamos que la recta que da el mayor valor de la <span class="math notranslate nohighlight">\(f_o\)</span> y que se mantiene en la región factible es aquella con valor <span class="math notranslate nohighlight">\(y_1= f(x) = 36\)</span>. Corresponde a la pareja <span class="math notranslate nohighlight">\((x_1, x_2) = (2, 6)\)</span> y es la <strong>solución óptima</strong>. Entonces produciendo los productos <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(2\)</span> a una tasa de <span class="math notranslate nohighlight">\(2\)</span> y <span class="math notranslate nohighlight">\(6\)</span> lotes por semana se maximiza la ganancia siendo de 36 mil pesos. No existen otras tasas de producción que sean tan redituables como la anterior de acuerdo con el modelo.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El método gráfico anterior sólo funciona para dos o tres dimensiones.</p></li>
<li><p>El gradiente de la función objetivo nos indica la dirección de máximo crecimiento de <span class="math notranslate nohighlight">\(f_o\)</span>. En el ejemplo anterior <span class="math notranslate nohighlight">\(\nabla f_o(x) = \left [ \begin{array}{c} 3 \\ 5 \end{array} \right ]\)</span> y tal vector apunta hacia la derecha y hacia arriba. Entonces en esa dirección es hacia donde desplazamos las rectas paralelas.</p></li>
<li><p>La región factible que resultó en el ejemplo anterior se le conoce con el nombre de poliedro y es un conjunto convexo (en dos dimensiones se le nombra polígono). Es una intersección finita entre hiperplanos y semi espacios, también puede pensarse como el conjunto solución de un número finito de ecuaciones y desigualdades lineales.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Si se utiliza un PL con otras formas diferentes a la del ejemplo (por ejemplo variables libres en lugar de no negativas) es posible que la interpretación de “asignación de recursos limitados entre actividades que compiten” puede ya no aplicarse muy bien; pero sin importar cuál sea la interpretación o el contexto, lo único necesario es que la formulación matemática del problema se ajuste a las formas permitidas.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Resuelve con el método gráfico el siguiente PL:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 2x_1 + x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_2 \leq 10\]</div>
<div class="math notranslate nohighlight">
\[2x_1 + 5x_2 \leq 60\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + x_2 \leq 44\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<p>Marca al gradiente de la función objetivo en la gráfica.</p>
</div>
</div>
<div class="section" id="tipo-de-soluciones-en-un-pl">
<h2>Tipo de soluciones en un PL<a class="headerlink" href="#tipo-de-soluciones-en-un-pl" title="Permalink to this headline">¶</a></h2>
<p>Los puntos factibles que resultan de la intersección entre las rectas del ejemplo anterior que corresponden a las desigualdades se les nombra <strong>soluciones factibles en un vértice (FEV)</strong> (se encuentran en una esquina). Las soluciones FEV <strong>no</strong> son una combinación convexa estricta entre puntos distintos del poliedro (no caen en algún segmento de línea formado por dos puntos distintos).</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>También a las soluciones FEV se les conoce como <strong>puntos extremos</strong> pero resulta más sencillo recordar FEV.</p>
</div>
<p>El método gráfico en la región anterior ilustra una <strong>propiedad importante</strong> de los PL con soluciones factibles y una región acotada: siempre tiene soluciones FEV y al menos una solución óptima, aún más, la mejor solución en un FEV debe ser una solución óptima.</p>
<div class="section" id="a-que-le-llamamos-solucion-en-un-pl">
<h3>¿A qué le llamamos solución en un PL?<a class="headerlink" href="#a-que-le-llamamos-solucion-en-un-pl" title="Permalink to this headline">¶</a></h3>
<p>Cualquier conjunto de valores de las variables de decisión (<span class="math notranslate nohighlight">\(x_1, x_2, \dots, x_n\)</span>) se le nombra una solución y se identifican dos tipos:</p>
<ul class="simple">
<li><p>Una solución factible es aquella para la cual todas las restricciones se satisfacen.</p></li>
<li><p>Una solución no factible es aquella para la cual al menos una restricción no se satisface.</p></li>
</ul>
<p>En el ejemplo los puntos <span class="math notranslate nohighlight">\((2,3)\)</span> y <span class="math notranslate nohighlight">\((4,1)\)</span> son soluciones factibles y <span class="math notranslate nohighlight">\((-1, 3), (4,4)\)</span> son soluciones no factibles.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;Solución factible&quot;</span><span class="p">,</span> <span class="s2">&quot;Solución factible&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Solución no factible&quot;</span><span class="p">,</span> <span class="s2">&quot;Solución no factible&quot;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Tipos de soluciones en un PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_96_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_96_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>“Valor más favorable de la función objetivo” depende si se tiene un problema de maximización o minimización.</p>
</div>
<p>De las soluciones factibles se busca aquella solución óptima (puede haber más de una) que nos dé el valor “más favorable” (valor óptimo) de la función objetivo.</p>
</div>
<div class="section" id="ejemplo-mas-de-una-solucion-optima">
<h3>Ejemplo: más de una solución óptima<a class="headerlink" href="#ejemplo-mas-de-una-solucion-optima" title="Permalink to this headline">¶</a></h3>
<p>Es posible tener más de una solución óptima, por ejemplo si la función objetivo hubiera sido <span class="math notranslate nohighlight">\(f_o(x) = 3x_1 + 2x_2\)</span> entonces:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">point4</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">point5</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">point4_point5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point4</span><span class="p">,</span> <span class="n">point5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point4_point5</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point4_point5</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> 
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;darkred&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$18 = f_o(x) = 3x_1 + 2x_2$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_101_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_101_0.png" />
</div>
</div>
<p>El segmento de recta que va de <span class="math notranslate nohighlight">\((2,6)\)</span> a <span class="math notranslate nohighlight">\((4,3)\)</span> (en línea punteada) son soluciones óptimas. Tal segmento es la curva de nivel de <span class="math notranslate nohighlight">\(f_o(x)\)</span> con el valor <span class="math notranslate nohighlight">\(18\)</span>. Cualquier PL que tenga soluciones óptimas múltiples tendrá un número infinito de ellas, todas con el mismo valor óptimo.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si un PL tiene exactamente una solución óptima, ésta debe ser una solución FEV. Si tiene múltiples soluciones óptimas, al menos dos deben ser soluciones FEV. Por esto para resolver problemas de PL sólo tenemos que considerar un número finito de soluciones.</p>
</div>
</div>
<div class="section" id="ejemplo-pl-s-sin-solucion">
<h3>Ejemplo: PL’s sin solución<a class="headerlink" href="#ejemplo-pl-s-sin-solucion" title="Permalink to this headline">¶</a></h3>
<p>Es posible que el PL no tenga soluciones óptimas lo cual ocurre sólo si:</p>
<p>1.No tiene soluciones factibles y se le nombra PL <strong>no factible</strong>.</p>
<p>2.Las restricciones no impiden que el valor de la función objetivo mejore indefinidamente en la dirección favorable. En este caso se tiene un PL con función objetivo no acotada y se le nombra PL <strong>no acotado</strong>.</p>
<p>Un ejemplo de un PL no factible pues su región factible es vacía se obtiene al añadir la restricción <span class="math notranslate nohighlight">\(3x_1+ 5x_2 \geq 50\)</span> a las restricciones anteriores:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#3x_1 + 5x_2 ≥ 50</span>

<span class="n">x_1_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_b</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">50</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1_b</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span>
         <span class="n">x_1_b</span><span class="p">,</span> <span class="n">x_2_b</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1 + 5x_2 = 50$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_b</span><span class="p">,</span> <span class="n">x_2_b</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;No existe solución factible&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_107_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_107_0.png" />
</div>
</div>
<p>La intersección entre las dos regiones sombreadas es vacía.</p>
<p>Un ejemplo de un PL no acotado resulta de sólo considerar las restricciones <span class="math notranslate nohighlight">\(x_1 \leq 4, x_1 \geq 0, x_2 \geq 0\)</span>:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">11</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">points</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>


<span class="n">x_1_region</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible no acotada&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_110_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_110_0.png" />
</div>
</div>
<p>Se observa en la gráfica anterior que se tiene una región factible no acotada y como el objetivo es maximizar podemos elegir el valor <span class="math notranslate nohighlight">\(x_1 = 4\)</span> y arbitrariamente un valor cada vez más grande de <span class="math notranslate nohighlight">\(x_2\)</span> y obtendremos una mejor solución dentro de la región factible.</p>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia …</p>
<p>El <a class="reference external" href="https://en.wikipedia.org/wiki/Simplex_algorithm">método símplex</a> pertenece a una clase general de algoritmos de optimización con restricciones conocida como <a class="reference external" href="https://en.wikipedia.org/wiki/Active-set_method">métodos de conjuntos activos</a> en los que la tarea fundamental es determinar cuáles restricciones son activas y cuáles inactivas en la solución. Mantiene estimaciones de conjuntos de índices de restricciones activas e inactivas que son actualizadas y realiza cambios modestos a tales conjuntos en cada paso del algoritmo.</p>
</div>
</div>
</div>
<div class="section" id="metodo-simplex">
<h2>Método símplex<a class="headerlink" href="#metodo-simplex" title="Permalink to this headline">¶</a></h2>
<p>Para comprender sus conceptos fundamentales se considera un PL en una forma <strong>no estándar</strong> y se utiliza el mismo PL del ejemplo anterior:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<div class="section" id="soluciones-fev-y-nfev">
<span id="solfevnfev"></span><h3>Soluciones FEV y NFEV<a class="headerlink" href="#soluciones-fev-y-nfev" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="n">point_FEV_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">point_FEV_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  
<span class="n">point_FEV_3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> 
<span class="n">point_FEV_4</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> 
<span class="n">point_FEV_5</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>


<span class="n">array_FEV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point_FEV_1</span><span class="p">,</span>
                          <span class="n">point_FEV_2</span><span class="p">,</span>
                          <span class="n">point_FEV_3</span><span class="p">,</span>
                          <span class="n">point_FEV_4</span><span class="p">,</span>
                          <span class="n">point_FEV_5</span><span class="p">))</span>

<span class="n">point_NFEV_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">point_NFEV_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">point_NFEV_3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">array_NFEV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point_NFEV_1</span><span class="p">,</span>
                           <span class="n">point_NFEV_2</span><span class="p">,</span>
                           <span class="n">point_NFEV_3</span><span class="p">))</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_123_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_123_0.png" />
</div>
</div>
<p>Los puntos en la gráfica con etiqueta “FEV” son soluciones factibles en un vértice:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((0, 0), (0, 6), (2, 6), (4, 3), (4, 0)\)</span></p></li>
</ul>
<p>y están definidos por las restricciones de desigualdad tomando sólo la igualdad, esto es, por las rectas: <span class="math notranslate nohighlight">\(x_1 = 4, 2x_2 = 12, 3x_1 + 2 x_2 = 18, x_1 = 0, x_2 = 0\)</span>.</p>
<div class="admonition-definiciones admonition">
<p class="admonition-title">Definiciones</p>
<ul class="simple">
<li><p>A las rectas que se forman a partir de una desigualdad tomando únicamente la igualdad se les nombra <strong>ecuaciones de frontera de restricción</strong> o sólo ecuaciones de frontera.</p></li>
<li><p>Las ecuaciones de frontera que definen a las FEV se les nombra <strong>ecuaciones de definición</strong>.</p></li>
</ul>
</div>
<p>Análogamente los puntos con etiqueta “NFEV” son soluciones no factibles en un vértice:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((0, 9), (4, 6), (6,0)\)</span></p></li>
</ul>
<p>y también están definidos por las ecuaciones de frontera.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Aunque las soluciones en un vértice también pueden ser no factibles (NFEV) el método símplex no las revisa.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En más de dos dimensiones cada ecuación de definición genera un hiperplano en un espacio <span class="math notranslate nohighlight">\(n\)</span> dimensional. Y la intersección de las <span class="math notranslate nohighlight">\(n\)</span> ecuaciones de frontera es una solución simultánea de un sistema de <span class="math notranslate nohighlight">\(n\)</span> ecuaciones lineales de definición.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>En general para un PL con <span class="math notranslate nohighlight">\(n\)</span> variables de decisión se cumple que cada solución FEV se define por la intersección de <span class="math notranslate nohighlight">\(n\)</span> ecuaciones de frontera. Podría ser que se tengan más de <span class="math notranslate nohighlight">\(n\)</span> fronteras de restricción que pasen por el vértice pero <span class="math notranslate nohighlight">\(n\)</span> de ellas definen a la solución FEV y éstas son las ecuaciones de definición.</p></li>
<li><p>Cada solución FEV es la solución simultánea de <span class="math notranslate nohighlight">\(n\)</span> ecuaciones elegidas entre <span class="math notranslate nohighlight">\(m + n\)</span> restricciones. El número de combinaciones de las <span class="math notranslate nohighlight">\(m + n\)</span> ecuaciones tomadas <span class="math notranslate nohighlight">\(n\)</span> a la vez es la <strong>cota superior</strong> del número de soluciones FEV. Para el ejemplo <span class="math notranslate nohighlight">\(m = 3, n=2\)</span> por lo que <span class="math notranslate nohighlight">\(C^{m+n}_n = C^5_2 = 10\)</span> y <strong>sólo</strong> <span class="math notranslate nohighlight">\(5\)</span> conducen a soluciones FEV.</p></li>
</ul>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_130_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_130_0.png" />
</div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Solución FEV</p></th>
<th class="text-align:center head"><p>Ecuaciones de definición</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>(0,0)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_1 = 0, x_2 = 0\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(0,6)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_1 = 0, 2x_2 = 12\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(2,6)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(2x_2 = 12, 3x_1 + 2x_2 = 18\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(4,3)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(3x_1 + 2x_2 = 18, x_1 = 4\)</span></p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(4,0)</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_1 = 4, x_2 = 0\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="fev-adyacentes">
<h3>FEV adyacentes<a class="headerlink" href="#fev-adyacentes" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>En un PL con <span class="math notranslate nohighlight">\(n\)</span> variables de decisión nombramos soluciones FEV adyacentes a dos soluciones FEV que comparten <span class="math notranslate nohighlight">\(n-1\)</span> fronteras de restricción. Las soluciones FEV adyacentes están conectadas por una arista (segmento de recta)</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_134_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_134_0.png" />
</div>
</div>
<p>En el ejemplo <span class="math notranslate nohighlight">\((0,0)\)</span> y <span class="math notranslate nohighlight">\((0,6)\)</span> son adyacentes pues comparten una arista formada por la ecuación de frontera <span class="math notranslate nohighlight">\(x_1=0\)</span> y de cada solución FEV salen dos aristas, esto es tienen dos soluciones FEV adyacentes.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Una razón para analizar las soluciones FEV adyacentes es la siguiente <strong>propiedad</strong>:</p>
<p>si un PL tiene al menos una solución óptima y una solución FEV no tiene soluciones FEV adyacentes que sean mejores entonces ésa debe ser una solución óptima.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>En el ejemplo <span class="math notranslate nohighlight">\((2, 6)\)</span> es un punto óptimo pues sus soluciones FEV adyacentes, <span class="math notranslate nohighlight">\((0, 6)\)</span>, <span class="math notranslate nohighlight">\((4,3)\)</span> tienen un valor de la función objetivo menor (recuérdese es un problema de maximización).</p>
</div>
</div>
<div class="section" id="pasos-que-sigue-el-metodo-simplex">
<h3>Pasos que sigue el método símplex<a class="headerlink" href="#pasos-que-sigue-el-metodo-simplex" title="Permalink to this headline">¶</a></h3>
<p>Para el ejemplo anterior el método símplex a grandes rasgos realiza lo siguiente:</p>
<p><strong>Paso inicial:</strong> se elige <span class="math notranslate nohighlight">\((0,0)\)</span> como la solución FEV inicial para examinarla (esto siempre se puede hacer para problemas con restricciones de no negatividad).</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el ejemplo numérico se entenderá la frase “solución FEV adyacente que es mejor”</p>
</div>
<p><strong>Prueba de optimalidad:</strong> revisar condición de optimalidad para <span class="math notranslate nohighlight">\((0,0)\)</span>. Concluir que <span class="math notranslate nohighlight">\((0,0)\)</span> no es una solución óptima (existe una solución FEV adyacente que es mejor).</p>
<p><strong>Iteración 1:</strong> moverse a una solución FEV adyacente mejor, para esto se realizan los pasos:</p>
<p>1.Entre las dos aristas de la región factible que salen de <span class="math notranslate nohighlight">\((0,0)\)</span> se elige desplazarse <strong>a lo largo</strong> de la arista que aumenta el valor de <span class="math notranslate nohighlight">\(x_2\)</span> (con una función objetivo <span class="math notranslate nohighlight">\(f_o(x) = 3x_1 + 5x_2\)</span> si <span class="math notranslate nohighlight">\(x_2\)</span> aumenta entonces el valor de <span class="math notranslate nohighlight">\(f_o\)</span> crece más que con <span class="math notranslate nohighlight">\(x_1\)</span>).</p>
<p>2.Detenerse al llegar a la primera ecuación de frontera en esa dirección: <span class="math notranslate nohighlight">\(2x_2 = 12\)</span> para <strong>mantener factibilidad</strong>.</p>
<p>3.Obtener la intersección del nuevo conjunto de ecuaciones de frontera: <span class="math notranslate nohighlight">\((0,6)\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el ejemplo numérico se entenderá la frase “solución FEV adyacente que es mejor”</p>
</div>
<p><strong>Prueba de optimalidad</strong>: revisar condición de optimalidad para <span class="math notranslate nohighlight">\((0,6)\)</span>. Concluir que <span class="math notranslate nohighlight">\((0,6)\)</span> no es una solución óptima (existe una solución FEV adyacente que es mejor).</p>
<p><strong>Iteración 2:</strong> moverse a una solución FEV adyacente mejor:</p>
<p>1.De las dos aristas que salen de <span class="math notranslate nohighlight">\((0,6)\)</span> moverse a lo largo de la arista que aumenta el valor de <span class="math notranslate nohighlight">\(x_1\)</span> (para que la <span class="math notranslate nohighlight">\(f_o\)</span> continue mejorando no podemos ir hacia abajo pues esto implicaría disminuir el valor de <span class="math notranslate nohighlight">\(x_2\)</span> y por tanto <span class="math notranslate nohighlight">\(f_o\)</span>).</p>
<p>2.Detenerse al llegar a la primera ecuación de frontera en esa dirección: <span class="math notranslate nohighlight">\(3x_1+2x_2 = 12\)</span> para manterner factibilidad.</p>
<p>3.Obtener la intersección del nuevo conjunto de ecuaciones de frontera: <span class="math notranslate nohighlight">\((2,6)\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el ejemplo numérico se entenderá la frase “ninguna solución FEV adyacente es mejor”</p>
</div>
<p><strong>Prueba de optimalidad:</strong> revisar condición de optimalidad para <span class="math notranslate nohighlight">\((2,6)\)</span>. Concluir que <span class="math notranslate nohighlight">\((2,6)\)</span> es una solución óptima (ninguna solución FEV adyacente es mejor).</p>
</div>
<div class="section" id="forma-aumentada-de-un-pl">
<span id="formaaumentadapl"></span><h3>Forma aumentada de un PL<a class="headerlink" href="#forma-aumentada-de-un-pl" title="Permalink to this headline">¶</a></h3>
<p>El método símplex inicia con un <strong>sistema de ecuaciones lineales</strong> con lado derecho igual a <span class="math notranslate nohighlight">\(b\)</span> (que es el lado derecho de las restricciones funcionales) y una matriz del sistema con menos renglones que columnas (<span class="math notranslate nohighlight">\(m &lt; n\)</span>). <strong>Asume</strong> que las entradas de <span class="math notranslate nohighlight">\(b\)</span> son no negativas y que el <em>rank</em> de <span class="math notranslate nohighlight">\(A\)</span> es <span class="math notranslate nohighlight">\(m\)</span> (esto es, de <em>rank</em> completo).</p>
<p>Para revisar los pasos del método símplex descritos anteriormente en esta sección continuaremos con el ejemplo anterior de PL:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<p>Y vamos a nombrar a las desigualdades <span class="math notranslate nohighlight">\(x_1 \leq4, 2x_2 \leq 12, 3x_1 + 2x_12 \leq 18\)</span> <strong>restricciones funcionales</strong> y a las desigualdades <span class="math notranslate nohighlight">\(x_1 \geq 0, x_2 \geq 0\)</span> <strong>restricciones de no negatividad</strong>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Aunque hay diversas formas de PL en las que podríamos tener lados derechos negativos o desigualdades del tipo <span class="math notranslate nohighlight">\(\geq\)</span>, es sencillo transformar de forma algebraica tales PL a una forma similar descrita en esta sección.</p>
</div>
<p>En el ejemplo tenemos desigualdades por lo que se introducen <strong>variables de holgura, <em>slack variables</em>,</strong> no negativas para obtener la <strong>forma aumentada</strong>:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_3 = 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 + x_4 = 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 + x_5 = 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Forma estándar de un PL:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\\
\text{sujeto a:} \\
Ax=b\\
x \geq 0
\)</span></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>La forma aumentada <strong>en este ejemplo</strong> <strong>no</strong> es la forma estándar de un PL salvo porque en la estándar se usa una minimización, ver <a class="reference internal" href="#formaestpl"><span class="std std-ref">forma estándar de un PL</span></a>. Sin embargo, la forma estándar del PL se puede obtener considerando que maximizar <span class="math notranslate nohighlight">\(3x_1 + 5x_2\)</span> sujeto a las restricciones dadas es equivalente a minimizar <span class="math notranslate nohighlight">\(-3x_1 - 5 x_2\)</span> sujeto a las mismas restricciones.</p></li>
<li><p>Las variables de holgura al iniciar el método tienen un coeficiente de <span class="math notranslate nohighlight">\(0\)</span> en la función objetivo <span class="math notranslate nohighlight">\(f_o(x) = 3x_1 + 5x_2 = 3x_1 + 5x_2  + 0x_3 + 0x_4 + 0x_5\)</span></p></li>
</ul>
</div>
<p>Y en notación matricial el sistema de ecuaciones lineales es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Ax = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
=
b
\end{split}\]</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que en la matriz de la forma aumentada se tiene una matriz identidad.</p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Interpretación de algunos valores de las variables en la forma aumentada:</p>
<p>Si una variable de holgura es igual a <span class="math notranslate nohighlight">\(0\)</span> en la solución actual, entonces esta solución se encuentra sobre la ecuación de frontera de la restricción funcional correspondiente. Un valor mayor que <span class="math notranslate nohighlight">\(0\)</span> significa que la solución está en el lado factible de la ecuación de frontera, mientras que un valor menor que <span class="math notranslate nohighlight">\(0\)</span> señala que está en el lado no factible de esta ecuación de frontera.</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_173_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_173_0.png" />
</div>
</div>
<div class="admonition-definiciones admonition">
<p class="admonition-title">Definiciones</p>
<p>Una <strong>solución aumentada</strong> es una solución de las variables originales que se aumentó con los valores correspondientes de las variables de holgura.</p>
<p>Una <strong>solución básica</strong> es una solución FEV o NFEV aumentada.</p>
<p>Una <strong>solución básica factible (BF)</strong> es una solución FEV aumentada.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
\end{split}\]</div>
</div>
<p>En el ejemplo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \end{array} \right ] = \left [ \begin{array}{c} 3 \\ 2 \end{array} \right ]\)</span> es solución (de hecho factible) y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array} \right ] = \left [ \begin{array}{c} 3 \\ 2 \\ 1 \\ 8 \\ 5 \end{array} \right ]\)</span> es solución aumentada (factible).</p></li>
<li><p><span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \end{array} \right ] =  \left [ \begin{array}{c} 4 \\ 6 \end{array} \right ]\)</span> es solución NFEV y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array} \right ] = \left [ \begin{array}{c} 4 \\ 6 \\ 0 \\ 0 \\ -6 \end{array} \right ]\)</span> es solución básica.</p></li>
<li><p><span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \end{array} \right ] =  \left [ \begin{array}{c} 0 \\ 6 \end{array} \right ]\)</span> es solución FEV y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 6 \\ 4 \\ 0 \\ 6 \end{array} \right ]\)</span> es solución BF.</p></li>
</ul>
</div>
<div class="section" id="soluciones-bf-adyacentes">
<h3>Soluciones BF adyacentes<a class="headerlink" href="#soluciones-bf-adyacentes" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Dos soluciones BF son adyacentes si sus correspondientes soluciones FEV lo son.</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Programacion_lineal_y_metodo_simplex_179_0.png" src="../../_images/Programacion_lineal_y_metodo_simplex_179_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
\end{split}\]</div>
</div>
<p>En el ejemplo <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} 0 \\ 0 \\ 4 \\ 12 \\ 18 \end{array} \right ]\)</span> y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} 0 \\ 6 \\ 4 \\ 0 \\ 6 \end{array} \right ]\)</span> son soluciones BF adyacentes.</p>
</div>
<div class="section" id="variables-basicas-y-no-basicas">
<span id="varbasicasnobasicas"></span><h3>Variables básicas y no básicas<a class="headerlink" href="#variables-basicas-y-no-basicas" title="Permalink to this headline">¶</a></h3>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Dada la matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> de la forma aumentada aquellas variables de decisión que corresponden a columnas linealmente independientes se les nombra <strong>variables básicas</strong>. Las restantes son <strong>variables no básicas</strong>.</p>
</div>
<p>Al inicio del método símplex la matriz de la forma aumentada es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\end{split}\]</div>
<p>Por lo que las variables básicas son <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span> y las no básicas son <span class="math notranslate nohighlight">\(x_1, x_2\)</span>.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>La matriz que se forma a partir de las columnas de <span class="math notranslate nohighlight">\(A\)</span> que corresponden a las variables básicas se denota como <span class="math notranslate nohighlight">\(B \in \mathbb{R}^{m \times m}\)</span> es no singular y se nombra <em><strong>basis matrix</strong></em>. La matriz que se forma con las columnas de las variables no básicas se denota con <span class="math notranslate nohighlight">\(N\)</span> y su nombre es <em><strong>nonbasis matrix</strong></em>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
\end{split}\]</div>
</div>
<p>En el ejemplo la <em>basis matrix</em> y la <em>nonbasis matrix</em> al inicio del método son:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B
=\left [
\begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}N
=
\left [
\begin{array}{ccccc}
1 &amp; 0 \\
0 &amp; 2 \\
3 &amp; 2 \\
\end{array}
\right ]
\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Obsérvese en el ejemplo que al tener 5 variables y tres ecuaciones si se le asigna un valor arbitrario a <span class="math notranslate nohighlight">\(x_1, x_2\)</span> entonces quedan determinadas las variables <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span>. En el método símplex las variables no básicas se igualan a <span class="math notranslate nohighlight">\(0\)</span> por lo que se tiene: <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 0 \\ 4 \\ 12 \\ 18 \end{array} \right ]\)</span></p></li>
<li><p>Una forma de distinguir si dos soluciones BF son adyacentes es comparar qué variables no básicas (análogamente sus básicas) tienen. Si difieren en sólo una entonces son soluciones BF adyacentes. Por ejemplo: <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} 0 \\ 0 \\ 4 \\ 12 \\ 18 \end{array} \right]\)</span> y <span class="math notranslate nohighlight">\(\left [ \begin{array}{c} 0 \\ 6 \\ 4 \\ 0 \\ 6 \end{array} \right ]\)</span> son BF adyacentes pues tienen como variables no básicas <span class="math notranslate nohighlight">\(x_1, x_2\)</span> y <span class="math notranslate nohighlight">\(x_1, x_4\)</span> respectivamente. Esto también se puede describir como: <span class="math notranslate nohighlight">\(x_2\)</span> “pasa de ser no básica a básica” (análogamente <span class="math notranslate nohighlight">\(x_4\)</span> pasa de básica a no básica). Lo anterior ayuda a identificar soluciones BF adyacentes en PL’s con más de dos variables en los que resulta más complicado graficar.</p></li>
<li><p>El método símplex al considerar variables no básicas con valor de <span class="math notranslate nohighlight">\(0\)</span> indica que la restricción no negativa <span class="math notranslate nohighlight">\(x_j \leq 0\)</span> es <strong>activa</strong> para <span class="math notranslate nohighlight">\(j\)</span> en los índices de las variables no básicas.</p></li>
<li><p>En el método símplex se puede verificar que una solución es BF si las variables básicas son no negativas (recuérdese que las no básicas en el método son igualadas a cero).</p></li>
</ul>
</div>
</div>
<div class="section" id="variables-basicas-no-degeneradas-y-degeneradas">
<h3>Variables básicas no degeneradas y degeneradas<a class="headerlink" href="#variables-basicas-no-degeneradas-y-degeneradas" title="Permalink to this headline">¶</a></h3>
<p>Denotemos a <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> como el conjunto de índices en el conjunto <span class="math notranslate nohighlight">\(\{1, 2, \dots, m+n\}\)</span> que representan a las variables básicas y <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> al conjunto de índices de las no básicas. En el ejemplo <span class="math notranslate nohighlight">\(\mathcal{B} = \{3, 4, 5\}\)</span>, <span class="math notranslate nohighlight">\(\mathcal{N} = \{1, 2\}\)</span> con <span class="math notranslate nohighlight">\(m+n=5\)</span> al inicio del método símplex. El método en sus iteraciones elige algún índice de <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> y lo sustituye por un índice del conjunto <span class="math notranslate nohighlight">\(\mathcal{B}\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el ejemplo se entenderá la frase “mejoren la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span>”</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El quitar y añadir variables a los conjuntos de índices <span class="math notranslate nohighlight">\(\mathcal{N}, \mathcal{B}\)</span> y realizar los ajustes necesarios (recalcular valores de las variables básicas) en los valores de todas las variables básicas y no básicas se le conoce con el nombre de <strong>pivoteo</strong>.</p></li>
<li><p>La interpretación geométrica de quitar, añadir variables de las matrices <span class="math notranslate nohighlight">\(N, B\)</span> y realizar los ajustes necesarios (recalcular valores de las variables básicas) en una solución BF es equivalente en dos dimensiones a moverse por una arista y detenerse hasta encontrar una solución FEV.</p></li>
<li><p>La elección de cuál variable no básica sustituir por una variable básica depende de la existencia de soluciones BF que mejoren la función objetivo <span class="math notranslate nohighlight">\(f_o\)</span> y para ello se utiliza un <strong>criterio de optimalidad</strong>.</p></li>
</ul>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Una solución BF en la que todas sus variables básicas son no negativas se nombra no degenerada y degenerada si existe al menos una con valor igual a cero.</p>
</div>
</div>
</div>
<div class="section" id="ejemplo-del-metodo-simplex">
<span id="ejmetsimplex"></span><h2>Ejemplo del método símplex<a class="headerlink" href="#ejemplo-del-metodo-simplex" title="Permalink to this headline">¶</a></h2>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<p>Continuemos con el ejemplo anterior en su forma aumentada. En notación matricial el sistema de ecuaciones lineales es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Ax = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\left [
\begin{array}{c}
x_1 \\
x_2 \\
x_3 \\
x_4 \\
x_5
\end{array}
\right ]
=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]
=
b
\end{split}\]</div>
<p>Defínanse al vector <span class="math notranslate nohighlight">\(x\)</span> que contiene las variables “originales” y a las de holgura: <span class="math notranslate nohighlight">\(x = \left [ \begin{array}{c} x_1 \\ x_2 \\ x_3 \\ x_4 \\ x_5 \end{array} \right ]\)</span> y <span class="math notranslate nohighlight">\(c = \left [ \begin{array}{c} -3 \\ -5 \\ 0 \\ 0 \\ 0 \end{array}\right]\)</span> al vector de costos unitarios o equivalentemente <span class="math notranslate nohighlight">\(-c\)</span> el vector de ganancias unitarias. Así, la función objetivo es: <span class="math notranslate nohighlight">\(f_o(x) = -c^Tx\)</span> y se busca maximizar la ganancia total. También defínanse a los vectores de variables básicas y no básicas como: <span class="math notranslate nohighlight">\(x_B = [x_j]_{j \in \mathcal{B}}\)</span>, <span class="math notranslate nohighlight">\(x_N = [x_j]_{j \in \mathcal{N}}\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Siendo rigurosos la forma estándar de un PL es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\\
\text{sujeto a:} \\
Ax=b\\
x \geq 0
\)</span></p>
<p>por lo que aunque maximizar <span class="math notranslate nohighlight">\(-c^Tx\)</span> sujeto a las restricciones dadas es equivalente a minimizar <span class="math notranslate nohighlight">\(c^Tx\)</span> sujeto a las mismas restricciones el problema debe escribirse explícitamente como minimización para considerarse en forma estándar.</p>
</div>
<p>Entonces el PL con esta notación que se debe resolver es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max_{x \in \mathbb{R}^5} (-c)^Tx\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[Ax = b\]</div>
<div class="math notranslate nohighlight">
\[x \geq 0\]</div>
<p>con <span class="math notranslate nohighlight">\(x=\left [ \begin{array}{c} x_B \\ x_N\end{array} \right ] \in \mathbb{R}^5\)</span>, <span class="math notranslate nohighlight">\(x_B \in \mathbb{R}^{3}, x_N \in \mathbb{R}^2\)</span>, <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{3 \times 5}\)</span>.</p>
<div class="section" id="paso-inicial">
<h3>Paso inicial<a class="headerlink" href="#paso-inicial" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<p>Se tiene la siguiente situación:</p>
<div class="math notranslate nohighlight">
\[-c^Tx= 3x_1 + 5x_2 + 0x_3 + 0x_4 + 0x_5\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\end{split}\]</div>
<p>Como <span class="math notranslate nohighlight">\(A = [ B \quad N ]\)</span> y <span class="math notranslate nohighlight">\(Ax = b\)</span> entonces <span class="math notranslate nohighlight">\(Ax = B x_B + N x_N = b\)</span>.</p>
<p>Se designa <span class="math notranslate nohighlight">\(x_N\)</span> como un vector de ceros:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_N = \left [ \begin{array}{c} x_1 \\ x_2 \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 0 \end{array} \right ]\end{split}\]</div>
<p>Por tanto:</p>
<div class="math notranslate nohighlight">
\[Ax = Bx_B + N x_N = B x_B = b\]</div>
<p>En este paso inicial <span class="math notranslate nohighlight">\(x_B = b\)</span> pues <span class="math notranslate nohighlight">\(B\)</span> es la identidad:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\therefore x_B = \left [ \begin{array}{c} x_3 \\ x_4 \\ x_5\end{array}\right ] = B^{-1}b = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ]^{-1} \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ]=\left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ]\end{split}\]</div>
<p>El vector de costos <span class="math notranslate nohighlight">\(c\)</span> lo dividimos en <span class="math notranslate nohighlight">\(c = \left [ \begin{array}{c} c_B\\ c_N \end{array} \right ]\)</span>, con  <span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} c_{B_3} \\ c_{B_4} \\ c_{B_5} \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array} \right ]\)</span> contiene los costos de las variables básicas. El vector <span class="math notranslate nohighlight">\(c_N=\left [ \begin{array}{c} c_{N_1} \\ c_{N_2} \end{array} \right ]=\left [ \begin{array}{c}-3 \\ -5 \end{array} \right ]\)</span> contiene los costos de las variables no básicas.</p>
<p>Las variables básicas son <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span> y las no básicas son <span class="math notranslate nohighlight">\(x_1, x_2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
<span class="n">x_B</span> <span class="o">=</span> <span class="n">b</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">c_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">c_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>

<span class="c1">#list of indexes of nonbasic variables correspond to x1, x2</span>
<span class="n">N_list_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="c1">#list of indexes of basic variables correspond to x3, x4, x5</span>
<span class="n">B_list_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="prueba-de-optimalidad">
<h3>Prueba de optimalidad<a class="headerlink" href="#prueba-de-optimalidad" title="Permalink to this headline">¶</a></h3>
<p>Para revisar tanto en el paso inicial como en las iteraciones posteriores la condición de optimalidad para encontrar soluciones FEV adyacentes mejores, realicemos algunas reescrituras de la función objetivo.</p>
<p>1.Obsérvese que la función objetivo se puede escribir como:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que la función objetivo es: <span class="math notranslate nohighlight">\(-c^Tx= 3x_1 + 5x_2 + 0x_3 + 0x_4 + 0x_5\)</span>.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}f_o(x) = -c^Tx = [-c_B \quad -c_N] ^T \left [ \begin{array}{c} x_B \\ x_N\end{array} \right ] = -c_B^Tx_B - c_N^T x_N = -c_B^T B^{-1}b = [0 \quad 0 \quad 0]^T \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ]=0\end{split}\]</div>
<p>2.Obsérvese que todas las ecuaciones de frontera en su forma igualadas a cero pueden ser restadas de la función objetivo sin modificar su valor. Por ejemplo si tomamos la primer ecuación de frontera con lado derecho igual a cero: <span class="math notranslate nohighlight">\(x_1 + x_3 - 4 = 0\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[f_o(x) = f_o(x) - 0 =  f_o(x) -  (x_1 + x_3 - 4) = f_o(x) -x_1 -x_3 + 4\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<p>Y esto podemos hacer para todas las ecuaciones de frontera con lado derecho igual a cero:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
f_o(x) &amp;=&amp; f_o(x) -  (x_1 + x_3 - 4) - (2x_2 + x_4 - 12) - (3x_1 + 2x_2 + x_5 - 18) \nonumber \\
&amp;=&amp; f_o(x) + (-x_1 - 2x_2 -2x_2) + (-x_3 - x_4 - x_5) + (4 + 12 + 18) \nonumber \\
&amp;=&amp; f_o(x) - \displaystyle \sum_{j \in \mathcal{B}} x_{B_j} - \sum_{j \in \mathcal{N}}x_{N_j} + \sum_{i = 1}^3 b(i)
\end{eqnarray}
\end{split}\]</div>
<p>con <span class="math notranslate nohighlight">\(x_{B_j}\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésima componente del vector <span class="math notranslate nohighlight">\(x_B\)</span>, <span class="math notranslate nohighlight">\(x_{N_j}\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésima componente del vector <span class="math notranslate nohighlight">\(x_N\)</span> y <span class="math notranslate nohighlight">\(b(i)\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima componente de <span class="math notranslate nohighlight">\(b\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>No es coincidencia que se elijan las cantidades <span class="math notranslate nohighlight">\(\lambda, \nu\)</span> para representar esta igualdad, ver <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#funlagrangiana"><span class="std std-ref">la función Lagrangiana</span></a>.</p>
</div>
<p>En el método símplex no solamente se restan de la <span class="math notranslate nohighlight">\(f_o\)</span> las ecuaciones de frontera con lado derecho igual a cero sino se multiplican por una cantidad <span class="math notranslate nohighlight">\(\nu_i\)</span> y se suman a <span class="math notranslate nohighlight">\(f_o\)</span>. También si <span class="math notranslate nohighlight">\(\lambda\)</span> es un vector tal que <span class="math notranslate nohighlight">\(\lambda ^T x = 0\)</span> entonces:</p>
<div class="math notranslate nohighlight">
\[f_o(x) = f_o(x) + \lambda^Tx + \sum_{i = 1}^3 \nu_i h_i(x) = f_o(x) + \displaystyle \sum_{j \in \mathcal{B}} \lambda_{B_j} x_{B_j} + \sum_{j \in \mathcal{N}}\lambda_{N_j}x_{N_j} + \sum_{i = 1}^3 \nu_i h_i(x)\]</div>
<p>con <span class="math notranslate nohighlight">\(\lambda_{B_j}\)</span>, <span class="math notranslate nohighlight">\(\lambda_{N_j}\)</span> coeficientes asociados a <span class="math notranslate nohighlight">\(x_{B_j}\)</span> y <span class="math notranslate nohighlight">\(x_{N_j}\)</span> respectivamente y <span class="math notranslate nohighlight">\(h_i(x)\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima restricción de igualdad con lado derecho igual a cero.</p>
<p>Los coeficientes <span class="math notranslate nohighlight">\(\lambda_{B_j}, \lambda_{N_j}\)</span> de la expresión anterior en el método de símplex se escriben como:</p>
<div class="math notranslate nohighlight">
\[\lambda_{B_j} =  -c_{B_j} + \nu^Ta_j \quad j \in \mathcal{B}\]</div>
<div class="math notranslate nohighlight">
\[\lambda_{N_j} =  -c_{N_j} + \nu^Ta_j \quad j \in \mathcal{N}\]</div>
<p>con <span class="math notranslate nohighlight">\(a_j\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{3 \times 5}\)</span> y <span class="math notranslate nohighlight">\(\nu \in \mathbb{R}^{3}\)</span>.</p>
<p>En el método símplex se mantiene en cada iteración <span class="math notranslate nohighlight">\(\lambda_{B_j} = 0 \forall j \in \mathcal{B}\)</span> y se <strong>busca</strong> que <span class="math notranslate nohighlight">\(\lambda_{N_j} \forall j \in \mathcal{N}\)</span> sea no negativo para problemas de minimización o no positivo para problemas de maximización. Por lo anterior el vector <span class="math notranslate nohighlight">\(\nu\)</span> se obtiene resolviendo la ecuación: <span class="math notranslate nohighlight">\(\nu ^T B = c_B^T\)</span> y por tanto <span class="math notranslate nohighlight">\(\nu = B^{-T} c_B \)</span>.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>La justificación del por qué <span class="math notranslate nohighlight">\(\lambda = -c  + A^T \nu\)</span> se realizará más adelante, por lo pronto considérese que esto se obtiene de las <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#primeraformulacioncondkkt"><span class="std std-ref">condiciones KKT de optimalidad</span></a>.</p></li>
<li><p>Por la definición de <span class="math notranslate nohighlight">\(\nu\)</span> se cumple: <span class="math notranslate nohighlight">\(f_o(x) = -c_B^Tx_B - c_N^T x_N = -c_B^T B^{-1}b = -\nu^Tb\)</span>.</p></li>
<li><p>No se recomienda aprenderse fórmulas o expresiones pues este problema se planteó como maximizar <span class="math notranslate nohighlight">\(-c^Tx\)</span>, si se hubiera elegido maximizar <span class="math notranslate nohighlight">\(c^Tx\)</span> se modificarían un poco las expresiones anteriores para <span class="math notranslate nohighlight">\(\lambda, \nu, f_o(x)\)</span>.</p></li>
</ul>
</div>
<p>La prueba de optimalidad consiste en revisar los <span class="math notranslate nohighlight">\(\lambda_{N_j}\)</span>, <span class="math notranslate nohighlight">\(j \in \mathcal{N}\)</span>. Se selecciona(n) aquella(s) variable(s) no básica(s) que tenga(n) la tasa más alta de mejoramiento (esto depende si es un problema de maximización o minimización) del valor en la función objetivo.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} c_{B_3} \\ c_{B_4} \\ c_{B_5} \end{array} \right ] = \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array} \right ]\)</span></p>
</div>
<p>El vector <span class="math notranslate nohighlight">\(\nu\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu =  B^{-T}c_B =  \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ] ^{-T} \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array}\right ] = \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array}\right ]\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Resolviendo un sólo sistema de ecuaciones lineales nos ayuda a evitar calcular la inversa de una matriz que implica resolver un sistema de ecuaciones lineales más grande.</p>
</div>
<p>Para el cálculo de <span class="math notranslate nohighlight">\(\nu\)</span> resolvemos el sistema de ecuaciones lineales para el vector de incógnitas <span class="math notranslate nohighlight">\(\nu\)</span>:</p>
<div class="math notranslate nohighlight">
\[B^T \nu = c_B\]</div>
<p>Como <span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ]\)</span> entonces directamente <span class="math notranslate nohighlight">\(\nu = c_B\)</span>. Por tanto:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Valor de la función objetivo en la solución BF actual: <span class="math notranslate nohighlight">\(f_o(x) = -c^Tx =  -\nu^Tb = 0\)</span></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
f_o(x) &amp;=&amp; -c^Tx \nonumber\\
&amp;=&amp; -c_B^Tx_B - c_N^T x_N \nonumber\\
&amp;=&amp; -c_B^T x_B \quad \text{pues } x_N=0\\
\end{eqnarray}\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">c_B</span><span class="p">,</span> <span class="n">x_B</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(f_o(x) = -\nu^Tb\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">nu</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_N= \left [ \begin{array}{c}-3 \\ -5 \end{array} \right ]\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_1</span> <span class="o">=</span>  <span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_2</span> <span class="o">=</span>  <span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\lambda_{N_1} = -c_{N_1} + \nu^Ta_1 = 3 + [0 \quad 0 \quad 0] \left [ \begin{array}{c} 1 \\ 0 \\ 3 \end{array}\right ] = 3\)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda_{N_2} = -c_{N_2} + \nu^Ta_2 =  5 + [0 \quad 0 \quad 0] \left [ \begin{array}{c} 0 \\ 2 \\ 2 \end{array}\right ] = 5\)</span></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>“tasa más alta de mejoramiento” se refiere a mejorar <span class="math notranslate nohighlight">\(f_o\)</span> por un incremento de una unidad en la variable <span class="math notranslate nohighlight">\(x_2\)</span>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Incrementar una variable no básica equivale geométricamente a moverse por una arista desde una solución FEV.</p>
</div>
<p>Como tenemos un problema de <strong>maximización</strong> la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> la da la variable <span class="math notranslate nohighlight">\(x_2\)</span> por lo que es la variable no básica que sustituye a una variable básica. ¿Cuál variable básica se debe elegir?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index for nonbasic variables, in this case value 1 correspond to x2</span>

<span class="n">idx_x_N</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="prueba-del-cociente-minimo">
<h3>Prueba del cociente mínimo<a class="headerlink" href="#prueba-del-cociente-minimo" title="Permalink to this headline">¶</a></h3>
<p>El objetivo de esta prueba es determinar qué variable(s) básica(s) llega(n) a cero cuando crece la variable entrante. Tal variable(s) básica(s) en la siguiente iteración será no básica y la que aumenta pasa de ser no básica a básica.</p>
<p>En el paso inicial las variables básicas son <span class="math notranslate nohighlight">\(x_3\)</span>, <span class="math notranslate nohighlight">\(x_4\)</span> y <span class="math notranslate nohighlight">\(x_5\)</span>, por lo que hay que determinar de éstas cuál(es) es(son) la(s) que sale(n) al incrementar la variable no básica <span class="math notranslate nohighlight">\(x_2\)</span>.</p>
<p>Esta prueba del cociente mínimo primero se explicará de forma detallada para posteriormente representarla de forma matricial.</p>
<p>Las ecuaciones de <span class="math notranslate nohighlight">\(Ax = b\)</span> son:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_1 + x_3 &amp;=&amp; 4 \nonumber \\
2x_2 + x_4 &amp;=&amp; 12 \nonumber \\
3x_1 + 2x_2 + x_5 &amp;=&amp; 18
\end{eqnarray}
\end{split}\]</div>
<p>Despejamos cada variable básica de las ecuaciones anteriores:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_3 &amp;=&amp; 4 - x_1 \nonumber \\
x_4 &amp;=&amp; 12 - 2x_2 \nonumber \\
x_5 &amp;=&amp; 18 - 3x_1 - 2x_2
\end{eqnarray}
\end{split}\]</div>
<p>Y se debe cumplir por las restricciones de no negatividad que al aumentar <span class="math notranslate nohighlight">\(x_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_3 &amp;=&amp; 4 - x_1 \geq 0 \nonumber \\
x_4 &amp;=&amp; 12 - 2x_2 \geq 0  \nonumber \\
x_5 &amp;=&amp; 18 - 3x_1 - 2x_2 \geq 0
\end{eqnarray}
\end{split}\]</div>
<p>En la primera ecuación <span class="math notranslate nohighlight">\(x_3 = 4 - x_1\)</span> no tenemos contribución alguna de <span class="math notranslate nohighlight">\(x_2\)</span> por lo que no la tomamos en cuenta. La segunda y tercer ecuación sí aparece <span class="math notranslate nohighlight">\(x_2\)</span> y como <span class="math notranslate nohighlight">\(x_1\)</span> es variable no básica con valor <span class="math notranslate nohighlight">\(0\)</span> se debe cumplir:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_2 \leq \frac{12}{2} = 6  \nonumber \\
x_2 \leq \frac{18}{2} = 9
\end{eqnarray}
\end{split}\]</div>
<p>Entonces se toma el mínimo de las cantidades anteriores y como es igual a <span class="math notranslate nohighlight">\(6\)</span> y esa desigualdad la obtuvimos de despejar <span class="math notranslate nohighlight">\(x_4\)</span> entonces se elige <span class="math notranslate nohighlight">\(x_4\)</span> como variable básica que se vuelve no básica. Tomamos el mínimo pues el valor de <span class="math notranslate nohighlight">\(6\)</span> es lo máximo que podemos incrementar <span class="math notranslate nohighlight">\(x_2\)</span> sin que <span class="math notranslate nohighlight">\(x_4\)</span> se haga no negativa.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Es importante en la prueba del cociente mínimo que el lado derecho, el vector <span class="math notranslate nohighlight">\(b\)</span>, tenga entradas no negativas.</p>
</div>
</div>
<div class="section" id="prueba-del-cociente-minimo-forma-general-y-con-notacion-matricial-y-vectorial">
<h3>Prueba del cociente mínimo: forma general y con notación matricial y vectorial<a class="headerlink" href="#prueba-del-cociente-minimo-forma-general-y-con-notacion-matricial-y-vectorial" title="Permalink to this headline">¶</a></h3>
<p>El procedimiento de la prueba del cociente mínimo entonces consiste en:</p>
<p>1.Elegir la columna de <span class="math notranslate nohighlight">\(A\)</span> correspondiente a la variable no básica que sustituye a la variable básica, que por lo anterior es <span class="math notranslate nohighlight">\(x_2\)</span> y corresponde a la segunda columna de <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(a_2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\end{split}\]</div>
<p>2.Hacer la multiplicación <span class="math notranslate nohighlight">\(B^{-1}a_2\)</span>.</p>
<p>Esto en general se realiza, en el paso inicial <span class="math notranslate nohighlight">\(B^{-1}\)</span> es la identidad por lo que en este paso inicial no tuvo efecto hacer la multiplicación.</p>
<p>3.Para las entradas <strong>estrictamente positivas</strong> de tal multiplicación anterior se divide el lado derecho entre tales entradas y se toma el mínimo. Como el lado derecho en cada iteración es <span class="math notranslate nohighlight">\(x_B = B^{-1}b\)</span> entonces se dividen los valores de las variables básicas entre las entradas estrictamente positivas. Esto es, si se denota como <span class="math notranslate nohighlight">\(x_2^{+}\)</span> al mínimo:</p>
<div class="math notranslate nohighlight">
\[x_2^{+} = \min \{\frac{x_{B_i}}{d_i} : d_i &gt; 0, i = 1, 2, \dots, m \}\]</div>
<p>con <span class="math notranslate nohighlight">\(d_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima componente del vector <span class="math notranslate nohighlight">\(d\)</span> que es solución del sistema de ecuaciones: <span class="math notranslate nohighlight">\(Bd = a_2\)</span> y <span class="math notranslate nohighlight">\(x_{B_i}\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima entrada del vector <span class="math notranslate nohighlight">\(x_B\)</span> de la iteración actual.</p>
<p>4.El índice donde ocurre el mínimo es el de la variable básica que será sustituida.</p>
<p>En el ejemplo se tienen las siguientes asignaciones <strong>en el paso inicial</strong>:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
B = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La segunda columna de <span class="math notranslate nohighlight">\(A\)</span> se elige pues <span class="math notranslate nohighlight">\(x_2\)</span> es la variable no básica a la que se le aumentará su valor y sustituirá a una variable básica.</p>
</div>
<p>Se resuelve la ecuación: <span class="math notranslate nohighlight">\(Bd = a_2\)</span> para <span class="math notranslate nohighlight">\(d\)</span> vector de incógnitas y <span class="math notranslate nohighlight">\(a_2\)</span> segunda columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">idx_x_N</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 2. 2.]
</pre></div>
</div>
</div>
</div>
<p>En esta iteración: <span class="math notranslate nohighlight">\(x_B = \left [ \begin{array}{c} x_3 \\ x_4 \\ x_5\end{array}\right ] = \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ]\)</span> pues <span class="math notranslate nohighlight">\(B\)</span> es la matriz identidad por lo que <span class="math notranslate nohighlight">\(x_B = b\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 4 12 18]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se hace la división únicamente entre las entradas estrictamente positivas</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_positive</span> <span class="o">=</span> <span class="n">d</span> <span class="o">&gt;</span><span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[6. 9.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Hacer cero una variable básica y convertirla en no básica equivale geométricamente a detener el movimiento por una arista hasta encontrar una solución FEV.</p>
</div>
<p>Entonces el mínimo ocurre en la segunda posición de <span class="math notranslate nohighlight">\(x_B\)</span> que corresponde a la variable básica <span class="math notranslate nohighlight">\(x_4\)</span>. Se elige <span class="math notranslate nohighlight">\(x_4\)</span> como variable básica que se vuelve no básica. <span class="math notranslate nohighlight">\(x_4\)</span> será sustituida por <span class="math notranslate nohighlight">\(x_2\)</span> en la próxima iteración.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index for basic variables, in this case value 1 correspond to x4</span>

<span class="n">idx_x_B</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="actualizacion-del-vector-x-b">
<h3>Actualización del vector <span class="math notranslate nohighlight">\(x_B\)</span><a class="headerlink" href="#actualizacion-del-vector-x-b" title="Permalink to this headline">¶</a></h3>
<p>La actualización de las variables básicas después del paso inicial se realiza con la expresión computacional:</p>
<div class="math notranslate nohighlight">
\[x_B = x_B - dx_{nb}^{+}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(x_{nb}\)</span> es la variable no básica que se volverá básica en la iteración actual. Después de actualizar <span class="math notranslate nohighlight">\(x_{nb}\)</span> la variable básica <span class="math notranslate nohighlight">\(x_{b}\)</span> pasa a estar en <span class="math notranslate nohighlight">\(x_N\)</span> con valor de <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>Posterior a la actualización de <span class="math notranslate nohighlight">\(x_B\)</span> se intercambian las columnas de <span class="math notranslate nohighlight">\(B\)</span> correspondientes a las variables <span class="math notranslate nohighlight">\(x_{nb}\)</span> y <span class="math notranslate nohighlight">\(x_b\)</span>.</p>
<p><strong>La justificación de la expresión anterior es la siguiente:</strong></p>
<p>Como <span class="math notranslate nohighlight">\(Ax = b\)</span> y <span class="math notranslate nohighlight">\(Bx_B + Nx_N = b\)</span> pero será incrementada la variable <span class="math notranslate nohighlight">\(x_{nb}\)</span> y disminuida <span class="math notranslate nohighlight">\(x_{b}\)</span> a cero entonces si <span class="math notranslate nohighlight">\(x^+\)</span> denota el nuevo valor de <span class="math notranslate nohighlight">\(x\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[b = Ax ^+ = Bx_B^+ + a_{nb}x_{nb}^+ = B x_B = Ax = b\]</div>
<p>recordando que <span class="math notranslate nohighlight">\(Nx_N = 0\)</span> pues <span class="math notranslate nohighlight">\(x_N=0\)</span> donde: <span class="math notranslate nohighlight">\(a_{nb}\)</span> es la <span class="math notranslate nohighlight">\({nb}\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Por tanto:</p>
<div class="math notranslate nohighlight">
\[Bx_B^+ = Bx_B - a_{nb}x_{nb}^+\]</div>
<p>Y premultiplicando por la inversa:</p>
<div class="math notranslate nohighlight">
\[x_B^+ = x_B - B^{-1}a_{nb}x_{nb}^+ = x_B - d x_{nb}^+.\]</div>
<p><strong>La interpretación geométrica de esta actualización es:</strong> un movimiento a lo largo de una arista del poliedro que mantiene factibilidad y mejora la función objetivo. Nos movemos a lo largo de esta arista hasta encontrar una solución FEV. En esta nueva solución FEV una nueva restricción no negativa se vuelve activa, la que corresponde a la variable <span class="math notranslate nohighlight">\(x_b\)</span>.</p>
<p>Después de la actualización se remueve el índice <span class="math notranslate nohighlight">\(b\)</span> del conjunto <span class="math notranslate nohighlight">\(\mathcal{B}\)</span> y se sustituye por <span class="math notranslate nohighlight">\(nb\)</span>.</p>
</div>
<div class="section" id="iteracion-1">
<h3>Iteración 1<a class="headerlink" href="#iteracion-1" title="Permalink to this headline">¶</a></h3>
<p>La matriz <span class="math notranslate nohighlight">\(B\)</span> del paso inicial era:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ]\end{split}\]</div>
<p>y correspondía cada columna a las variables <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span> en ese orden.</p>
<p>Se realiza la actualización descrita para <span class="math notranslate nohighlight">\(x_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[x_B = x_B - dx_2^{+}\]</div>
<p>con <span class="math notranslate nohighlight">\(x_2\)</span> es la variable no básica que se volverá básica en la iteración actual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_2_plus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_2_plus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_B</span> <span class="o">=</span> <span class="n">x_B</span> <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="n">x_2_plus</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4. 0. 6.]
</pre></div>
</div>
</div>
</div>
<p>Aquí el valor de la variable <span class="math notranslate nohighlight">\(x_4\)</span> se hace cero y tenemos que intercambiar tal entrada con la de <span class="math notranslate nohighlight">\(x_2^+\)</span> para el vector <span class="math notranslate nohighlight">\(x_B\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_2_plus</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4. 6. 6.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Antes de hacer el intercambio de columnas: <span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ]\)</span> y la matriz original <span class="math notranslate nohighlight">\(A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\)</span></p>
</div>
<p>Como <span class="math notranslate nohighlight">\(x_4\)</span> se intercambia por <span class="math notranslate nohighlight">\(x_2\)</span> entonces se intercambia la columna <span class="math notranslate nohighlight">\(2\)</span> de <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(a_2\)</span>, por la <span class="math notranslate nohighlight">\(2\)</span> de <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(b_2\)</span> por lo que al final de la iteración 1:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[:,</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="n">idx_x_N</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(x_B =  \left [ \begin{array}{c} x_3 \\ x_2 \\ x_5 \end{array}\right ] = \left [ \begin{array}{c} 4 \\ 6 \\ 6 \end{array}\right ]\)</span>,  <span class="math notranslate nohighlight">\(x_N = \left [ \begin{array}{c} x_1 \\ x_4\end{array}\right ] = \left [ \begin{array}{c} 0 \\ 0\end{array}\right ]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">B_list_idx</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">B_list_idx</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_list_idx</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span>
<span class="n">N_list_idx</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La actualización de <span class="math notranslate nohighlight">\(x_B\)</span> anterior se puede verificar que es equivalente a:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_B = \left [ \begin{array}{c} x_3 \\ x_2 \\ x_5\end{array}\right ] = B^{-1}b = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]^{-1} \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ] =  \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{2} &amp; 0 \\ 0 &amp; -1 &amp; 1 \end{array} \right ]\left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ] = \left [ \begin{array}{c} 4 \\ 6 \\ 6 \end{array}\right ]  \end{split}\]</div>
</div>
</div>
<div class="section" id="id1">
<h3>Prueba de optimalidad<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Se recalcula el vector <span class="math notranslate nohighlight">\(\nu\)</span> considerando que <span class="math notranslate nohighlight">\(c_B =  \left [ \begin{array}{c} c_{B_3} \\ c_{B_2} \\ c_{B_5} \end{array}\right ]\)</span> tomando ahora <span class="math notranslate nohighlight">\(x_2\)</span> como básica.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} c_{B_3} \\ c_{B_2} \\ c_{B_5} \end{array} \right ] = \left [ \begin{array}{c} 0 \\ -5 \\ 0 \end{array} \right ]\)</span></p>
</div>
<p>El vector <span class="math notranslate nohighlight">\(\nu\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu = B^{-T}c_B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; \frac{1}{2} &amp; 0 \\ 0 &amp; -1 &amp; 1 \end{array} \right ] ^T \left [ \begin{array}{c} 0 \\ -5 \\ 0 \end{array}\right ] = \left [ \begin{array}{c} 0 \\ -\frac{5}{2} \\ 0 \end{array}\right ]\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Resolviendo un sólo sistema de ecuaciones lineales nos ayuda a evitar calcular la inversa de una matriz que implica resolver un sistema de ecuaciones lineales más grande.</p>
</div>
<p>Para el cálculo de <span class="math notranslate nohighlight">\(\nu\)</span> resolvemos el sistema de ecuaciones lineales para el vector de incógnitas <span class="math notranslate nohighlight">\(\nu\)</span>:</p>
<div class="math notranslate nohighlight">
\[B^T \nu = c_B\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">c_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">c_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span>
<span class="n">c_N</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.  -2.5  0. ]
</pre></div>
</div>
</div>
</div>
<p>Por tanto:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_N= \left [ \begin{array}{c}-3 \\ 0 \end{array} \right ]\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_1</span> <span class="o">=</span> <span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_4</span> <span class="o">=</span> <span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.5
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\lambda_{N_1} = -c_{N_1} + \nu^Ta_1 = 3  + [0 \quad -\frac{5}{2} \quad 0] \left [ \begin{array}{c} 1 \\ 0 \\ 3 \end{array}\right ] = 3\)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda_{N_4} = -c_{N_4} + \nu^Ta_4 = 0 + [0 \quad -\frac{5}{2} \quad 0]\left [ \begin{array}{c} 0 \\ 1 \\ 0 \end{array}\right ] = -2.5\)</span></p>
<p>Como tenemos un problema de maximización la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> la da la variable <span class="math notranslate nohighlight">\(x_1\)</span> por lo que es la variable no básica que sustituye a una variable básica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index for nonbasic variables, in this case value 0 correspond to x1</span>

<span class="n">idx_x_N</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<p>Valor de la función objetivo en la solución BF actual: <span class="math notranslate nohighlight">\(f_o(x) = -c^Tx =  -\nu^Tb = 30\)</span></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
f_o(x) &amp;=&amp; -c^Tx \nonumber\\
&amp;=&amp; -c_B^Tx_B - c_N^T x_N \nonumber\\
&amp;=&amp; -c_B^T x_B \quad \text{pues } x_N=0\\
\end{eqnarray}\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">c_B</span><span class="p">,</span> <span class="n">x_B</span> <span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30.0
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(f_o(x) = -\nu^Tb\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">nu</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30.0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Prueba del cociente mínimo<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La primer columna de <span class="math notranslate nohighlight">\(A\)</span> se elige pues <span class="math notranslate nohighlight">\(x_1\)</span> es la variable no básica a la que se le aumentará su valor y sustituirá a una variable básica.</p>
</div>
<p>Se resuelve la ecuación: <span class="math notranslate nohighlight">\(Bd = a_1\)</span> para <span class="math notranslate nohighlight">\(d\)</span> vector de incógnitas y <span class="math notranslate nohighlight">\(a_1\)</span> primera columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span> <span class="n">idx_x_N</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1. 0. 3.]
</pre></div>
</div>
</div>
</div>
<p>En esta iteración: <span class="math notranslate nohighlight">\(x_B = \left [ \begin{array}{c} x_3 \\ x_2 \\ x_5\end{array}\right ] = \left [ \begin{array}{c} 4 \\ 6 \\ 6 \end{array}\right ]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4. 6. 6.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se hace la división únicamente entre las entradas estrictamente positivas</p>
</div>
<div class="math notranslate nohighlight">
\[x_1^{+} = \min \{\frac{x_{B_i}}{d_i} : d_i &gt; 0, i = 1, 2, \dots, m \}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_positive</span> <span class="o">=</span> <span class="n">d</span> <span class="o">&gt;</span><span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4. 2.]
</pre></div>
</div>
</div>
</div>
<p>Entonces el mínimo ocurre en la tercera posición de <span class="math notranslate nohighlight">\(x_B\)</span> que corresponde a la variable básica <span class="math notranslate nohighlight">\(x_5\)</span>. Se elige <span class="math notranslate nohighlight">\(x_5\)</span> como variable básica que se vuelve no básica. <span class="math notranslate nohighlight">\(x_5\)</span> será sustituida por <span class="math notranslate nohighlight">\(x_1\)</span> en la próxima iteración.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#index for basic variables, in this case value 2 correspond to x5</span>

<span class="n">idx_x_B</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="iteracion-2">
<h3>Iteración 2<a class="headerlink" href="#iteracion-2" title="Permalink to this headline">¶</a></h3>
<p>La matriz <span class="math notranslate nohighlight">\(B\)</span> de la iteración anterior era:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\end{split}\]</div>
<p>y correspondía cada columna a las variables <span class="math notranslate nohighlight">\(x_3, x_2, x_5\)</span> en ese orden.</p>
<p>Se realiza la actualización descrita para <span class="math notranslate nohighlight">\(x_B\)</span>:</p>
<div class="math notranslate nohighlight">
\[x_B = x_B - dx_1^{+}\]</div>
<p>con <span class="math notranslate nohighlight">\(x_1\)</span> es la variable no básica que se volverá básica en la iteración actual.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_1_plus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">]</span><span class="o">/</span><span class="n">d</span><span class="p">[</span><span class="n">idx_positive</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_1_plus</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_B</span> <span class="o">=</span> <span class="n">x_B</span> <span class="o">-</span> <span class="n">d</span><span class="o">*</span><span class="n">x_1_plus</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2. 6. 0.]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p>Aquí el valor de la variable <span class="math notranslate nohighlight">\(x_5\)</span> se hace cero y tenemos que intercambiar tal entrada con la de <span class="math notranslate nohighlight">\(x_1^+\)</span> para el vector <span class="math notranslate nohighlight">\(x_B\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_1_plus</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2. 6. 2.]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La actualización de <span class="math notranslate nohighlight">\(x_B\)</span> anterior se puede verificar que es equivalente a:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_B = \left [ \begin{array}{c} x_3 \\ x_2 \\ x_1\end{array}\right ] = B^{-1}b = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 1 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 3 \end{array} \right ]^{-1} \left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ] =  \left [ \begin{array}{ccc} 1 &amp; \frac{1}{3} &amp; -\frac{1}{3} \\ 0 &amp; \frac{1}{2} &amp; 0 \\ 0 &amp; -\frac{1}{3} &amp; \frac{1}{3} \end{array} \right ]\left [ \begin{array}{c} 4 \\ 12 \\ 18 \end{array}\right ] = \left [ \begin{array}{c} 2 \\ 6 \\ 2 \end{array}\right ]\end{split}\]</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Antes de hacer el intercambio de columnas: <span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 1 \end{array} \right ]\)</span> y la matriz original <span class="math notranslate nohighlight">\( A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ]
\)</span></p>
</div>
<p>Como <span class="math notranslate nohighlight">\(x_5\)</span> se intercambia por <span class="math notranslate nohighlight">\(x_1\)</span> entonces se intercambia la columna <span class="math notranslate nohighlight">\(1\)</span> de <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(a_1\)</span>, por la <span class="math notranslate nohighlight">\(3\)</span> de <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(b_3\)</span> por lo que al final de la iteración <span class="math notranslate nohighlight">\(2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 1 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 3 \end{array} \right ]\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[:,</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="n">idx_x_N</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(x_B =  \left [ \begin{array}{c} x_3 \\ x_2 \\ x_1 \end{array}\right ] = \left [ \begin{array}{c} 2 \\ 6 \\ 2 \end{array}\right ]\)</span>,  <span class="math notranslate nohighlight">\(x_N = \left [ \begin{array}{c} x_5 \\ x_4\end{array}\right ] = \left [ \begin{array}{c} 0 \\ 0\end{array}\right ]\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">B_list_idx</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">B_list_idx</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">N_list_idx</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span>
<span class="n">N_list_idx</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h3>Prueba de optimalidad<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Se recalcula el vector <span class="math notranslate nohighlight">\(\nu\)</span> considerando que <span class="math notranslate nohighlight">\(c_B =  \left [ \begin{array}{c} c_{B_3} \\ c_{B_2} \\ c_{B_1} \end{array}\right ]\)</span> tomando ahora <span class="math notranslate nohighlight">\(x_1\)</span> como básica.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 1 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 3 \end{array} \right ]\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} c_{B_3} \\ c_{B_2} \\ c_{B_1} \end{array} \right ] = \left [ \begin{array}{c} 0 \\ -5 \\ -3 \end{array} \right ]\)</span></p>
</div>
<p>El vector <span class="math notranslate nohighlight">\(\nu\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nu = B^{-T}c_B = \left [ \begin{array}{ccc} 1 &amp; \frac{1}{3} &amp; -\frac{1}{3} \\ 0 &amp; \frac{1}{2} &amp; 0 \\ 0 &amp; -\frac{1}{3}&amp; \frac{1}{3} \end{array} \right ] ^T \left [ \begin{array}{c} 0 \\ -5 \\ -3 \end{array}\right ] = \left [ \begin{array}{c} 0 \\ -\frac{3}{2} \\ -1 \end{array}\right ]\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Resolviendo un sólo sistema de ecuaciones lineales nos ayuda a evitar calcular la inversa de una matriz que implica resolver un sistema de ecuaciones lineales más grande.</p>
</div>
<p>Para el cálculo de <span class="math notranslate nohighlight">\(\nu\)</span> resolvemos el sistema de ecuaciones lineales para el vector de incógnitas <span class="math notranslate nohighlight">\(\nu\)</span>:</p>
<div class="math notranslate nohighlight">
\[B^T \nu = c_B\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(B = \left [ \begin{array}{ccc} 1 &amp; 0 &amp; 1 \\ 0 &amp; 2 &amp; 0 \\ 0 &amp; 2 &amp; 3 \end{array} \right ]\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aux</span> <span class="o">=</span> <span class="n">c_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span>
<span class="n">c_B</span><span class="p">[</span><span class="n">idx_x_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span>
<span class="n">c_N</span><span class="p">[</span><span class="n">idx_x_N</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.  -1.5 -1. ]
</pre></div>
</div>
</div>
</div>
<p>Por tanto:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(c_N= \left [ \begin{array}{c}0 \\ 0 \end{array} \right ]\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_5</span> <span class="o">=</span> <span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_N_4</span> <span class="o">=</span> <span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_N_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.5
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(\lambda_{N_5} = -c_{N_5} + \nu^Ta_5 = 0 + [0 \quad -\frac{3}{2} \quad -1]\left [ \begin{array}{c} 0 \\ 0 \\ 1 \end{array}\right ] = -1\)</span></p>
<p><span class="math notranslate nohighlight">\(\lambda_{N_4} = -c_{N_4} + \nu^Ta_4 = 0 + [0 \quad -\frac{3}{2} \quad -1] \left [ \begin{array}{c} 0 \\ 1 \\ 0 \end{array}\right ] = -1.5\)</span></p>
<p><strong>Índices de las variables básicas:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">B_list_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[2, 1, 0]
</pre></div>
</div>
</div>
</div>
<p><strong>Índices de las variables no básicas:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">N_list_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 3]
</pre></div>
</div>
</div>
</div>
<p><strong>Valores de <span class="math notranslate nohighlight">\(\nu\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 0.  -1.5 -1. ]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que en el método símplex se mantiene en cada iteración <span class="math notranslate nohighlight">\(\lambda_{B_j} = 0 \forall j \in \mathcal{B}\)</span> y se <strong>busca</strong> que <span class="math notranslate nohighlight">\(\lambda_{N_j} \forall j \in \mathcal{N}\)</span> sea no negativo para problemas de minimización o no positivo para problemas de maximización.</p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Entonces al finalizar el método símplex aplicado al ejemplo:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda_{B_1} = \lambda_{B_2} = \lambda_{B_3} = 0\)</span> para los índices de las variables básicas <span class="math notranslate nohighlight">\(x_1, x_2, x_3\)</span>, <span class="math notranslate nohighlight">\(\mathcal{B} = \{1, 2, 3\}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda_{N_4} = -1.5\)</span>, <span class="math notranslate nohighlight">\(\lambda_{N_5} = -1\)</span> para los índices de las variables no básicas <span class="math notranslate nohighlight">\(x_4, x_5\)</span>, <span class="math notranslate nohighlight">\(\mathcal{N} = \{4, 5\}\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\nu_{1}  = 0, \nu_{2}  = -1.5, \nu_{3} = -1\)</span>.</p></li>
</ul>
</div>
<p>Como tenemos un problema de maximización la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> no la da ninguna de las variables no básicas por lo que la solución BF actual <span class="math notranslate nohighlight">\(x = \left [ \begin{array}{c} x_1\\ x_2\\ x_3\\ x_4 \\ x_5 \end{array} \right ]= \left [ \begin{array}{c} 2\\ 6\\ 2\\ 0 \\ 0 \end{array}\right ]\)</span> es la solución óptima.</p>
<p>Valor de la función objetivo en la solución BF actual: <span class="math notranslate nohighlight">\(f_o(x) = -c^Tx =  -\nu^Tb = 36\)</span></p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
f_o(x) &amp;=&amp; -c^Tx \nonumber\\
&amp;=&amp; -c_B^Tx_B - c_N^T x_N \nonumber\\
&amp;=&amp; -c_B^T x_B \quad \text{pues } x_N=0\\
\end{eqnarray}\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">c_B</span><span class="p">,</span> <span class="n">x_B</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>36.0
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(f_o(x) = -\nu^Tb\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="o">-</span><span class="n">nu</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>36.0
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Resuelve con el método de símplex y corrobora con algún software tu respuesta:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{x \in \mathbb{R}^3}x_1 + x_2 - 4x_3\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a:}\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_2 + 2x_3 \leq 9\]</div>
<div class="math notranslate nohighlight">
\[x_1 + x_2 - x_3 \leq 2\]</div>
<div class="math notranslate nohighlight">
\[-x_1 + x_2 + x_3 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0 , x_3 \geq 0\]</div>
</div>
</div>
</div>
<div class="section" id="consideraciones-sobre-el-metodo-simplex">
<h2>Consideraciones sobre el método símplex<a class="headerlink" href="#consideraciones-sobre-el-metodo-simplex" title="Permalink to this headline">¶</a></h2>
<p>Al método símplex anteriormente descrito se le tienen que añadir funcionalidades para realizar una implementación que maneje los siguientes puntos:</p>
<ul class="simple">
<li><p>Sobre empates en la variable básica, no básica.</p></li>
<li><p>Sobre el álgebra matricial numérica.</p></li>
<li><p>Sobre variables básicas degeneradas.</p></li>
<li><p>Sobre variables de decisión con cotas inferiores distintas de cero, con cotas superiores.</p></li>
</ul>
<p>No se profundizará sobre los mismos y se sugiere ir a las referencias de esta nota para su consulta.</p>
</div>
<div class="section" id="pl-s-large-scale">
<h2>PL’s <em>large scale</em><a class="headerlink" href="#pl-s-large-scale" title="Permalink to this headline">¶</a></h2>
<p>Los PL’s que modelan aplicaciones reales tienden a encontrarse en la clasificación <em>large scale</em>. Tal término aunque es ambiguo pues depende la máquina en la que se realice el cómputo e involucra el número de variables o parámetros y cantidad de almacenamiento para datos, lo asociamos con problemas de optimización <strong>con restricciones</strong> que tienen un número de variables y restricciones mayor o igual a <span class="math notranslate nohighlight">\(10^3\)</span> (ambas).</p>
<div class="section" id="enunciado-de-un-ejemplo-para-un-problema-large-scale">
<h3>Enunciado de un ejemplo para un problema <em>large scale</em><a class="headerlink" href="#enunciado-de-un-ejemplo-para-un-problema-large-scale" title="Permalink to this headline">¶</a></h3>
<p>Supóngase que al igual que en el <a class="reference internal" href="#ejprototipo"><span class="std std-ref">ejemplo prototipo</span></a> una compañía desea resolver un problema de <strong>mezcla de productos</strong>. Tal compañía tiene <span class="math notranslate nohighlight">\(10\)</span> plantas en varias partes del mundo. Cada una elabora los mismos <span class="math notranslate nohighlight">\(10\)</span> productos y después los vende en su región. Se conoce la demanda (ventas potenciales) de cada producto en cada planta en cada uno de los próximos <span class="math notranslate nohighlight">\(10\)</span> meses. Aunque la cantidad de producto vendido en un mes dado no puede exceder la demanda, la cantidad producida puede ser mayor, y la cantidad en exceso se debería almacenar en inventario (con un costo unitario por mes) para su venta posterior. Cada unidad de cada producto ocupa el mismo espacio en almacén y cada planta tiene un límite superior para el número total de unidades que se puede guardar (la capacidad del inventario).</p>
<p>Cada planta realiza los <span class="math notranslate nohighlight">\(10\)</span> procesos de producción con máquinas y tales máquinas se pueden usar para producir cualquiera de los <span class="math notranslate nohighlight">\(10\)</span> productos. Tanto el costo de producción por unidad como la tasa de producción de un producto (número de unidades producidas por día dedicado a ese producto) dependen de la <strong>combinación</strong> de plantas y máquinas involucradas y no del mes que se realizará la producción. El número de días hábiles (días de producción disponibles) varía un poco de un mes a otro.</p>
<p>Como algunas plantas y máquinas pueden producir un producto dado ya sea a menor costo o a una tasa más rápida que otras plantas y máquinas, en ocasiones vale la pena enviar algunas unidades del producto de una planta a otra para que esta última las venda. Existe cierto costo asociado con cada unidad enviada de cualquier producto de cada <strong>combinación</strong> de una planta que envía (planta origen) y una planta que recibe (planta destino), donde este costo unitario es el mismo para todos los productos.</p>
<p>La administración necesita determinar cuántas unidades de cada producto debe producir en cada máquina de cada planta cada mes, al igual que cuántas unidades de cada producto deb vender cada planta cada mes y cuántas unidades de cada producto debe enviar cada planta cada mes a cada una de las otras plantas. Si se toma en cuenta el precio en todo el mundo de cada producto, el objetivo es encontrar el plan factible que maximice la ganancia total: ingreso por ventas totales menos la suma de los costos totales de producción, inventario y envío.</p>
<p>Debido a los costos de inventario y a que las capacidades de almacenamiento son limitadas, es necesario mantener un registro de la cantidad de cada producto que se guarda en cada planta durante cada mes.</p>
<p><strong>Variables de decisión</strong></p>
<p>El modelo PL tiene cuatro tipo de variables de decisión: cantidades de producción, cantidades de inventario, cantidades de venta y cantidades enviadas. Con <span class="math notranslate nohighlight">\(10\)</span> plantas, <span class="math notranslate nohighlight">\(10\)</span> máquinas, <span class="math notranslate nohighlight">\(10\)</span> productos y <span class="math notranslate nohighlight">\(10\)</span> meses da un total de <span class="math notranslate nohighlight">\(21, 000\)</span> variables de decisión.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(10,000\)</span> variables de producción: una por cada <strong>combinación</strong> de planta, máquina, producto y mes.</p></li>
<li><p><span class="math notranslate nohighlight">\(1,000\)</span> variables de inventario: una por cada <strong>combinación</strong> de planta, producto y mes.</p></li>
<li><p><span class="math notranslate nohighlight">\(1,000\)</span> variables de ventas: una por cada <strong>combinación</strong> de planta, producto y mes.</p></li>
<li><p><span class="math notranslate nohighlight">\(9,000\)</span> variables de envío: una por cada <strong>combinación</strong> de producto, mes, planta (planta origen) y otra planta (la planta destino). (Para las combinaciones de las plantas origen-destino, realícense combinaciones de <span class="math notranslate nohighlight">\(10\)</span> en <span class="math notranslate nohighlight">\(2\)</span> y multiplíquese por <span class="math notranslate nohighlight">\(2\)</span> por la designación de planta origen-destino).</p></li>
</ul>
<p><strong>Función objetivo</strong></p>
<p>Al multiplicar cada variable de decisión por el costo unitario o ingreso unitario correspondiente y sumar según cada tipo, se tiene: “Maximizar ganancia=ingresos totales por ventas - costo total” donde: “costo total = costo total de producción + costo total de inventario + costo total de envío”.</p>
<p><strong>Restricciones funcionales</strong></p>
<p>Las <span class="math notranslate nohighlight">\(21,000\)</span> variables de decisión deben satisfacer las restricciones de no negatividad al igual que los cuatro tipos de restricciones funcionales: de capacidad de producción, de balanceo de plantas (restricciones de igualdad que proporcionan valores adecuados para las variables de inventario), de inventario máximo y de ventas máximas. En total se tienen <span class="math notranslate nohighlight">\(3,100\)</span> restricciones funcionales.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1,000\)</span> restricciones de capacidad de producción, una por cada combinación de planta, máquina y mes:</p></li>
</ul>
<p>“Días de producción usados <span class="math notranslate nohighlight">\(\leq\)</span> días de producción disponibles,</p>
<p>donde: el lado izquierdo es la suma de <span class="math notranslate nohighlight">\(10\)</span> fracciones, una por cada producto. Cada fracción es la cantidad de ese producto (una variable de decisión) dividida entre la tasa de producción del producto (una constante dada).</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1,000\)</span> restricciones de balance de plantas, una por cada combinación de planta, producto y mes:</p></li>
</ul>
<p>“Cantidad producida + inventario del mes pasado + cantidad recibida = ventas + inventario actual + cantidad enviada”,</p>
<p>donde: la “cantidad producida” es la suma de las variables de decisión que representan las cantidades de producción de las máquinas, la “cantidad recibida” es la suma de las variables de decisión que representan las cantidades enviadas desde otras plantas y la “cantidad enviada” es la suma de las variables de decisión correspondientes a las cantidades que se mandan a las otras plantas.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(100\)</span> restricciones de inventario máximo, una por cada combinación de planta y mes:</p></li>
</ul>
<p>“Inventario total <span class="math notranslate nohighlight">\(\leq\)</span> capacidad del inventario”,</p>
<p>donde: el lado izquierdo es la suma de las variables de decisión que representan las cantidades de inventario de los productos individuales.</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1,000\)</span> restricciones de ventas, una por cada combinación de planta, producto y mes:</p></li>
</ul>
<p>“Ventas <span class="math notranslate nohighlight">\(\leq\)</span> demanda”</p>
<p><strong>¿Cómo escribir el problema anterior y resolverlo en un lenguaje de programación?</strong></p>
<p>Podemos utilizar lenguajes de modelado, <a class="reference external" href="https://en.wikipedia.org/wiki/Modeling_language#Algebraic">modeling languages</a> que permiten el uso de <em>solvers</em> como:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.cvxpy.org/">cvxpy</a>, <a class="reference external" href="http://cvxr.com/cvx/">cvx</a>, <a class="reference external" href="https://cvxr.rbind.io/">cvxr</a>, <a class="reference external" href="https://github.com/jump-dev/Convex.jl">Convex</a>, <a class="reference external" href="https://cvxopt.org/">cvxopt</a></p></li>
<li><p><a class="reference external" href="https://github.com/google/or-tools">or-tools</a></p></li>
<li><p><a class="reference external" href="https://github.com/jump-dev/JuMP.jl">JuMP</a></p></li>
<li><p><a class="reference external" href="https://ampl.com/">AMPL</a>, <a class="reference external" href="https://ampl.com/api/nightly/python/">AMPL Python API</a>, <a class="reference external" href="https://ampl.com/api/nightly/R/">AMPL R API</a>, <a class="reference external" href="https://ampl.com/api/nightly/matlab/">AMPL MATLAB API</a></p></li>
</ul>
</div>
</div>
<div class="section" id="unas-palabras-sobre-pl-entera-y-metodos">
<h2>Unas palabras sobre PL entera y métodos<a class="headerlink" href="#unas-palabras-sobre-pl-entera-y-metodos" title="Permalink to this headline">¶</a></h2>
<p>Uno de los <strong>supuestos</strong> de la PL es la de divisibilidad que requiere que las variables de decisión puedan tomar valores no enteros. En el <a class="reference internal" href="#ejflujoenredesypl"><span class="std std-ref">ejemplo de flujo en redes</span></a> se vio que con <code class="docutils literal notranslate"><span class="pre">cvxpy</span></code> se puede resolver tal problema imponiendo la restricción que las variables de decisión sean enteras. Esto ocurre en muchos problemas prácticos por ejemplo si consideramos a personas, cajas que contengan materiales o vehículos. Un PL al tener la restricción anterior se le nombra <strong>problema de programación entera (PE)</strong>.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Siendo rigurosos el nombre sería programación lineal entera pero es más común omitir “lineal” a menos que se encuentre en un contexto de programación no lineal entera.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Si un PL admite variables de decisión que sean enteras y otras cumplan con el supuesto de divisibilidad entonces se nombra al problema de optimización <strong>programación entera mixta (PEM)</strong>.</p></li>
<li><p>Si las variables de decisión únicamente toman valores binarios (por ejemplo decisiones “sí”, “no”) se le nombra al problema de optimización <strong>programación entera binaria (PEB)</strong>.</p></li>
</ul>
</div>
<div class="section" id="ejemplo-prototipo-de-peb">
<h3>Ejemplo prototipo de PEB<a class="headerlink" href="#ejemplo-prototipo-de-peb" title="Permalink to this headline">¶</a></h3>
<p>Suponga que una compañía analiza la posibilidad de llevar a cabo una expansión mediante la construcción de fábricas ya sea en Monterrey <strong>o</strong> en Torreón. También piensa en construir, <strong>a lo sumo</strong>, un nuevo almacén, pero la decisión sobre el lugar en donde lo instalará está restringida a la ciudad donde se construyan las fábricas. Se presenta la siguiente tabla con datos del valor presente neto (VPN, rendimiento total que toma en cuenta el valor del dinero en el tiempo), el capital requerido y el disponible para llevar a cabo tal obra:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Número de decisión</p></th>
<th class="text-align:center head"><p>Pregunta</p></th>
<th class="text-align:center head"><p>Variable de decisión</p></th>
<th class="text-align:center head"><p>VPN</p></th>
<th class="text-align:center head"><p>Capital requerido</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>¿Construir la fábrica en Monterrey?</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_1\)</span></p></td>
<td class="text-align:center"><p>9 millones</p></td>
<td class="text-align:center"><p>6 millones</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>¿Construir la fábrica en Torreón?</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_2\)</span></p></td>
<td class="text-align:center"><p>5 millones</p></td>
<td class="text-align:center"><p>3 millones</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>¿Construir el almacén en Monterrey?</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_3\)</span></p></td>
<td class="text-align:center"><p>6 millones</p></td>
<td class="text-align:center"><p>5 millones</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>¿Construir el almacén en Torreón?</p></td>
<td class="text-align:center"><p><span class="math notranslate nohighlight">\(x_4\)</span></p></td>
<td class="text-align:center"><p>4 millones</p></td>
<td class="text-align:center"><p>2 millones</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>-</p></td>
<td class="text-align:center"><p>-</p></td>
<td class="text-align:center"><p>-</p></td>
<td class="text-align:center"><p>Capital disponible:</p></td>
<td class="text-align:center"><p>10 millones</p></td>
</tr>
</tbody>
</table>
<p>En la tabla anterior se muestra el VPN de cada alternativa. En la última columna se proporciona el capital que se requiere (incluido el VPN) para las inversiones, donde el capital total disponible es de 10 millones de pesos. El <strong>objetivo</strong> es encontrar la combinación factible de alternativas que maximice el VPN.</p>
</div>
<div class="section" id="el-modelo-peb">
<h3>El modelo PEB<a class="headerlink" href="#el-modelo-peb" title="Permalink to this headline">¶</a></h3>
<p>Sean las variables de decisión:</p>
<div class="math notranslate nohighlight">
\[\begin{split}x_j = \begin{cases} 1 &amp; \text{ si la decisión } j \text{ es sí }\\
2 &amp; \text{si la decisión } j \text{ es no }
\end{cases}, \quad j=1, 2, 3, 4
\end{split}\]</div>
<p>y la función objetivo: <span class="math notranslate nohighlight">\(f_o(x) = 9x_1 + 5x_2 + 6x_3 + 4x_4\)</span> que represente el VPN de estas decisiones.</p>
<p>Dados los datos de la tabla anterior una restricción del modelo es:</p>
<div class="math notranslate nohighlight">
\[6x_1 + 3x_2 + 5x_3 + 2x_4 \leq 10\]</div>
<p>por el capital disponible.</p>
<p>Las siguientes restricciones tienen que ver con</p>
<ul class="simple">
<li><p><strong>alternativas mutuamente excluyentes</strong> dado que la compañía quiere construir <strong>cuando mucho</strong> un almacén nuevo.</p></li>
<li><p><strong>decisiones condicionales</strong> dado que la compañía consideraría la construcción de un almacén en determinada ciudad <strong>sólo si</strong> la nueva fábrica va a estar ahí.</p></li>
</ul>
<p>Tales restricciones se modelan como:</p>
<div class="math notranslate nohighlight">
\[x_3 + x_4 \leq 1\]</div>
<p>para las alternativas mutuamente excluyentes y</p>
<div class="math notranslate nohighlight">
\[x_3 \leq x_1\]</div>
<div class="math notranslate nohighlight">
\[x_4 \leq x_2\]</div>
<p>para las decisiones condicionales.</p>
<p>Entonces el PEB es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max_{x \in \mathbb{R}^4} 9x_1 + 5x_2 + 6x_3 + 4x_4\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[6x_1 + 3x_2 + 5x_3 + 2x_4 \leq 10\]</div>
<div class="math notranslate nohighlight">
\[x_3 + x_4  \leq 1\]</div>
<div class="math notranslate nohighlight">
\[-x_1 + x_3 \leq 0\]</div>
<div class="math notranslate nohighlight">
\[-x_2 + x_4 \leq 0\]</div>
<div class="math notranslate nohighlight">
\[x_j \in \{0,1\}, \quad j=1, 2, 3, 4\]</div>
<div class="tip admonition">
<p class="admonition-title">Observaciones</p>
<ul class="simple">
<li><p>La última restricción es equivalente a <span class="math notranslate nohighlight">\(0 \leq x_j \leq 1\)</span> y <span class="math notranslate nohighlight">\(x_j\)</span> entera.</p></li>
<li><p>Si en el problema se especifica que se quiere construir <strong>exactamente</strong> una fábrica en Monterrey o Torreón no importando la ciudad, entonces se añadiría la restricción <span class="math notranslate nohighlight">\(x_1 + x_2 = 1\)</span>.</p></li>
</ul>
</div>
</div>
<div class="section" id="consideraciones-sobre-los-modelos-de-pe">
<h3>Consideraciones sobre los modelos de PE<a class="headerlink" href="#consideraciones-sobre-los-modelos-de-pe" title="Permalink to this headline">¶</a></h3>
<p>Podría pensarse que los PE son más sencillos de resolver que los PL, lo cual no es correcto en general principalmente por algunas razones que se enlistan a continuación:</p>
<ul class="simple">
<li><p>Un número finito de soluciones factibles no asegura que un problema se pueda resolver. Por ejemplo, en el PEB si se tienen <span class="math notranslate nohighlight">\(n\)</span> variables, existen <span class="math notranslate nohighlight">\(2^n\)</span> soluciones que considerar aproximadamente (quizás algunas se puedan eliminar). Con <span class="math notranslate nohighlight">\(n=10\)</span> se tienen mil soluciones y <span class="math notranslate nohighlight">\(n=30\)</span> más de mil millones. Por lo que enlistar las soluciones factibles no es un buen método para resolver problemas de PEB (o PE).</p></li>
<li><p>Resolver un PL <strong>relajado</strong> que resulta del PE eliminando la restricción de variables enteras no siempre resuelve el PE original. Esto sólo ocurre en algunos casos especiales como es el problema del flujo de costo mínimo con parámetros enteros. Ver <a class="reference internal" href="#ejflujoenredesypl"><span class="std std-ref">ejemplo de flujo en redes</span></a> redondeando la solución de <code class="docutils literal notranslate"><span class="pre">scipy</span></code> que se obtuvo. La <strong>clave</strong> de la eficiencia del método símplex es la continuidad de las variables de decisión.</p></li>
<li><p>Los tres factores determinantes de la dificultad computacional de un problema de PE son:</p></li>
</ul>
<p>1)El número de variables enteras</p>
<p>2)Variables enteras ¿binarias o generales?</p>
<p>3)Estructura especial del problema.</p>
<p>Contrástese esto con la situación que la presencia de restricciones en un PL es más importante que el número de variables. En la PE el número de restricciones es secundario a los factores anteriores.</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Existen casos en los que aumentar el número de restricciones disminuye el número de soluciones factibles y por tanto el tiempo de cálculo.</p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Aunque resulta tentador resolver los PE como si fueran PL (trabajarlos como relajados) y redondear el resultado se corren riesgos:</p>
<ul>
<li><p>No necesariamente una solución óptima del PL será factible después de redondearla.</p></li>
<li><p>No existe garantía de que la solución redondeada sea la solución óptima del PE.</p></li>
</ul>
</li>
</ul>
<p>Aún así hay algoritmos de PE que utilizan en sus pasos intermedios resolver PL relajados.</p>
</div>
</div>
<div class="section" id="sobre-algoritmos-de-pe">
<h3>Sobre algoritmos de PE<a class="headerlink" href="#sobre-algoritmos-de-pe" title="Permalink to this headline">¶</a></h3>
<p>Los ejemplos anteriores muestran la cantidad de variables y restricciones que pueden surgir en un problema real debido al número de combinaciones posibles que resultan. En particular el área de optimización que se relaciona con el número de combinaciones que resultan de enumerar el conjunto solución en el que las soluciones factibles son discretas es la área de <a class="reference external" href="https://en.wikipedia.org/wiki/Combinatorial_optimization">optimización combinatoria</a>.</p>
<p>Si bien el método símplex y métodos de puntos interiores (ver <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#intmetpin"><span class="std std-ref">introducción a los métodos de puntos interiores</span></a>) han probado ser métodos para abordar una amplia variedad de problemas prácticos de PL no siempre funcionan en problemas que surgen en la optimización combinatoria. Por ejemplo, en un problema en el que el número de restricciones funcionales sea mayor al del número de variables, el método símplex deberá realizar un esfuerzo computacional grande. Por lo que se han desarrollado algoritmos específicos para la PE. Dentro de los algoritmos más populares en los PE, PEM se encuentra el de <a class="reference external" href="https://en.wikipedia.org/wiki/Branch_and_bound">ramificación y acotamiento</a> (aplica la idea de <a class="reference external" href="https://en.wikipedia.org/wiki/Divide-and-conquer_algorithm">divide y vencerás</a>) y <a class="reference external" href="https://en.wikipedia.org/wiki/Cutting-plane_method">cortes de Gomory</a>.</p>
</div>
<div class="section" id="sobre-metodos-heuristicos-en-optimizacion-combinatoria">
<h3>Sobre métodos heurísticos en optimización combinatoria<a class="headerlink" href="#sobre-metodos-heuristicos-en-optimizacion-combinatoria" title="Permalink to this headline">¶</a></h3>
<p>Los métodos <a class="reference external" href="https://en.wikipedia.org/wiki/Heuristic_(computer_science)">heurísticos</a> y <a class="reference external" href="https://en.wikipedia.org/wiki/Metaheuristic">meta heurísticas</a> (estrategias para mejorar o diseñar métodos heurísticos) encuentran una buena solución factible que al menos está razonablemente cerca de ser óptima, también pueden reportar que no se encontró tales soluciones. Sin embargo son métodos que no dan una garantía acerca de la calidad de la solución que se obtiene.</p>
<p>Los métodos heurísticos se desarrollaron principalmente para el manejo de problemas <em>large scale</em> sean PL’s o de optimización combinatoria. Típicamente se han ajustado a problemas específicos en lugar de una variedad de aplicaciones.</p>
<p>Como se mencionó anteriormente no existe garantía de que la mejor solución que se encuentre con un método heurístico sea una solución óptima o incluso que esté cerca de serlo. Por tanto, siempre que sea posible resolver un problema mediante un algoritmo que pueda garantizar optimalidad, debe usarse éste en lugar de uno heurístico. El papel de los métodos heurísticos es abordar problemas que son muy grandes y complicados como para resolverlos por medio de algoritmos exactos.</p>
</div>
<div class="section" id="ejemplos-vehicle-routing-problem-aka-vrp-y-travelling-salesman-problem-aka-tsp">
<h3>Ejemplos: <a class="reference external" href="https://en.wikipedia.org/wiki/Vehicle_routing_problem"><em>Vehicle routing problem</em></a>,<em>aka VRP</em>, y <a class="reference external" href="https://en.wikipedia.org/wiki/Travelling_salesman_problem"><em>Travelling Salesman Problem</em></a>, <em>aka TSP</em><a class="headerlink" href="#ejemplos-vehicle-routing-problem-aka-vrp-y-travelling-salesman-problem-aka-tsp" title="Permalink to this headline">¶</a></h3>
<p>Problema del VRP: encontrar las rutas óptimas para vehículos de modo que satisfagan las demandas de clientes. Este problema generaliza al del TSP: dada una lista de ciudades y las distancias entre cada par de ellas, ¿cuál es la ruta más corta posible que visita cada ciudad exactamente una vez y al finalizar regresa a la ciudad origen?</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Un TSP con <span class="math notranslate nohighlight">\(10\)</span> ciudades requiere menos de <span class="math notranslate nohighlight">\(200,000\)</span> soluciones factibles que deben ser consideradas, un problema con <span class="math notranslate nohighlight">\(20\)</span> ciudades tiene alrededor de <span class="math notranslate nohighlight">\(10^{16}\)</span> y uno con <span class="math notranslate nohighlight">\(50\)</span> ciudades tiene alrededor de <span class="math notranslate nohighlight">\(10^{62}\)</span>.</p>
</div>
</div>
<div class="section" id="ejemplos-de-algoritmos-heuristicos-o-meta-heuristicas">
<h3>Ejemplos de algoritmos heurísticos o meta heurísticas<a class="headerlink" href="#ejemplos-de-algoritmos-heuristicos-o-meta-heuristicas" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Greedy_algorithm">Greedy algorithm</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Alpha-beta_pruning">Alpha-beta pruning</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Best-first_search">Best-first search</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Simulated_annealing">Simulated annealing</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Tabu_search">Tabu search</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Hill_climbing">Hill climbing</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Genetic_algorithm">Genetic algorithm</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Particle_swarm_optimization">Particle swarm optimization</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Ant_colony_optimization">Ant colony optimization</a></p></li>
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/Guided_Local_Search">Guided local search</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Christofides_algorithm">Christofides algorithm</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Nelder%E2%80%93Mead_method">Nelder–Mead method</a></p></li>
</ul>
<p>El paquete <a class="reference external" href="https://github.com/google/or-tools">or-tools</a> es un paquete de <em>Python</em> que tiene métodos como los anteriores y también para resolver PL’s y de optimización de flujo en redes. Ver <a class="reference external" href="https://developers.google.com/optimization/introduction/overview">About OR-Tools</a>, <a class="reference external" href="https://developers.google.com/optimization/routing/routing_options">routing_options</a>, <a class="reference external" href="https://developers.google.com/optimization/routing">routing</a>.</p>
<p>La librería <a class="reference external" href="http://www.math.uwaterloo.ca/tsp/concorde.html">concorde</a> escrita en C resuelve tipo de problemas  TSP y de optimización de flujo en redes con cómputo en paralelo. Ver <a class="reference external" href="http://comopt.ifi.uni-heidelberg.de/software/TSPLIB95/">TSPLIB</a> para instancias de problemas TSP.</p>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Preguntas de comprehensión</strong></p>
<p>1)Escribe el modelo de programación lineal en forma estándar con nomenclatura matemática y asócialo con la forma estándar de un problema de optimización convexa. ¿Cómo se escribe el problema de optimización convexa en el caso de programación lineal?.</p>
<p>2)Describe con palabras coloquiales lo que se desea realizar en un programa lineal y algunos de sus supuestos.</p>
<p>3)Describe al problema de mezcla de productos.</p>
<p>4)¿Qué es un poliedro y cómo se obtienen poliedros en un PL?</p>
<p>5)¿Qué es una solución factible en un vértice?</p>
<p>6)¿Qué es una solución básica factible?</p>
<p>7)¿Qué es la <em>basis</em> y <em>nonbasis</em> <em>matrix</em>?</p>
<p>8)¿Qué es una variable básica degenerada? e investiga qué es lo que causa en el método símplex tener tales variables básicas.</p>
<p>9)¿Qué es una variable de holgura y para qué fueron utilizadas en la nota?</p>
<p>10)Describe el proceso de pivoteo en el método símplex.</p>
<p>11)Investiga qué es lo que puede concluirse a partir del método símplex si se elige una variable no básica que puede entrar al conjunto de variables básicas y en la prueba del cociente mínimo todos los denominadores son negativos.</p>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>F. Hillier, G. Lieberman, Introduction to Operations Research, Mc Graw Hill, 2014.</p></li>
<li><p>R. K. Ahuja, T. L. Magnanti, J. B. Orlin, Network Flows, Theory, Algorithms and Applications, Prentice Hall, 1993.</p></li>
<li><p>M. S. Bazaraa, J. J. Jarvis, H. D. Sherali, Linear Programming and Network Flows, Wiley, 2010.</p></li>
<li><p>J. Nocedal, S. J. Wright, Numerical Optimization, Springer, 2006.</p></li>
</ol>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./IV.optimizacion_en_redes_y_prog_lineal/4.2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../4.1/Definiciones_generales_de_flujo_en_redes.html" title="previous page">4.1 Definiciones generales de flujo en redes</a>
    <a class='right-next' id="next-link" href="../4.3/Ejemplo_metodo_simplex_de_redes.html" title="next page">4.3 Ejemplo del método símplex de redes</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>