
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.5 Puntos interiores" href="../4.5/Puntos_interiores.html" />
    <link rel="prev" title="4.3 Ejemplo del método símplex de redes" href="../4.3/Ejemplo_metodo_simplex_de_redes.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.3/Ejemplo_metodo_simplex_de_redes.html">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.5/Puntos_interiores.html">
   4.5 Puntos interiores
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Algoritmos de optimizacion convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.1/Puntos_interiores.html">
   5.1 Puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.2/Problemas_CECO.html">
   5.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.algoritmos_optimizacion_convexa/5.3/Problemas_CIECO.html">
   5.2 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/IV.optimizacion_en_redes_y_prog_lineal/4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/IV.optimizacion_en_redes_y_prog_lineal/4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ejemplo-prototipo">
   Ejemplo prototipo
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpretacion-del-problema-dual">
   Interpretación del problema dual
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#funcion-objetivo-y-variable-de-optimizacion-del-problema-dual">
     Función objetivo y variable de optimización del problema dual
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lados-izquierdos-de-las-restricciones-funcionales">
     Lados izquierdos de las restricciones funcionales
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#restricciones-funcionales-y-de-no-negatividad">
     Restricciones funcionales y de no negatividad
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#forma-aumentada-del-problema-dual">
   Forma aumentada del problema dual
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variables-basicas-y-no-basicas-del-problema-dual">
   Variables básicas y no básicas del problema dual
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#relaciones-entre-el-problema-primal-y-el-problema-dual">
   Relaciones entre el problema primal y el problema dual
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-1">
     Relación 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-2">
     Relación 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-3-holgura-complementaria">
     Relación 3: holgura complementaria
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-4">
     Relación 4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-5">
     Relación 5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-6-dualidad-debil">
     Relación 6: dualidad débil
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#relacion-7-dualidad-fuerte">
     Relación 7: dualidad fuerte
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resultados-de-la-dualidad-debil-y-dualidad-fuerte">
     Resultados de la dualidad débil y dualidad fuerte
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lema-de-farkas">
   Lema de Farkas
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpretacion-geometrica">
     Interpretación geométrica
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#condiciones-kkt-de-optimalidad-para-pl-s">
   Condiciones KKT de optimalidad para PL’s
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#relacion-entre-el-lemma-de-farkas-y-las-condiciones-de-kkt">
   Relación entre el lemma de Farkas y las condiciones de KKT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#el-metodo-simplex-y-las-condiciones-kkt">
   El método símplex y las condiciones KKT
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="dualidad-lema-de-farkas-y-condiciones-de-karush-kuhn-tucker-kkt-de-optimalidad">
<span id="dualidadlemafarkascondkkt"></span><h1>4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad<a class="headerlink" href="#dualidad-lema-de-farkas-y-condiciones-de-karush-kuhn-tucker-kkt-de-optimalidad" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion_2</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li></li>
</ul>
</div>
<div class="section" id="ejemplo-prototipo">
<h2>Ejemplo prototipo<a class="headerlink" href="#ejemplo-prototipo" title="Permalink to this headline">¶</a></h2>
<p>Considérese el problema planteado en <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejprototipo"><span class="std std-ref">ejemplo prototipo</span></a> con sus suposiciones. El objetivo es elegir los valores de <span class="math notranslate nohighlight">\(x_1, x_2\)</span> que maximicen <span class="math notranslate nohighlight">\(f_o\)</span>, la ganancia total, sujeta a las restricciones impuestas sobre sus valores por las capacidades de producción limitadas disponibles en las tres plantas. Esto es, resolver el PL siguiente:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[x_1 \leq 4\]</div>
<div class="math notranslate nohighlight">
\[2x_2 \leq 12\]</div>
<div class="math notranslate nohighlight">
\[3x_1 + 2x_2 \leq 18\]</div>
<div class="math notranslate nohighlight">
\[x_1 \geq 0, x_2 \geq 0\]</div>
<p>El término <span class="math notranslate nohighlight">\(3x_1\)</span> representa la ganancia generada (en miles de pesos) cuando se fabrica el producto 1 a una tasa de <span class="math notranslate nohighlight">\(x_1\)</span> lotes por semana. Se tienen contribuciones individuales de cada producto a la ganancia. Se desea determinar cuáles tasas de producción (no negativas) deben tener los dos productos con el fin de maximizar la ganancia total sujeta a las restricciones impuestas por las capacidades de producción limitadas disponibles en las tres plantas.</p>
<p>La región factible y el valor óptimo del PL anterior es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#x_1 ≤ 4</span>

<span class="n">point1_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point2_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point1_point2_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_1</span><span class="p">,</span> <span class="n">point2_x_1</span><span class="p">))</span>

<span class="c1">#x_1 ≥ 0</span>
<span class="n">point3_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">point3_point4_x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_1</span><span class="p">,</span> <span class="n">point4_x_1</span><span class="p">))</span>

<span class="c1">#2x_2 ≤ 12 or x_2 ≤ 6</span>

<span class="n">point1_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point2_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">point1_point2_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point1_x_2</span><span class="p">,</span> <span class="n">point2_x_2</span><span class="p">))</span>

<span class="c1">#x_2 ≥ 0</span>

<span class="n">point3_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point4_x_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">point3_point4_x_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point3_x_2</span><span class="p">,</span> <span class="n">point4_x_2</span><span class="p">))</span>

<span class="c1">#3x_1 + 2x_2 ≤ 18</span>

<span class="n">x_1_region_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2_region_1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1_region_1</span><span class="p">)</span>


<span class="n">x_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">x_2</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">18</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">x_1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span>
         <span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span>
            <span class="n">facecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;$x_1 = 4$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_1 = 0$&quot;</span><span class="p">,</span> 
            <span class="s2">&quot;$2x_2 = 12$&quot;</span><span class="p">,</span> <span class="s2">&quot;$x_2 = 0$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;$3x_1+2x_2 = 18$&quot;</span><span class="p">,</span> <span class="s2">&quot;(óptimo, valor óptimo)&quot;</span><span class="p">],</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Región factible del PL&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad_16_0.png" src="../../_images/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad_16_0.png" />
</div>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Asociado a todo problema de programación lineal existe otro problema lineal con nombre <strong>dual</strong>. Al problema “original” se le nombra <strong>primal</strong>.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Realmente no importa a cuál de los problemas se le dé el nombre primal y a cuál el de dual. La convención es que el modelo que se formula para representar el problema real recibe el nombre de problema primal no importando la forma que tiene (estándar u otra).</p>
</div>
<p>El problema <strong>primal</strong> anterior escrito en notación vectorial y matricial es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \max_{x \in \mathbb{R}^2} (-c)^Tx\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[Ax \leq b\]</div>
<div class="math notranslate nohighlight">
\[x \geq 0\]</div>
<p>donde: <span class="math notranslate nohighlight">\(
A= 
\left [
\begin{array}{cc}
1 &amp; 0 \\
0 &amp; 2 \\
3 &amp; 2 \\
\end{array}
\right ], x=
\left [
\begin{array}{c}
x_1 \\
x_2 \\
\end{array}
\right ], b=
\left[
\begin{array}{c}
4 \\
12 \\
18
\end{array}
\right ]\)</span> y
<span class="math notranslate nohighlight">\(c = \left [ \begin{array}{c} -3 \\ -5 \end{array}\right]\)</span> representa al vector de costos unitarios o equivalentemente <span class="math notranslate nohighlight">\(-c\)</span> el vector de ganancias unitarias. La última desigualdad se refiere a que todas las componentes del vector <span class="math notranslate nohighlight">\(x\)</span> son mayores o iguales a cero (son mayores o iguales a cero de una forma <em>pointwise</em>). El PL busca maximizar <span class="math notranslate nohighlight">\(f_o(x) = (-c)^Tx\)</span>, la ganancia total.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2 \\
\text{sujeto a: }       \\
x_1 \leq 4 \nonumber    \\
2x_2 \leq 12            \\
3x_1 + 2x_2 \leq 18     \\
x_1 \geq 0              \\
x_2 \geq 0              \\
\)</span></p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>En el contexto del PL ejemplo se tiene:</p>
<p><span class="math notranslate nohighlight">\(f_o\)</span>: ganancia total debida a todas las actividades (función objetivo). En el ejemplo es la ganancia semanal total (en miles de pesos) que generan los productos <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p><span class="math notranslate nohighlight">\(x_j\)</span>: nivel de la actividad <span class="math notranslate nohighlight">\(j\)</span> con <span class="math notranslate nohighlight">\(j=1, 2, \dots, n\)</span> (variables de optimización primales). En el ejemplo <span class="math notranslate nohighlight">\(n=2\)</span>. <span class="math notranslate nohighlight">\(x_1\)</span> es el número de lotes del producto <span class="math notranslate nohighlight">\(1\)</span> que se fabrican por semana (análogamente <span class="math notranslate nohighlight">\(x_2\)</span>).</p>
<p><span class="math notranslate nohighlight">\(c_j\)</span>: costo unitario debido a la actividad j con <span class="math notranslate nohighlight">\(j=1, 2, \dots, n\)</span> (<span class="math notranslate nohighlight">\(-c_j\)</span> es la ganancia unitaria).</p>
<p><span class="math notranslate nohighlight">\(b_i\)</span>: cantidad disponible del recurso <span class="math notranslate nohighlight">\(i\)</span> para asignarse a las actividades con <span class="math notranslate nohighlight">\(i=1, 2, \dots, m\)</span>. En el ejemplo <span class="math notranslate nohighlight">\(m=3\)</span>. <span class="math notranslate nohighlight">\(b_1=4\)</span> representa el número de horas de producción disponibles por semana en la planta <span class="math notranslate nohighlight">\(1\)</span> para fabricar los lotes de los productos <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p><span class="math notranslate nohighlight">\(a_{ij}\)</span>: cantidad del recurso <span class="math notranslate nohighlight">\(i\)</span> consumido por cada unidad de la actividad <span class="math notranslate nohighlight">\(j\)</span> con <span class="math notranslate nohighlight">\(i=1, 2, \dots n\)</span>, <span class="math notranslate nohighlight">\(j=1, 2, \dots m\)</span>. En el ejemplo se consumen <span class="math notranslate nohighlight">\(3\)</span> horas para producir el producto <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(2\)</span> horas para el <span class="math notranslate nohighlight">\(2\)</span> de las <span class="math notranslate nohighlight">\(18\)</span> horas disponibles en la planta <span class="math notranslate nohighlight">\(3\)</span>.</p>
</div>
<p>El problema <strong>dual</strong> asociado al problema anterior es:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Por ahora tómese como válida la expresión del problema dual, en esta primera parte se busca señalar las relaciones existentes con el problema primal y no la forma matemática de obtenerlo.</p>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{-\lambda \in \mathbb{R}^3} b^T(-\lambda)\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[A^T(-\lambda) \geq -c\]</div>
<div class="math notranslate nohighlight">
\[-\lambda \geq 0\]</div>
<p>Las desigualdades se intrepretan que son mayores o iguales al vector del lado derecho de una forma <em>pointwise</em>. Escrito con escalares es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{-\lambda \in \mathbb{R}^3} -4\lambda_1 -12 \lambda_2 -18 \lambda_3\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[-\lambda_1 -3 \lambda_3 \geq 3\]</div>
<div class="math notranslate nohighlight">
\[-2 \lambda_2 - 2 \lambda_3 \geq 5\]</div>
<div class="math notranslate nohighlight">
\[-\lambda_1 \geq 0, -\lambda_2 \geq 0, -\lambda_3 \geq 0\]</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>La variable de optimización y función objetivo del problema primal se nombran variable de optimización primal y función objetivo primal. Análogamente para el problema dual la variable de optimización y función objetivo del problema dual se nombran variable de optimización dual y función objetivo dual.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Se utiliza como variable de optimización dual <span class="math notranslate nohighlight">\(-\lambda\)</span> pues la función objetivo primal es <span class="math notranslate nohighlight">\((-c)^Tx\)</span>. Las expresiones cambian un poco si se utiliza una función objetivo primal igual a <span class="math notranslate nohighlight">\(c^Tx\)</span>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2       \\
x_1 \leq 4 \nonumber    \\
2x_2 \leq 12            \\
3x_1 + 2x_2 \leq 18     \\
x_1 \geq 0              \\
x_2 \geq 0              \\
\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{-\lambda \in \mathbb{R}^3} -4\lambda_1 -12 \lambda_2 -18 \lambda_3\\
\text{sujeto a: } \\
-\lambda_1 -3 \lambda_3 \geq 3\\
-2 \lambda_2 - 2 \lambda_3 \geq 5 \\
-\lambda_1 \geq 0 \\
-\lambda_2 \geq 0 \\
-\lambda_3 \geq 0
\)</span></p>
</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El problema dual usa exactamente los mismos parámetros (los valores <span class="math notranslate nohighlight">\(c_j, b_i, a_{ij}\)</span>) del problema primal pero en diferentes lugares:</p>
<ul>
<li><p>Los coeficientes de la función objetivo primal son los lados derechos de las restricciones funcionales del problema dual.</p></li>
<li><p>Los lados derechos de las restricciones funcionales del problema primal son los coeficientes de la función objetivo dual.</p></li>
<li><p>Los coeficientes de una variable de las restricciones funcionales del problema primal son los coeficientes de una restricción funcional del problema dual. Por ejemplo: en las restricciones funcionales <span class="math notranslate nohighlight">\(x_1 \leq 4\)</span>, <span class="math notranslate nohighlight">\(2x_2 \leq 12\)</span> y <span class="math notranslate nohighlight">\(3x_1 + 2x_2 \leq 18\)</span> del problema primal los coeficientes de <span class="math notranslate nohighlight">\(x_1\)</span> son <span class="math notranslate nohighlight">\(1, 0, 3\)</span> respectivamente, en el problema dual se tienen estos mismos coeficientes para la restricción funcional:<span class="math notranslate nohighlight">\(-\lambda_1 -3 \lambda_3 \geq 3\)</span> (recuérdese que la variable de optimización dual que estamos analizando es <span class="math notranslate nohighlight">\(-\lambda\)</span>).</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="interpretacion-del-problema-dual">
<h2>Interpretación del problema dual<a class="headerlink" href="#interpretacion-del-problema-dual" title="Permalink to this headline">¶</a></h2>
<p>Considérese las siguientes formas de los modelos de optimización primal-dual para el problema del inicio:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2 
&amp;&amp; &amp;&amp;
\displaystyle \min_{-\lambda \in \mathbb{R}^3} -4\lambda_1 -12 \lambda_2 -18 \lambda_3\\
\text{sujeto a: }       &amp;&amp; &amp;&amp;  \text{sujeto a: }\\
x_1 \leq 4 \nonumber    &amp;&amp; &amp;&amp;  -\lambda_1 -3 \lambda_3 \geq 3\\
2x_2 \leq 12            &amp;&amp; &amp;&amp; -2 \lambda_2 - 2 \lambda_3 \geq 5 \\
3x_1 + 2x_2 \leq 18     &amp;&amp; &amp;&amp; -\lambda_1 \geq 0 \\
x_1 \geq 0              &amp;&amp; &amp;&amp; -\lambda_2 \geq 0 \\
x_2 \geq 0              &amp;&amp; &amp;&amp; -\lambda_3 \geq 0
\end{align*}\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada del problema primal del ejemplo prototipo recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^5} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<p>Recordemos algunos enunciados y resultados que obtuvimos en el <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejmetgraficopl"><span class="std std-ref">ejemplo del método gráfico</span></a> y en el <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejmetsimplex"><span class="std std-ref">ejemplo del método símplex</span></a> para el problema primal en su forma <strong>aumentada</strong>, ver <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#formaaumentadapl"><span class="std std-ref">forma aumentada de un PL</span></a>:</p>
<ul class="simple">
<li><p>La solución óptima (no aumentada) es <span class="math notranslate nohighlight">\(x^* = \left [ \begin{array}{c} 2 \\ 6\end{array} \right ]\)</span> con valor de la función objetivo <span class="math notranslate nohighlight">\(f_o(x^*) = (-c)^Tx^* = 36\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>La relación entre <span class="math notranslate nohighlight">\(f_o(x)\)</span> y el vector <span class="math notranslate nohighlight">\(\nu\)</span> en el método símplex es: <span class="math notranslate nohighlight">\(f_o(x) = b^T(-\nu)\)</span>. <strong>Sin embargo</strong> recuérdese que el vector <span class="math notranslate nohighlight">\(\nu\)</span> surgió por el uso de la función Lagraniana para restricciones de igualdad en la forma aumentada.</p></li>
</ul>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que los multiplicadores de Lagrange <span class="math notranslate nohighlight">\(\nu, \lambda\)</span> se asocian a igualdades y desigualdades respectivamente, ver <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#funlagrangiana"><span class="std std-ref">la función Lagrangiana</span></a>.</p>
</div>
<ul class="simple">
<li><p>En esta sección consideramos una forma del PL <strong>no aumentada, pues sólo tiene desigualdades</strong>. Por tanto sólo tenemos al multiplicador <span class="math notranslate nohighlight">\(\lambda\)</span>. Entonces se cumple que <strong>no</strong> tenemos vector <span class="math notranslate nohighlight">\(\nu\)</span> y más bien <span class="math notranslate nohighlight">\(\lambda\)</span> es el <strong>único</strong> vector multiplicador de Lagrange que tenemos y se cumple: <span class="math notranslate nohighlight">\(f_o(x) = b^T(- \lambda)\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>Para la forma aumentada del PL se obtuvo que el valor del vector óptimo <span class="math notranslate nohighlight">\(\nu\)</span> es: <span class="math notranslate nohighlight">\(\nu^* = \left [ \begin{array}{c} 0 \\ -1.5 \\ -1 \end{array} \right ]\)</span> y por el punto anterior: <span class="math notranslate nohighlight">\(\lambda^* = \left [ \begin{array}{c} 0 \\ -1.5 \\ -1 \end{array} \right ]\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>El valor óptimo de la función objetivo entonces se puede calcular a partir de <span class="math notranslate nohighlight">\(\lambda^*\)</span>: <span class="math notranslate nohighlight">\(f_o(x) = b^T(-\lambda^*) = -[4 \quad 12 \quad 18] \left [ \begin{array}{c} 0 \\ -1.5 \\ -1 \end{array} \right ] = - (-36) = 36\)</span>.</p></li>
</ul>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejmetsimplex"><span class="std std-ref">ejemplo del método símplex</span></a> se tenía la relación <span class="math notranslate nohighlight">\(\lambda_{B_j} =  -c_{B_j} + \nu^Ta_j \quad j \in \mathcal{B}\)</span>, <span class="math notranslate nohighlight">\(\lambda_{N_j} =  -c_{N_j} + \nu^Ta_j \quad j \in \mathcal{N}\)</span> pero no estamos trabajando directamente con la forma aumentada del problema dual por lo que sólo tenemos vector <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div>
<ul class="simple">
<li><p>Los coeficientes <span class="math notranslate nohighlight">\(\lambda_{B_j}, \lambda_{N_j}\)</span> en el método de símplex se escriben como (haciendo uso que <span class="math notranslate nohighlight">\(\lambda\)</span> es el <strong>único</strong> vector multiplicador de Lagrange que tenemos):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\lambda_{B_j} =  -c_{B_j} + \lambda[1:3]^Ta_j \quad j \in \mathcal{B}\]</div>
<div class="math notranslate nohighlight">
\[\lambda_{N_j} =  -c_{N_j} + \lambda[1:3]^Ta_j \quad j \in \mathcal{N}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada del problema primal del ejemplo prototipo recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^5} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<p>con <span class="math notranslate nohighlight">\(\mathcal{B}, \mathcal{N}\)</span> conjunto de índices de variables básicas y no básicas respectivamente; <span class="math notranslate nohighlight">\(\lambda[1:3]\)</span> el vector de la posición <span class="math notranslate nohighlight">\(1\)</span> a <span class="math notranslate nohighlight">\(3\)</span> de <span class="math notranslate nohighlight">\(\lambda\)</span> que contiene a las variables <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2, \lambda_3\)</span> y <span class="math notranslate nohighlight">\(a_j\)</span> <span class="math notranslate nohighlight">\(j\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{3 \times 5}\)</span>. <span class="math notranslate nohighlight">\(A\)</span> es la matriz del sistema de ecuaciones lineales del problema primal:</p>
<div class="math notranslate nohighlight">
\[\begin{split}A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right]
\end{split}\]</div>
<ul class="simple">
<li><p>En el método símplex se mantiene en cada iteración <span class="math notranslate nohighlight">\(\lambda_{B_j} = 0 \forall j \in \mathcal{B}\)</span> y se <strong>busca</strong> satisfacer la <strong>condición de optimalidad</strong>: <span class="math notranslate nohighlight">\(\lambda_{N_j} \forall j \in \mathcal{N}\)</span> <strong>sea no negativo para problemas de minimización o no positivo para problemas de maximización</strong>.</p></li>
</ul>
<p>La interpretación del problema dual podemos realizarla por partes, siendo las primeras las relacionadas con la función objetivo de éste: <span class="math notranslate nohighlight">\(b^T(-\lambda)\)</span> y su variable de optimización: <span class="math notranslate nohighlight">\(-\lambda\)</span>.</p>
<div class="section" id="funcion-objetivo-y-variable-de-optimizacion-del-problema-dual">
<h3>Función objetivo y variable de optimización del problema dual<a class="headerlink" href="#funcion-objetivo-y-variable-de-optimizacion-del-problema-dual" title="Permalink to this headline">¶</a></h3>
<p>La función objetivo dual es:</p>
<div class="math notranslate nohighlight">
\[b^T(-\lambda) = b_1(-\lambda_1) + b_2(-\lambda_2) + \dots + b_m(-\lambda_m)\]</div>
<p>con <span class="math notranslate nohighlight">\(b_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésima componente del vector <span class="math notranslate nohighlight">\(b\)</span> que representa al recurso <span class="math notranslate nohighlight">\(i=1, 2, \dots, m\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{-\lambda \in \mathbb{R}^3} -4\lambda_1 -12 \lambda_2 -18 \lambda_3\\
\text{sujeto a: } \\
-\lambda_1 -3 \lambda_3 \geq 3\\
-2 \lambda_2 - 2 \lambda_3 \geq 5 \\
-\lambda_1 \geq 0 \\
-\lambda_2 \geq 0 \\
-\lambda_3 \geq 0
\)</span></p>
</div>
<p>Como se vio arriba en el método símplex los valores de las funciones objetivo de cada problema tienen un valor numérico igual en las soluciones óptimas: <span class="math notranslate nohighlight">\(f_o(x^*) = (-c)^Tx^* = b^T(-\lambda^*) = 36\)</span>. Por ello, cada término <span class="math notranslate nohighlight">\(b_i (-\lambda_i)\)</span> puede interpretarse como la contribución a la ganancia por consumir <span class="math notranslate nohighlight">\(b_i\)</span> unidades del recurso <span class="math notranslate nohighlight">\(i\)</span> en el problema primal.</p>
<p>Así, la variable de optimización dual <span class="math notranslate nohighlight">\(-\lambda_i\)</span> se interpreta como la contribución a la ganancia por unidad del recurso <span class="math notranslate nohighlight">\(i\)</span> y minimizar <span class="math notranslate nohighlight">\(b^T(-\lambda)\)</span> es minimizar el valor total de los recursos consumidos por las actividades. En el ejemplo los recursos recuérdese que son el número de horas de producción disponibles por semana en las plantas para producir los productos <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(2\)</span>.</p>
<div class="sidebar">
<p class="sidebar-title">Un poco de historia …</p>
<p>Ver <a class="reference external" href="https://www.nobelprize.org/prizes/economic-sciences/1975/kantorovich/lecture/">nobel prize: Leonid Vitaliyevich Kantorovich prize lecture</a></p>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>En Economía se nombra al vector <span class="math notranslate nohighlight">\(-\lambda^*\)</span> <a class="reference external" href="https://en.wikipedia.org/wiki/Shadow_price">shadow prices</a>. Sus componentes indican que un incremento individual de una unidad en cualquier <span class="math notranslate nohighlight">\(b_i\)</span> aumentará en <span class="math notranslate nohighlight">\(-\lambda_i^*\)</span> el valor óptimo de la función objetivo, la ganancia total semanal en miles de pesos. Es una interpretación en términos marginales para cada recurso <span class="math notranslate nohighlight">\(i\)</span>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2       \\
x_1 \leq 4 \nonumber    \\
2x_2 \leq 12            \\
3x_1 + 2x_2 \leq 18     \\
x_1 \geq 0              \\
x_2 \geq 0              \\
\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{-\lambda \in \mathbb{R}^3} -4\lambda_1 -12 \lambda_2 -18 \lambda_3\\
\text{sujeto a: } \\
-\lambda_1 -3 \lambda_3 \geq 3\\
-2 \lambda_2 - 2 \lambda_3 \geq 5 \\
-\lambda_1 \geq 0 \\
-\lambda_2 \geq 0 \\
-\lambda_3 \geq 0
\)</span></p>
</div>
</div>
<div class="section" id="lados-izquierdos-de-las-restricciones-funcionales">
<h3>Lados izquierdos de las restricciones funcionales<a class="headerlink" href="#lados-izquierdos-de-las-restricciones-funcionales" title="Permalink to this headline">¶</a></h3>
<p>En el problema primal la cantidad de recurso <span class="math notranslate nohighlight">\(i\)</span> consumido por cada unidad de la actividad <span class="math notranslate nohighlight">\(j\)</span> está dado por <span class="math notranslate nohighlight">\(a_{ij}\)</span>. Se vio que la variable dual <span class="math notranslate nohighlight">\(-\lambda_i\)</span> es la contribución a la ganancia por unidad consumida del recurso <span class="math notranslate nohighlight">\(i\)</span>. Por esto, la suma <span class="math notranslate nohighlight">\(\displaystyle \sum_{i=1}^m a_{ij} (-\lambda_i)\)</span> se interpreta como la contribución a la ganancia de la <strong>mezcla de recursos</strong> <span class="math notranslate nohighlight">\(\displaystyle \sum_{i=1}^m a_{ij} (-\lambda_i)\)</span> que se consumiría si se usara una unidad de la actividad <span class="math notranslate nohighlight">\(j\)</span> con <span class="math notranslate nohighlight">\(i=1, 2, \dots, m\)</span>, <span class="math notranslate nohighlight">\(j=1, 2, \dots, n\)</span>.</p>
<p>En el ejemplo, una unidad de la actividad <span class="math notranslate nohighlight">\(j\)</span> corresponde a producir <span class="math notranslate nohighlight">\(1\)</span> lote del producto <span class="math notranslate nohighlight">\(j\)</span> por semana, <span class="math notranslate nohighlight">\(j=1, 2\)</span>. La mezcla de recursos consumida al producir <span class="math notranslate nohighlight">\(1\)</span> lote del producto <span class="math notranslate nohighlight">\(1\)</span> es <span class="math notranslate nohighlight">\(1\)</span> hora de producción de la planta <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(3\)</span> horas de la planta <span class="math notranslate nohighlight">\(3\)</span>: <span class="math notranslate nohighlight">\(1(-\lambda_1) + 3(-\lambda_3) \geq 3\)</span> que es el lado izquierdo de la primera restricción funcional del problema dual. La mezcla correspondiente por lote del producto <span class="math notranslate nohighlight">\(2\)</span> es <span class="math notranslate nohighlight">\(2\)</span> horas de cada una de las plantas <span class="math notranslate nohighlight">\(2\)</span> y <span class="math notranslate nohighlight">\(3\)</span>: <span class="math notranslate nohighlight">\(2(-\lambda_2) + 2(-\lambda_3) \geq 5\)</span>. Los lados izquierdos de las restricciones funcionales en el problema dual son las contribuciones a la ganancia en miles de pesos de estas mezclas de recursos por lote producido por semana de los productos respectivos.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2       \\
x_1 \leq 4 \nonumber    \\
2x_2 \leq 12            \\
3x_1 + 2x_2 \leq 18     \\
x_1 \geq 0              \\
x_2 \geq 0              \\
\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{-\lambda \in \mathbb{R}^3} -4\lambda_1 -12 \lambda_2 -18 \lambda_3\\
\text{sujeto a: } \\
-\lambda_1 -3 \lambda_3 \geq 3\\
-2 \lambda_2 - 2 \lambda_3 \geq 5 \\
-\lambda_1 \geq 0 \\
-\lambda_2 \geq 0 \\
-\lambda_3 \geq 0
\)</span></p>
</div>
</div>
<div class="section" id="restricciones-funcionales-y-de-no-negatividad">
<h3>Restricciones funcionales y de no negatividad<a class="headerlink" href="#restricciones-funcionales-y-de-no-negatividad" title="Permalink to this headline">¶</a></h3>
<p>El valor <span class="math notranslate nohighlight">\(-c_j\)</span> es la ganancia unitaria que se obtiene por la actividad <span class="math notranslate nohighlight">\(j\)</span> por lo que <span class="math notranslate nohighlight">\(\displaystyle \sum_{i=1}^m a_{ij}(-\lambda_i) \geq c_j\)</span> indica que la contribución a la ganancia de la mezcla de recursos debe ser, por lo menos, tan grande como si <span class="math notranslate nohighlight">\(1\)</span> unidad de la actividad <span class="math notranslate nohighlight">\(j\)</span> la utilizara para <span class="math notranslate nohighlight">\(j=1, 2, \dots, n\)</span>.</p>
<p>En el ejemplo, las ganancias unitarias (en miles de pesos por semana) son <span class="math notranslate nohighlight">\(-c_1 = 3\)</span> y <span class="math notranslate nohighlight">\(-c_2 = 5\)</span> por la producción del producto <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(2\)</span> respectivamente. La restricción funcional <span class="math notranslate nohighlight">\(-\lambda_1 -3\lambda_3 \geq 3\)</span> entonces indica que la producción del producto <span class="math notranslate nohighlight">\(1\)</span> en la planta <span class="math notranslate nohighlight">\(1\)</span> y <span class="math notranslate nohighlight">\(3\)</span> debe ser al menos tan redituable que la ganancia que se obtiene por el producto <span class="math notranslate nohighlight">\(1\)</span>: <span class="math notranslate nohighlight">\(3\)</span> mil pesos.</p>
<p>La restricción <span class="math notranslate nohighlight">\(-\lambda_i\)</span> indica que la contribución a la ganancia por el recurso <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(i=1,2, \dots, m\)</span> debe ser no negativa. De lo contrario sería mejor no utilizar este recurso.</p>
</div>
</div>
<div class="section" id="forma-aumentada-del-problema-dual">
<h2>Forma aumentada del problema dual<a class="headerlink" href="#forma-aumentada-del-problema-dual" title="Permalink to this headline">¶</a></h2>
<p>El problema dual es un problema PL por lo que también tiene soluciones en un vértice que pueden ser factibles (FEV) o no factibles (NFEV), ver <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#solfevnfev"><span class="std std-ref">soluciones FEV y NFEV</span></a>. También tiene una forma aumentada y por tanto tiene soluciones básicas factibles (BF) o no factibles (NBF). Para el ejemplo prototipo la forma aumentada es:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En notación matricial es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \min_{-\lambda \in \mathbb{R}^5} (-\lambda)^Tb \\
\text{sujeto a: }\\
A^T(-\lambda) = -c \\
-\lambda \geq 0
\)</span></p>
</div>
<div class="math notranslate nohighlight">
\[\displaystyle \min_{-\lambda \in \mathbb{R}^5} -4\lambda_1 -12 \lambda_2 -18 \lambda_3\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[-\lambda_1 -3 \lambda_3 + \lambda_4 = 3\]</div>
<div class="math notranslate nohighlight">
\[-2 \lambda_2 - 2 \lambda_3 + \lambda_5 = 5\]</div>
<div class="math notranslate nohighlight">
\[-\lambda_1 \geq 0, -\lambda_2 \geq 0, -\lambda_3 \geq 0, -\lambda_4 \geq 0, -\lambda_5 \geq 0\]</div>
<p>De aquí en adelante <strong>consideraremos la forma aumentada</strong> de ambos problemas por lo que <span class="math notranslate nohighlight">\(x \in \mathbb{R}^5\)</span>, <span class="math notranslate nohighlight">\(-\lambda \in \mathbb{R}^5\)</span>.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Las variables duales <span class="math notranslate nohighlight">\(-\lambda_4, -\lambda_5\)</span> son variables consideradas de <strong>superávit</strong>, <em><strong>surplus variables</strong></em>, (obsérvese la diferencia con las variables de holgura).</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Forma estándar de un PL:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{x \in \mathbb{R}^n} c^Tx\\
\text{sujeto a:} \\
Ax=b\\
x \geq 0
\)</span></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Obsérvese que en este ejemplo la forma aumentada del dual corresponde a la forma estándar de los PL.</p>
</div>
</div>
<div class="section" id="variables-basicas-y-no-basicas-del-problema-dual">
<h2>Variables básicas y no básicas del problema dual<a class="headerlink" href="#variables-basicas-y-no-basicas-del-problema-dual" title="Permalink to this headline">¶</a></h2>
<p>Con la forma aumentada del problema dual podemos aplicar el método símplex al problema dual con lo que se tendrán variables básicas y no básicas. La misma <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#varbasicasnobasicas"><span class="std std-ref">definición</span></a> para tales variables se tiene en este problema dual. En cada iteración el método símplex designa <span class="math notranslate nohighlight">\(n\)</span> variables básicas y <span class="math notranslate nohighlight">\(m\)</span> variables no básicas. Las no básicas les asigna el valor de cero.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Recuérdese que al aplicar el método símplex al problema primal se desginó <span class="math notranslate nohighlight">\(m\)</span> variables básicas y <span class="math notranslate nohighlight">\(n\)</span> variables no básicas. Se verá que el número de variables básicas y no básicas “están volteadas” en uno y otro problema.</p>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Las variables básicas o no básicas del problema primal se les nombra variables básicas o no básicas primales. Análogamente, las variables básicas o no básicas del problema dual se les nombra variables básicas o no básicas duales.</p>
</div>
<p>En lo que continúa se <strong>asume</strong> que se aplica el método símplex a la forma aumentada del problema primal.</p>
</div>
<div class="section" id="relaciones-entre-el-problema-primal-y-el-problema-dual">
<h2>Relaciones entre el problema primal y el problema dual<a class="headerlink" href="#relaciones-entre-el-problema-primal-y-el-problema-dual" title="Permalink to this headline">¶</a></h2>
<p>Podemos encontrar las variables básicas y no básicas duales del ejemplo prototipo a partir de una <strong>relación que se cumple entre el problema primal y el dual</strong>. Para esto, a continuación se presenta una tabla en la que cada renglón representa una solución básica del problema primal del ejemplo prototipo. En el margen se presenta la gráfica de los puntos FEV y NFEV que nos ayuda a ubicar cada solución básica (BF o NBF) del problema primal con las primeras dos coordenadas con los puntos en la gráfica. En la última columna se presenta el valor de la función objetivo del problema primal:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada del problema primal del ejemplo prototipo recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^5} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point1_point2_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">point3_point4_x_2</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x_2_region_1</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="n">x_2_region_1</span><span class="o">&lt;=</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>
<span class="n">x_1_region_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x_1_region_2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;plum&quot;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;_nolegend_&quot;</span><span class="p">)</span>


<span class="n">point_FEV_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">point_FEV_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>  
<span class="n">point_FEV_3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> 
<span class="n">point_FEV_4</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> 
<span class="n">point_FEV_5</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>


<span class="n">array_FEV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point_FEV_1</span><span class="p">,</span>
                          <span class="n">point_FEV_2</span><span class="p">,</span>
                          <span class="n">point_FEV_3</span><span class="p">,</span>
                          <span class="n">point_FEV_4</span><span class="p">,</span>
                          <span class="n">point_FEV_5</span><span class="p">))</span>

<span class="n">point_NFEV_1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">point_NFEV_2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">point_NFEV_3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="n">array_NFEV</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">row_stack</span><span class="p">((</span><span class="n">point_NFEV_1</span><span class="p">,</span>
                           <span class="n">point_NFEV_2</span><span class="p">,</span>
                           <span class="n">point_NFEV_3</span><span class="p">))</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_FEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orangered&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">array_NFEV</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkmagenta&quot;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NFEV&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad_99_0.png" src="../../_images/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad_99_0.png" />
</div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Renglón</p></th>
<th class="text-align:center head"><p>Solución Básica <span class="math notranslate nohighlight">\((x_1, x_2, x_3, x_4, x_5)^T\)</span></p></th>
<th class="text-align:center head"><p>¿Factible?</p></th>
<th class="text-align:center head"><p>Valor <span class="math notranslate nohighlight">\(f_o\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>(0, 0, 4, 12, 18)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>(4, 0, 0, 12, 6)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>12</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>(6, 0, -2, 12, 0)</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>18</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>(4, 3, 0, 6, 0)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>27</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>(0, 6, 4, 0, 6)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>30</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>(2, 6, 2, 0, 0)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>36</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>(4, 6, 0, 0, -6)</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>42</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>(0,9,4,-6,0)</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>45</p></td>
</tr>
</tbody>
</table>
<p>Por ejemplo para el renglón <span class="math notranslate nohighlight">\(7\)</span> el valor de <span class="math notranslate nohighlight">\(f_o\)</span> es: <span class="math notranslate nohighlight">\((-c)^Tx = -[-3 \quad -5 \quad 0 \quad 0 \quad 0] \left [\begin{array}{c}4 \\ 6 \\ 0 \\ 0 \\ -6\end{array}\right ] = 42\)</span>. El número de variables no básicas primales es igual a <span class="math notranslate nohighlight">\(2\)</span> y el número de variables básicas primales es igual a <span class="math notranslate nohighlight">\(3\)</span> en todos los renglones.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada del problema primal del ejemplo prototipo recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^5} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La tabla anterior puede obtenerse resolviendo el sistema de ecuaciones lineales que se obtiene a partir de las restricciones del problema primal. Se designan <span class="math notranslate nohighlight">\(2\)</span> variables no básicas primales que se igualan a cero y se resuelve el sistema de <span class="math notranslate nohighlight">\(3 \times 3\)</span> resultante.</p>
</div>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Se nombran soluciones primales a las soluciones del problema primal. Análogamente, soluciones duales son las soluciones del problema dual.</p>
</div>
<div class="section" id="relacion-1">
<h3>Relación 1<a class="headerlink" href="#relacion-1" title="Permalink to this headline">¶</a></h3>
<p>Las soluciones básicas primales corresponden con soluciones básicas duales.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejmetsimplex"><span class="std std-ref">ejemplo del método símplex</span></a> se tenía la relación <span class="math notranslate nohighlight">\(\nu = B^{-T} c_B\)</span> pero como estamos trabajando directamente con la forma aumentada del problema dual sólo tenemos vector <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que <span class="math notranslate nohighlight">\(\lambda[1:3]\)</span> es el vector de la posición <span class="math notranslate nohighlight">\(1\)</span> a <span class="math notranslate nohighlight">\(3\)</span> de <span class="math notranslate nohighlight">\(\lambda\)</span> que contiene a las variables <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2, \lambda_3\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el método símplex podemos tener variables básicas (primales o duales) con valor igual a cero.</p>
</div>
<p>Las soluciones básicas duales las podemos obtener a partir de la tabla anterior y la ecuación establecida en el <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejmetsimplex"><span class="std std-ref">ejemplo del método símplex</span></a>: <span class="math notranslate nohighlight">\(\lambda[1:3] = B^{-T} c_B\)</span>. Además <strong>para este ejemplo</strong> las variables básicas primales siempre son diferentes de cero por lo que podemos realizar lo siguiente.</p>
<p>Obtendremos las soluciones básicas duales por renglones a partir de las soluciones básicas primales.</p>
<p>Para el primer renglón recordemos que se utilizan a las variables <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span> como básicas primales y <span class="math notranslate nohighlight">\(x_1, x_2\)</span> como no básicas primales (son iguales a cero). También  <span class="math notranslate nohighlight">\(B\)</span> es la matriz identidad y el vector de costos es <span class="math notranslate nohighlight">\(c_B = \left [ \begin{array}{c} 0 \\ 0 \\ 0 \end{array} \right ]\)</span> entonces</p>
<div class="math notranslate nohighlight">
\[\lambda[1:3] = B^{-T}c_B = 0\]</div>
<p>esto es, <span class="math notranslate nohighlight">\(\lambda_1 = \lambda_2 = \lambda_3 = 0\)</span>.</p>
<p>Para <span class="math notranslate nohighlight">\(\lambda_4\)</span> y <span class="math notranslate nohighlight">\(\lambda_5\)</span> tenemos dos opciones. La primera es resolver el sistema de ecuaciones lineales del problema dual en su forma aumentada con los valores ya calculados:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada del problema dual del ejemplo prototipo recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{-\lambda \in \mathbb{R}^5} -4\lambda_1 -12 \lambda_2 -18 \lambda_3 \\
\text{sujeto a: } \\
-\lambda_1 -3 \lambda_3 + \lambda_4 = 3 \\
-2 \lambda_2 - 2 \lambda_3 + \lambda_5 = 5 \\
-\lambda_1 \geq 0, -\lambda_2 \geq 0, -\lambda_3 \geq 0, -\lambda_4 \geq 0, -\lambda_5 \geq 0 \\
\)</span></p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
-\lambda_1 -3 \lambda_3 + \lambda_4 = 3 \nonumber \\
-2 \lambda_2 - 2 \lambda_3 + \lambda_5 = 5 \nonumber\\
\end{eqnarray}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#lambda_1, lambda_2, lambda_3 values:</span>
<span class="n">lambda_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_1</span><span class="p">,</span> <span class="n">lambda_2</span><span class="p">,</span> <span class="n">lambda_3</span><span class="p">,</span> <span class="n">lambda_4</span><span class="p">,</span> <span class="n">lambda_5</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;lambda_1, lambda_2, lambda_3, lambda_4, lambda_5&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Definimos con <code class="docutils literal notranslate"><span class="pre">SymPy</span></code> la ecuación <span class="math notranslate nohighlight">\(-\lambda_1 -3 \lambda_3 + \lambda_4 - 3 = 0\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq1</span> <span class="o">=</span> <span class="o">-</span><span class="n">lambda_1</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">lambda_3</span> <span class="o">+</span> <span class="n">lambda_4</span> <span class="o">-</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Definimos con <code class="docutils literal notranslate"><span class="pre">SymPy</span></code> la ecuación <span class="math notranslate nohighlight">\(-2 \lambda_2 - 2 \lambda_3 + \lambda_5 -5 = 0\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eq2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">lambda_2</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">lambda_3</span> <span class="o">+</span><span class="n">lambda_5</span> <span class="o">-</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Sustituimos los valores calculados del vector <span class="math notranslate nohighlight">\(\lambda[1:3]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">eq1</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">lambda_1</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">lambda_2</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">lambda_3</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                      <span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>λ₄ - 3
</pre></div>
</div>
</div>
</div>
<p>Por tanto <span class="math notranslate nohighlight">\(\lambda_4 = 3\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Sustituimos los valores calculados del vector <span class="math notranslate nohighlight">\(\lambda[1:3]\)</span>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">eq2</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">lambda_1</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">lambda_2</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">lambda_3</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                      <span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>λ₅ - 5
</pre></div>
</div>
</div>
</div>
<p>Por tanto <span class="math notranslate nohighlight">\(\lambda_5 = 5\)</span> y <span class="math notranslate nohighlight">\(\lambda = \left [ \begin{array}{c} 0 \\ 0 \\ 0 \\ 3 \\ 5 \end{array} \right ]\)</span>. La otra opción para calcular <span class="math notranslate nohighlight">\(\lambda_4, \lambda_5\)</span> es con la relación:</p>
<div class="math notranslate nohighlight">
\[\lambda_{N_j} = -c_{N_j} + \lambda[1:3]^Ta_j, \quad j \in \mathcal{N}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right]
\)</span></p>
</div>
<p>donde: <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> es el conjunto de índices no básicos primales <strong>inicial</strong> y <span class="math notranslate nohighlight">\(a_j\)</span> es la <span class="math notranslate nohighlight">\(j\)</span>-ésima columna de <span class="math notranslate nohighlight">\(A\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#list of indexes of nonbasic variables correspond to x1, x2</span>
<span class="n">N_list_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">c_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>El valor de <span class="math notranslate nohighlight">\(\lambda_4\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lambda_B</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<p>El valor de <span class="math notranslate nohighlight">\(\lambda_5\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lambda_B</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada del problema primal del ejemplo prototipo recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(\displaystyle \max_{x \in \mathbb{R}^5} 3x_1 + 5x_2 \\
\text{sujeto a: }\\
x_1 + x_3 = 4 \\
2x_2 + x_4 = 12 \\
3x_1 + 2x_2 + x_5 = 18 \\
x_1 \geq 0, x_2 \geq 0, x_3 \geq 0, x_4 \geq 0, x_5 \geq 0
\)</span></p>
</div>
<p>Los siguientes renglones lo podemos obtener observando respecto al primer renglón qué variables básicas o no básicas primales pasan a ser no básicas o básicas primales respectivamente. Para identificar lo anterior, recordemos que los valores iguales a cero en cada renglón corresponden a variables no básicas primales (pues es un ejemplo en el que no tenemos variables básicas primales iguales a cero). Así, podemos ir intercambiando las columnas de la matriz <span class="math notranslate nohighlight">\(B\)</span> inicial (identidad) con columnas de la matriz <span class="math notranslate nohighlight">\(A\)</span> del sistema de ecuaciones lineales del problema primal de la forma aumentada. También tal intercambio lo realizamos entre los vectores <span class="math notranslate nohighlight">\(c_B\)</span> y <span class="math notranslate nohighlight">\(c_N\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
A = 
\left [
\begin{array}{ccccc}
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 2 &amp; 0 &amp; 1 &amp; 0 \\
3 &amp; 2 &amp; 0 &amp; 0 &amp; 1 \\
\end{array}
\right ], B = 
\left [
\begin{array}{ccc}1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right ], c_B=\left [ \begin{array}{c}0 \\ 0 \\ 0\end{array}\right ], c_N = \left [ \begin{array}{c} -3 \\ -5 \\ \end{array} \right ]
\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Renglón</p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\((x_1, x_2, x_3, x_4, x_5)^T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>(0, 0, 4, 12, 18)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>(4, 0, 0, 12, 6)</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>(6, 0, -2, 12, 0)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>(4, 3, 0, 6, 0)</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>(0, 6, 4, 0, 6)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>(2, 6, 2, 0, 0)</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>(4, 6, 0, 0, -6)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>(0,9,4,-6,0)</p></td>
</tr>
</tbody>
</table>
</div>
<p>Por ejemplo para el renglón número <span class="math notranslate nohighlight">\(2\)</span> de la tabla anterior (que se muestra en el margen) corresponde a un intercambio entre la primera columna de <span class="math notranslate nohighlight">\(B\)</span> con la primer columna de <span class="math notranslate nohighlight">\(A\)</span>. Viendo el primer renglón, se observa que la variable <span class="math notranslate nohighlight">\(x_1\)</span> que es no básica primal pasa a ser básica primal en el segundo renglón y la variable <span class="math notranslate nohighlight">\(x_3\)</span> pasa de ser básica primal en el primero a ser no básica primal en el segundo renglón. Realizando este mismo intercambio entre <span class="math notranslate nohighlight">\(c_B\)</span> y <span class="math notranslate nohighlight">\(c_N\)</span> se tiene:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
B = \left [ 
\begin{array}{ccc} 
1 &amp; 0 &amp; 0 \\ 
0 &amp; 1 &amp; 0 \\ 
3 &amp; 0 &amp; 1 
\end{array} \right ], c_B = \left [ \begin{array}{c}-3 \\ 0 \\ 0\end{array}\right ]
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">c_N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#ordered list of indexes of A that will be interchanged</span>
<span class="n">list_idx_A</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1">#ordered list of indexes of B that will be interchanged</span>
<span class="n">list_idx_B</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[:,</span><span class="n">list_idx_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[:,</span><span class="n">list_idx_A</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_B</span><span class="p">[</span><span class="n">list_idx_B</span><span class="p">]</span> <span class="o">=</span> <span class="n">c_N</span><span class="p">[</span><span class="n">list_idx_A</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Utilizamos la relación <span class="math notranslate nohighlight">\(\lambda[1:3] = B^{-T}c_B = 0\)</span></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">c_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">lambda_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-3.  0.  0.]
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>La forma aumentada del problema dual del ejemplo prototipo recuérdese es:</p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{-\lambda \in \mathbb{R}^5} -4\lambda_1 -12 \lambda_2 -18 \lambda_3 \\
\text{sujeto a: } \\
-\lambda_1 -3 \lambda_3 + \lambda_4 = 3 \\
-2 \lambda_2 - 2 \lambda_3 + \lambda_5 = 5 \\
-\lambda_1 \geq 0, -\lambda_2 \geq 0, -\lambda_3 \geq 0, -\lambda_4 \geq 0, -\lambda_5 \geq 0 \\
\)</span></p>
</div>
<p>Los otros dos valores del vector <span class="math notranslate nohighlight">\(\lambda\)</span> los podemos calcular sustituyendo en el sistema de ecuaciones lineales del problema dual en su forma estándar los valores <span class="math notranslate nohighlight">\(\lambda_1, \lambda_2, \lambda_3\)</span> anteriores:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">eq1</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">lambda_1</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">lambda_2</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">lambda_3</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                      <span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>λ₄
</pre></div>
</div>
</div>
</div>
<p>Por tanto <span class="math notranslate nohighlight">\(\lambda_4 = 0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">eq2</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">lambda_1</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                       <span class="n">lambda_2</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                       <span class="n">lambda_3</span><span class="p">:</span> <span class="n">lambda_B</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
                      <span class="p">}))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>λ₅ - 5
</pre></div>
</div>
</div>
</div>
<p>Por tanto <span class="math notranslate nohighlight">\(\lambda_5 = 5\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Otra forma de calcular <span class="math notranslate nohighlight">\(\lambda_4, \lambda_5\)</span> es con la relación <span class="math notranslate nohighlight">\(\lambda_{N_j} = -c_{N_j} + \lambda[1:3]^Ta_j, \quad j \in \mathcal{N}\)</span>.</p>
</div>
<p>Entonces: <span class="math notranslate nohighlight">\(\lambda = \left [ \begin{array}{c} -3 \\ 0 \\ 0 \\ 0 \\ 5 \end{array} \right ]\)</span>. O bien con la relación que se muestra en el margen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#list of indexes of nonbasic variables correspond to x1, x2</span>
<span class="n">N_list_idx</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>El valor de <span class="math notranslate nohighlight">\(\lambda_4\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lambda_B</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>El valor de <span class="math notranslate nohighlight">\(\lambda_5\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="n">c_N</span><span class="p">[</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">lambda_B</span><span class="p">,</span> <span class="n">A</span><span class="p">[:,</span><span class="n">N_list_idx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p>Realizando lo anterior para cada renglón anterior obtenemos:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Renglón</p></th>
<th class="text-align:center head"><p>Solución Básica <span class="math notranslate nohighlight">\((\lambda_1, \lambda_2, \lambda_3, \lambda_4, \lambda_5)^T\)</span></p></th>
<th class="text-align:center head"><p>¿Factible?</p></th>
<th class="text-align:center head"><p>Valor <span class="math notranslate nohighlight">\(f_o\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>(0, 0, 0, 3, 5)</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>(-3, 0, 0, 0, 5)</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>12</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>(0, 0, -1, 0, 3)</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>18</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>(4.5, 0 , -2.5, 0, 0)</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>27</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>(0, -2.5, 0, 3, 0)</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>30</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>(0, -1.5, -1, 0, 0)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>36</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>(-3, -2.5, 0, 0, 0)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>42</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>(0, 0, -2.5, -4.5,0)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>45</p></td>
</tr>
</tbody>
</table>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>En el método símplex podemos tener variables básicas (primales o duales) con valor igual a cero.</p>
</div>
<p>En <strong>este ejemplo</strong> no se tienen variables básicas duales iguales a cero en ninguna solución básica dual. Por ello, las variables no básicas duales son aquellas que tienen valor igual a cero en cada solución básica dual de la tabla anterior. Asimismo, las variables básicas duales son aquellas que tienen valor diferente de cero en cada solución básica dual. Obsérvese que el número de variables no básicas duales es igual a <span class="math notranslate nohighlight">\(3\)</span> y el número de variables básicas duales es igual a <span class="math notranslate nohighlight">\(2\)</span> en todos los casos.</p>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Obtener las soluciones básicas duales de la tabla anterior a partir de las soluciones básicas primales.</p>
</div>
<p>En el renglón <span class="math notranslate nohighlight">\(7\)</span> el valor de <span class="math notranslate nohighlight">\(f_o\)</span> es: <span class="math notranslate nohighlight">\(b^T(-\lambda) = [4 \quad 12 \quad 18 \quad 0 \quad 0](-1) \left [\begin{array}{c}-3 \\ -2.5 \\ 0 \\ 0 \\ 0\end{array}\right ] = 42\)</span>. Entonces tenemos la siguiente relación.</p>
</div>
<div class="section" id="relacion-2">
<h3>Relación 2<a class="headerlink" href="#relacion-2" title="Permalink to this headline">¶</a></h3>
<p>Las soluciones básicas primales y duales tienen el mismo valor numérico de la función objetivo de sus problemas respectivos.</p>
<p>Por esta relación podemos juntar ambas tablas en una sola:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Renglón</p></th>
<th class="text-align:center head"><p>Problema Primal</p></th>
<th class="text-align:center head"><p></p></th>
<th class="text-align:center head"><p>Valor <span class="math notranslate nohighlight">\(f_o\)</span></p></th>
<th class="text-align:center head"><p>Problema dual</p></th>
<th class="text-align:center head"><p></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>-</p></td>
<td class="text-align:center"><p>Solución básica primal <span class="math notranslate nohighlight">\((x_1, x_2, x_3, x_4, x_5)^T\)</span></p></td>
<td class="text-align:center"><p>¿Factible?</p></td>
<td class="text-align:center"><p></p></td>
<td class="text-align:center"><p>Solución básica dual<span class="math notranslate nohighlight">\((\lambda_1, \lambda_2, \lambda_3, \lambda_4, \lambda_5)^T\)</span></p></td>
<td class="text-align:center"><p>¿Factible?</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>(0, 0,  4, 12,  18)</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>(  0,    0,    0,    3,  5)</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>(4, 0,  0, 12,  6 )</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>12</p></td>
<td class="text-align:center"><p>( -3,    0,    0,    0,  5)</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>(6, 0, -2, 12,  0 )</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>18</p></td>
<td class="text-align:center"><p>(  0,    0,   -1,    0,  3)</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>(4, 3,  0,  6,  0 )</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>27</p></td>
<td class="text-align:center"><p>(4.5,    0, -2.5,    0,  0)</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>(0, 6,  4,  0,  6 )</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>30</p></td>
<td class="text-align:center"><p>(  0, -2.5,    0,    3,  0)</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>(2, 6,  2,  0,  0 )</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>36</p></td>
<td class="text-align:center"><p>(  0, -1.5,   -1,    0,  0)</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>(4, 6,  0,  0, -6 )</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>42</p></td>
<td class="text-align:center"><p>( -3, -2.5,    0,    0,  0)</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>(0, 9,  4, -6,  0 )</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>45</p></td>
<td class="text-align:center"><p>(  0,    0, -2.5, -4.5,  0)</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="relacion-3-holgura-complementaria">
<h3>Relación 3: holgura complementaria<a class="headerlink" href="#relacion-3-holgura-complementaria" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Renglón</p></th>
<th class="text-align:center head"><p>Solución básica primal <span class="math notranslate nohighlight">\((x_1, x_2, x_3, x_4, x_5)^T\)</span></p></th>
<th class="text-align:center head"><p>Solución básica dual<span class="math notranslate nohighlight">\((\lambda_1, \lambda_2, \lambda_3, \lambda_4, \lambda_5)^T\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>(0, 0,  4, 12,  18)</p></td>
<td class="text-align:center"><p>(  0,    0,    0,    3,  5)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>(4, 0,  0, 12,  6 )</p></td>
<td class="text-align:center"><p>( -3,    0,    0,    0,  5)</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>(6, 0, -2, 12,  0 )</p></td>
<td class="text-align:center"><p>(  0,    0,   -1,    0,  3)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>(4, 3,  0,  6,  0 )</p></td>
<td class="text-align:center"><p>(4.5,    0, -2.5,    0,  0)</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>(0, 6,  4,  0,  6 )</p></td>
<td class="text-align:center"><p>(  0, -2.5,    0,    3,  0)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>(2, 6,  2,  0,  0 )</p></td>
<td class="text-align:center"><p>(  0, -1.5,   -1,    0,  0)</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>(4, 6,  0,  0, -6 )</p></td>
<td class="text-align:center"><p>( -3, -2.5,    0,    0,  0)</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>(0, 9,  4, -6,  0 )</p></td>
<td class="text-align:center"><p>(  0,    0, -2.5, -4.5,  0)</p></td>
</tr>
</tbody>
</table>
</div>
<p>Las soluciones básicas primales y duales satisfacen la condición de complementariedad u holgura complementaria. Si <span class="math notranslate nohighlight">\(x,  -\lambda\)</span> son soluciones básicas primales, duales respectivamente entonces:</p>
<div class="math notranslate nohighlight">
\[x_i^T (-\lambda_i) = 0, \forall i=1, \dots, n\]</div>
<p>Si utilizamos esta propiedad anterior para identificar variables básicas y no básicas primales o duales se tiene lo siguiente:</p>
<p>Si <span class="math notranslate nohighlight">\(x_i \neq 0\)</span>, por tanto básica primal, entonces por la holgura complementaria <span class="math notranslate nohighlight">\(-\lambda_i=0\)</span>, por tanto es no básica dual.</p>
<p>Si <span class="math notranslate nohighlight">\(-\lambda_i \neq 0\)</span>, por tanto básica dual, entonces por la holgura complementaria <span class="math notranslate nohighlight">\(x_i = 0\)</span>, por tanto es básica primal.</p>
<p>Esto lo observamos directamente en la tabla que se muestra en el margen. En el renglón <span class="math notranslate nohighlight">\(1\)</span> se muestra la solución básica primal al iniciar el método símplex. Las variables básicas primales son <span class="math notranslate nohighlight">\(x_3, x_4, x_5\)</span> que en <strong>este ejemplo</strong> tienen valor numérico diferente de cero y sus variables no básicas duales asociadas son respectivamente <span class="math notranslate nohighlight">\(-\lambda_1, -\lambda_2, -\lambda_3\)</span> que tienen valor numérico igual a cero. Otros enunciados aplicando la condición de holgura complementaria son:</p>
<ul class="simple">
<li><p>En el renglón <span class="math notranslate nohighlight">\(4\)</span> se tiene las variables básicas primales <span class="math notranslate nohighlight">\(x_1, x_2, x_4\)</span> que en <strong>este ejemplo</strong> tienen valor numérico diferente de cero y sus variables no básicas duales asociadas son <span class="math notranslate nohighlight">\(-\lambda_4, -\lambda_5, -\lambda_2\)</span> respectivamente que tienen valor numérico igual a cero.</p></li>
<li><p>En el renglón <span class="math notranslate nohighlight">\(2\)</span> se tiene las variables básicas duales <span class="math notranslate nohighlight">\(-\lambda_1, -\lambda_5\)</span> con valores numéricos <span class="math notranslate nohighlight">\(\lambda_1=-3\)</span>, <span class="math notranslate nohighlight">\(\lambda_5=5\)</span> que en <strong>este ejemplo</strong> son diferentes de cero y sus variables no básicas primales asociadas son <span class="math notranslate nohighlight">\(x_3, x_2\)</span> respectivamente que tienen valor numérico igual a cero.</p></li>
</ul>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Se le nombra holgura complementaria pues para cada par de variables asociadas, si una de ellas tiene holgura en su restricción de no negatividad (variable básica con valor numérico diferente de cero) entonces la otra <strong>no</strong> debe tener holgura (variable no básica con valor numérico igual a cero).</p></li>
<li><p>En este ejemplo se consideran soluciones BF o NBF pero es más común establecer la propiedad de holgura complementaria únicamente para soluciones que son factibles por lo que se tiene:</p>
<ul>
<li><p>Si <span class="math notranslate nohighlight">\(x_i &gt; 0\)</span> entonces <span class="math notranslate nohighlight">\(-\lambda_i=0\)</span>.</p></li>
<li><p>Si <span class="math notranslate nohighlight">\(-\lambda_i &gt; 0\)</span> entonces <span class="math notranslate nohighlight">\(x_i = 0\)</span>.</p></li>
</ul>
</li>
</ul>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Renglón</p></th>
<th class="text-align:center head"><p>¿Primal factible?</p></th>
<th class="text-align:center head"><p>¿Dual factible?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="relacion-4">
<h3>Relación 4<a class="headerlink" href="#relacion-4" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que el método símplex busca <span class="math notranslate nohighlight">\(\lambda_{N_j} \forall j \in \mathcal{N}\)</span> <strong>sea no negativo para problemas de minimización o no positivo para problemas de maximización</strong>.</p>
</div>
<p>Las únicas soluciones factibles duales son aquellas que satisfacen la condición de optimalidad del problema primal.</p>
<p>Por ejemplo, los tres últimos renglones de la tabla que se muestra en el margen cumplen con ser soluciones básicas factibles duales. Son factibles pues el método símplex buscará se satisfaga que el multiplicador de Lagrange asociado, <span class="math notranslate nohighlight">\(\lambda\)</span>, sea no positivo pues se tiene un problema de maximización (para un problema de maximización el método busca que <span class="math notranslate nohighlight">\(\lambda\)</span> sea no positivo). Desde la perspectiva del problema primal se satisface la <strong>condición de optimalidad</strong> para estos tres últimos renglones y el método símplex busca esto <strong>además de satisfacer la factibilidad</strong>. Obsérvese que de los últimos tres renglones sólo el renglón <span class="math notranslate nohighlight">\(6\)</span> satisface <strong>factibilidad primal</strong>.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Se nombra primal factible al vector <span class="math notranslate nohighlight">\(x\)</span> que satisface todas las restricciones del problema primal y factibilidad primal a la propiedad que un vector debe satisfacer para tales restricciones. En la forma aumentada se tienen las restricciones: <span class="math notranslate nohighlight">\(Ax = b\)</span> y <span class="math notranslate nohighlight">\(x \geq 0\)</span>.</p>
<p>La forma aumentada del problema primal del ejemplo prototipo recuérdese es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \max_{x \in \mathbb{R}^5} (-c)^Tx \\
\text{sujeto a: }\\
Ax=b\\
x \geq 0
\end{split}\]</div>
</div>
<p>Entonces el método símplex aplicado al problema primal parte de soluciones BF primales, soluciones básicas duales no factibles y busca un óptimo primal o factibilidad dual.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Renglón</p></th>
<th class="text-align:center head"><p>¿Primal factible?</p></th>
<th class="text-align:center head"><p>¿Dual factible?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="relacion-5">
<h3>Relación 5<a class="headerlink" href="#relacion-5" title="Permalink to this headline">¶</a></h3>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recuérdese que el método símplex busca <span class="math notranslate nohighlight">\(\lambda_{N_j} \forall j \in \mathcal{N}\)</span> <strong>sea no negativo para problemas de minimización o no positivo para problemas de maximización</strong>. Para la relación 5 sólo hay que reescribir lo anterior en términos de <span class="math notranslate nohighlight">\(x\)</span>.</p>
</div>
<p>En el caso de <strong>cualquier</strong> problema primal y su problema dual, las relaciones entre ellos deben ser <strong>simétricas</strong> debido a que el dual del problema dual es el problema primal.</p>
<p>Esto lo podemos establecer en la relación anterior: las únicas soluciones factibles primales son aquellas que satisfacen la condición de optimalidad del problema dual.</p>
<p>Considérese aplicar el método símplex para el problema dual (que es de minimización). Entonces el método símplex buscará se satisfaga que el multiplicador de Lagrange asociado, <span class="math notranslate nohighlight">\(x\)</span>, sea no negativo pues se tiene un problema de minimización (para un problema de minimización el método busca que <span class="math notranslate nohighlight">\(x\)</span> sea no negativo). Tal situación la observamos en la tabla para los renglones <span class="math notranslate nohighlight">\(1, 2, 4, 5, 6\)</span> en los que las soluciones básicas son factibles primales pues se pide que se satisfaga la restricción de no negatividad: <span class="math notranslate nohighlight">\(x \geq 0\)</span>. Desde la perspectiva del problema dual se satisface la <strong>condición de optimalidad</strong> para estos  renglones y el método símplex busca esto <strong>además de satisfacer la factibilidad</strong>. Obsérvese que de los renglones mencionados sólo el renglón <span class="math notranslate nohighlight">\(6\)</span> satisface <strong>factibilidad dual</strong>.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Se nombra dual factible al vector <span class="math notranslate nohighlight">\(-\lambda\)</span> que satisface todas las restricciones del problema dual y factibilidad dual a la propiedad que un vector debe satisfacer para tales restricciones. En la forma aumentada se tienen las restricciones: <span class="math notranslate nohighlight">\(A^T(-\lambda) = -c\)</span> y <span class="math notranslate nohighlight">\(-\lambda \geq 0\)</span>.</p>
<p>La forma aumentada del problema dual del ejemplo prototipo recuérdese es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \min_{-\lambda \in \mathbb{R}^5} b^T(-\lambda) \\
\text{sujeto a: }\\
A^T(-\lambda) = -c \\
-\lambda \geq 0
\end{split}\]</div>
</div>
<p>Entonces el método símplex aplicado al problema dual parte de soluciones BF duales, soluciones básicas primales no factibles y busca un óptimo dual o factibilidad primal.</p>
</div>
<div class="section" id="relacion-6-dualidad-debil">
<h3>Relación 6: dualidad débil<a class="headerlink" href="#relacion-6-dualidad-debil" title="Permalink to this headline">¶</a></h3>
<p>Considerando las siguientes formas de los problemas primal-dual:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle \max_{x \in \mathbb{R}^n} (-c)^Tx
&amp;&amp; &amp;&amp;
\displaystyle \min_{-\lambda \in \mathbb{R}^m} b^T(-\lambda)\\
\text{sujeto a:}       &amp;&amp; &amp;&amp;  \text{sujeto a:}\\
Ax=b \nonumber         &amp;&amp; &amp;&amp;  A^T(-\lambda) = -c\\
x \geq 0               &amp;&amp; &amp;&amp;  -\lambda \geq 0 \\
\end{align*}\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \max_{x \in \mathbb{R}^2} 3x_1 + 5x_2       \\
x_1 \leq 4 \nonumber    \\
2x_2 \leq 12            \\
3x_1 + 2x_2 \leq 18     \\
x_1 \geq 0              \\
x_2 \geq 0              \\
\)</span></p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\displaystyle \min_{-\lambda \in \mathbb{R}^3} -4\lambda_1 -12 \lambda_2 -18 \lambda_3\\
\text{sujeto a: } \\
-\lambda_1 -3 \lambda_3 \geq 3\\
-2 \lambda_2 - 2 \lambda_3 \geq 5 \\
-\lambda_1 \geq 0 \\
-\lambda_2 \geq 0 \\
-\lambda_3 \geq 0
\)</span></p>
</div>
<p>Si <span class="math notranslate nohighlight">\(x\)</span> es una solución primal factible, <span class="math notranslate nohighlight">\(\lambda\)</span> es una solución dual factible entonces:</p>
<div class="math notranslate nohighlight">
\[(-c)^Tx \leq b^T(-\lambda)\]</div>
<p>Para el ejemplo una solución primal factible (no aumentada) es <span class="math notranslate nohighlight">\(x_1 = 3, x_2 = 3\)</span> lo que conduce a un valor de la función objetivo primal igual a <span class="math notranslate nohighlight">\(24 = -[-3 \quad -5]^T\left [ \begin{array}{c} 3\\ 3 \end{array} \right ]\)</span>. Una solución dual factible (no aumentada) es <span class="math notranslate nohighlight">\(\lambda_1 = -1, \lambda_2 = -1, \lambda_3 = -2\)</span> lo que resulta en un valor de la función objetivo dual igual a <span class="math notranslate nohighlight">\(52 = [4 \quad 12 \quad 18]^T(-1) \left [ \begin{array}{c} -1\\ -1 \\-2 \end{array} \right ]\)</span>.</p>
<div class="admonition-definicion admonition">
<p class="admonition-title">Definición</p>
<p>Se nombra óptimo primal aquel vector <span class="math notranslate nohighlight">\(x\)</span> que es óptimo del problema primal y al valor de la función objetivo óptima del problema primal valor óptimo primal. Análogamente, óptimo dual aquel vector <span class="math notranslate nohighlight">\(-\lambda\)</span> que es óptimo del problema dual y valor óptimo dual al valor de la función objetivo óptima del problema dual.</p>
</div>
<p>Para <strong>cualquier</strong> par de soluciones factibles esta desigualdad debe cumplirse pues el valor óptimo primal es <strong>igual</strong> al valor óptimo dual. Ésta es la siguiente relación.</p>
</div>
<div class="section" id="relacion-7-dualidad-fuerte">
<h3>Relación 7: dualidad fuerte<a class="headerlink" href="#relacion-7-dualidad-fuerte" title="Permalink to this headline">¶</a></h3>
<p>Considerando las siguientes formas de los problemas primal-dual:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
\displaystyle \max_{x \in \mathbb{R}^n} (-c)^Tx
&amp;&amp; &amp;&amp;
\displaystyle \min_{-\lambda \in \mathbb{R}^m} b^T(-\lambda)\\
\text{sujeto a:}       &amp;&amp; &amp;&amp;  \text{sujeto a:}\\
Ax=b \nonumber         &amp;&amp; &amp;&amp;  A^T(-\lambda) = -c\\
x \geq 0               &amp;&amp; &amp;&amp;  -\lambda \geq 0 \\
\end{align*}\end{split}\]</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Renglón</p></th>
<th class="text-align:center head"><p>¿Primal factible?</p></th>
<th class="text-align:center head"><p>Valor <span class="math notranslate nohighlight">\(f_o\)</span></p></th>
<th class="text-align:center head"><p>¿Dual factible?</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>0</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>2</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>12</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>18</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>27</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>5</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>30</p></td>
<td class="text-align:center"><p>No</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>6</p></td>
<td class="text-align:center"><p>Sí</p></td>
<td class="text-align:center"><p>36</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>42</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>No</p></td>
<td class="text-align:center"><p>45</p></td>
<td class="text-align:center"><p>Sí</p></td>
</tr>
</tbody>
</table>
</div>
<p>Si <span class="math notranslate nohighlight">\(x^*\)</span> es una solución óptima primal y <span class="math notranslate nohighlight">\(-\lambda^*\)</span> es una solución óptima dual entonces el valor óptimo primal es igual al valor óptimo dual al evaluar las funciones objetivo de cada problema respectivas en <span class="math notranslate nohighlight">\(x^*\)</span> y <span class="math notranslate nohighlight">\(-\lambda^*\)</span>:</p>
<div class="math notranslate nohighlight">
\[(-c)^Tx^* = b^T(-\lambda^*)\]</div>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>En el caso del ejemplo prototipo se tiene que el valor óptimo dual es <span class="math notranslate nohighlight">\(36\)</span> por lo que valores menores corresponden a soluciones duales no factibles por dualidad fuerte (recuérdese se quiere minimizar la <span class="math notranslate nohighlight">\(f_o\)</span> en el problema dual). Análogamente, el valor óptimo primal es <span class="math notranslate nohighlight">\(36\)</span> y valores mayores corresponden a soluciones primales no factibles por dualidad fuerte (recuérdese se quiere maximizar la <span class="math notranslate nohighlight">\(f_o\)</span> en el problema dual).</p></li>
<li><p>Supóngase que se ha calculado <span class="math notranslate nohighlight">\(x\)</span> una solución primal factible y una solución dual factible <span class="math notranslate nohighlight">\(-\lambda\)</span>. Si por inspección de los problemas se cumple <span class="math notranslate nohighlight">\((-c)^Tx = b^T(-\lambda)\)</span> entonces podemos concluir que <span class="math notranslate nohighlight">\(x\)</span> debe ser óptima primal sin aplicar algún método. Si <span class="math notranslate nohighlight">\((-c)^Tx &lt; b^T(-\lambda)\)</span> entonces <span class="math notranslate nohighlight">\(b^T(-\lambda)\)</span> proporciona una cota superior sobre el valor óptimo primal. En este último caso si al evaluar <span class="math notranslate nohighlight">\(b^T(-\lambda) - (-c)^Tx\)</span> se considera tal diferencia como “pequeña”, entonces podría elegirse <span class="math notranslate nohighlight">\(x\)</span> como solución del problema de optimización primal aún sin ser un punto óptimo.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Establecer las relaciones anteriores para el ejemplo prototipo modificando los siguientes valores: <span class="math notranslate nohighlight">\(c_1 = -4, a_{31} = 2, b_2 = 24\)</span> donde: <span class="math notranslate nohighlight">\(c_1\)</span> es la primera entrada del vector <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(a_{31}\)</span> es la entrada <span class="math notranslate nohighlight">\((3, 1)\)</span> de la matriz <span class="math notranslate nohighlight">\(A\)</span> y <span class="math notranslate nohighlight">\(b_2\)</span> es la segunda entrada del vector <span class="math notranslate nohighlight">\(b\)</span>. Realizar tablas de apoyo que contenga información sobre soluciones básicas primales-duales, valores objetivo primales-duales, factibilidad primal-dual.</p>
</div>
</div>
<div class="section" id="resultados-de-la-dualidad-debil-y-dualidad-fuerte">
<h3>Resultados de la dualidad débil y dualidad fuerte<a class="headerlink" href="#resultados-de-la-dualidad-debil-y-dualidad-fuerte" title="Permalink to this headline">¶</a></h3>
<p>A partir de las relaciones de dualidad débil y fuerte se verifica lo siguiente para problemas PL primal dual:</p>
<ul class="simple">
<li><p>Si un problema tiene soluciones factibles y una función objetivo acotada (y, por ende, una solución óptima), entonces el otro problema también tiene soluciones factibles y una función objetivo acotada.</p></li>
<li><p>Si uno de los problemas tiene soluciones factibles y una función objetivo no acotada (esto es, no tiene solución óptima), entonces el otro problema no tiene soluciones factibles.</p></li>
<li><p>Si un problema no tiene soluciones factibles, entonces el otro problema no tiene soluciones factibles o bien la función objetivo es no acotada.</p></li>
</ul>
</div>
</div>
<div class="section" id="lema-de-farkas">
<h2>Lema de Farkas<a class="headerlink" href="#lema-de-farkas" title="Permalink to this headline">¶</a></h2>
<p>Uno y sólo uno de los siguientes sistemas tiene una solución:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
1) c^Tx &gt; 0
&amp;&amp; &amp;&amp;
2) A^T \lambda = c\\
Ax \leq 0         &amp;&amp; &amp;&amp;  \lambda \geq 0\\
\end{align*}\end{split}\]</div>
<div class="section" id="interpretacion-geometrica">
<h3>Interpretación geométrica<a class="headerlink" href="#interpretacion-geometrica" title="Permalink to this headline">¶</a></h3>
<p>Considérense los renglones de la matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span> como <span class="math notranslate nohighlight">\(a_1, a_2, \dots, a_m\)</span>.</p>
<p>Para visualizar el lema anterior iniciemos con el sistema <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>El conjunto <span class="math notranslate nohighlight">\(\{x : c^Tx &gt;0\}\)</span> es el semiespacio abierto siguiente:</p>
<img src="https://dl.dropboxusercontent.com/s/x4rcu3govw8g7os/semispace_Farkas_lemma.png?dl=0" heigth="250" width="250">
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La región anterior surge por contener aquellos vectores con ángulo menor a <span class="math notranslate nohighlight">\(90^o\)</span> con el vector <span class="math notranslate nohighlight">\(c\)</span>.</p>
</div>
<p>El conjunto <span class="math notranslate nohighlight">\(\{x : Ax \leq 0\}\)</span> es el cono siguiente:</p>
<img src="https://dl.dropboxusercontent.com/s/qni9cgdbo4o8ycy/cone_Farkas_lemma.png?dl=0" heigth="250" width="250"><div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>La región anterior surge por la intersección de todos los semiespacios cerrados que se forman al considerar los vectores <span class="math notranslate nohighlight">\(x\)</span> que forman un ángulo mayor a <span class="math notranslate nohighlight">\(90^o\)</span> con los renglones de <span class="math notranslate nohighlight">\(A\)</span>. Las flechitas indican la zona donde se encuentran los semiespacios cerrados en los que se tienen vectores que forman un ángulo menor a <span class="math notranslate nohighlight">\(90^o\)</span>.</p>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Sistema 1: <span class="math notranslate nohighlight">\(c^Tx &gt; 0 \\
Ax \leq 0
\)</span></p>
</div>
<p>La solución del sistema <span class="math notranslate nohighlight">\(1\)</span> requiere la intersección entre ambos conjuntos:</p>
<img src="https://dl.dropboxusercontent.com/s/so5lj9rl1ifieai/intersection_semispace_cone_Farkas_lemma.png?dl=0" heigth="250" width="250"><p>La solución del sistema <span class="math notranslate nohighlight">\(2\)</span> requiere que el vector <span class="math notranslate nohighlight">\(c\)</span> se encuentre en el cono generado por los renglones de <span class="math notranslate nohighlight">\(A\)</span>:</p>
<img src="https://dl.dropboxusercontent.com/s/g9u1il5ts3wd5mh/gradient_in_span_of_rows_Farkas_lemma.png?dl=0" heigth="200" width="200">
<p>Entonces no puede existir una solución de ambos sistemas pues se tienen regiones ajenas.</p>
</div>
</div>
<div class="section" id="condiciones-kkt-de-optimalidad-para-pl-s">
<h2>Condiciones KKT de optimalidad para PL’s<a class="headerlink" href="#condiciones-kkt-de-optimalidad-para-pl-s" title="Permalink to this headline">¶</a></h2>
<p>Considérese el siguiente PL como problema primal:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\displaystyle \min_{x \in \mathbb{R}^n} c^Tx \\
\text{sujeto a:}\\
Ax \leq b \\
x \geq 0
\end{split}\]</div>
<p>Las condiciones de Karush-Kuhn-Tucker, KKT, de optimalidad para PL’s nos indican que <span class="math notranslate nohighlight">\(x^*\)</span> es <strong>mínimo si y sólo si</strong> existen variables duales <span class="math notranslate nohighlight">\(\lambda_1^*, \lambda_2^*\)</span> que satisfacen:</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Compárense estas condiciones con las señaladas en el <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#primeraformulacioncondkkt"><span class="std std-ref">comentario</span></a> sobre las condiciones KKT en el contexto de problemas de optimización convexa.</p>
</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\nabla_x \mathcal{L}(x^*, \lambda^*_1, \lambda^*_2) &amp;=&amp; c + A^T\lambda^*_1 - \lambda^*_2 \nonumber = 0 \nonumber \\
\lambda_1^{*T}(Ax^* - b) &amp;=&amp; 0 \nonumber \\
\lambda_2^{*T}(-x^*) &amp;=&amp; 0 \nonumber \\
Ax^* &amp;\leq&amp; b \nonumber \\
-x^* &amp;\leq&amp; 0 \nonumber \\
\lambda^*_1, \lambda^*_2 &amp;\geq&amp; 0
\end{eqnarray}
\end{split}\]</div>
<p>donde: <span class="math notranslate nohighlight">\(a_1, a_2, \dots, a_m\)</span> son los renglones de la matriz <span class="math notranslate nohighlight">\(A \in \mathbb{R}^{m \times n}\)</span>, las desigualdades se interpretan de una forma <em>pointwise</em> y</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}(x, \lambda_1, \lambda_2) = f_o(x) + \lambda_1 ^T(Ax -b) + \lambda_2^T(-x)\]</div>
<p>es la función Lagrangiana, ver <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html#funlagrangiana"><span class="std std-ref">la función Lagrangiana</span></a>.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>El gradiente de <span class="math notranslate nohighlight">\(\mathcal{L}\)</span> respecto a <span class="math notranslate nohighlight">\(x\)</span> se escribe como sigue:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\nabla_x \mathcal{L}(x, \lambda_1, \lambda_2) = c + \displaystyle \sum_{i=1}^m \lambda_1(i)a_i - \sum_{i=1}^n \lambda_2(i) e_i\]</div>
<p>por lo que <span class="math notranslate nohighlight">\(\nabla f_o(x) = c = - \displaystyle \sum_{i=1}^m \lambda_1(i)a_i + \sum_{i=1}^n \lambda_2(i) e_i\)</span> esto es,, el gradiente de <span class="math notranslate nohighlight">\(f_o(x) = c^Tx\)</span> es combinación lineal de <span class="math notranslate nohighlight">\(-a_i, e_i\)</span> con <span class="math notranslate nohighlight">\(e_i\)</span> <span class="math notranslate nohighlight">\(i\)</span>-ésimo vector canónico.</p>
<ul class="simple">
<li><p><strong>Únicamente</strong> en problemas de optimzación convexos las condiciones son necesarias y suficientes.</p></li>
</ul>
</div>
</div>
<div class="section" id="relacion-entre-el-lemma-de-farkas-y-las-condiciones-de-kkt">
<h2>Relación entre el lemma de Farkas y las condiciones de KKT<a class="headerlink" href="#relacion-entre-el-lemma-de-farkas-y-las-condiciones-de-kkt" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="el-metodo-simplex-y-las-condiciones-kkt">
<h2>El método símplex y las condiciones KKT<a class="headerlink" href="#el-metodo-simplex-y-las-condiciones-kkt" title="Permalink to this headline">¶</a></h2>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>S. P. Boyd, L. Vandenberghe, Convex Optimization, Cambridge University Press, 2009.</p></li>
<li><p>J. Nocedal, S. J. Wright, Numerical Optimization, Springer, 2006.</p></li>
<li><p>F. Hillier, G. Lieberman, Introduction to Operations Research, Mc Graw Hill, 2014.</p></li>
<li><p>M. S. Bazaraa, J. J. Jarvis, H. D. Sherali, Linear Programming and Network Flows, Wiley, 2010.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./IV.optimizacion_en_redes_y_prog_lineal/4.4"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../4.3/Ejemplo_metodo_simplex_de_redes.html" title="previous page">4.3 Ejemplo del método símplex de redes</a>
    <a class='right-next' id="next-link" href="../4.5/Puntos_interiores.html" title="next page">4.5 Puntos interiores</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>