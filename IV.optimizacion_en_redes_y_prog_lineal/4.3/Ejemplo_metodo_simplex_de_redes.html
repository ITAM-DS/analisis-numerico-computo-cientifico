
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.3 Ejemplo del método símplex de redes</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html" />
    <link rel="prev" title="4.2 Programación lineal (PL) y método símplex" href="../4.2/Programacion_lineal_y_metodo_simplex.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   Optimización
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  I. Cómputo científico
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.1/Analisis_numerico_y_computo_cientifico.html">
   1.1 Análisis numérico y cómputo científico
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.2/Sistema_de_punto_flotante.html">
   1.2 Sistema de punto flotante
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.3/Normas_vectoriales_y_matriciales.html">
   1.3 Normas vectoriales y matriciales
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.4/Condicion_de_un_problema_y_estabilidad_de_un_algoritmo.html">
   1.4 Condición de un problema y estabilidad de un algoritmo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.5/Definicion_de_funcion_continuidad_derivada.html">
   1.5 Definición de función, continuidad y derivada
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.6/Polinomios_de_Taylor_y_diferenciacion_numerica.html">
   1.6 Polinomios de Taylor y diferenciación numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../I.computo_cientifico/1.7/Integracion_numerica.html">
   1.7 Integración Numérica
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  II. Cómputo matricial
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.1/Operaciones_y_transformaciones_basicas_del_Algebra_Lineal_Numerica.html">
   2.1 Operaciones y transformaciones básicas del Álgebra Lineal Numérica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.2/Eigenvalores_y_eigenvectores.html">
   2.2 Eigenvalores y eigenvectores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.3/Algoritmos_y_aplicaciones_de_eigenvalores_eigenvectores_de_una_matriz.html">
   2.3 Algoritmos y aplicaciones de eigenvalores y eigenvectores de una matriz
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../II.computo_matricial/2.4/Valores_vectores_singulares_y_algoritmos_para_calcular_la_SVD.html">
   2.4 Valores, vectores singulares y algoritmos para calcular la SVD
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  III. Optimización convexa y ecuaciones no lineales
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.1/Definicion_de_problema_optimizacion_conjuntos_y_funciones_convexas.html">
   3.1 Definición de problemas de optimización, conjuntos y funciones convexas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.2/Algoritmos_de_descenso_y_busqueda_de_linea_en_uco.html">
   3.2 Algoritmos de descenso y búsqueda de línea en
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.3/Ejemplos_problemas_UCO_e_intro_CIEO_y_PI.html">
   3.3 Ejemplos de problemas UCO, introducción a
   <em>
    Constrained Inequality and Equality Optimization
   </em>
   (CIEO) y puntos interiores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../III.optimizacion_convexa/3.4/Ecuaciones_no_lineales.html">
   3.4 Ecuaciones no lineales
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  IV. Optimización en redes y programación lineal
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html">
   4.1 Definiciones generales de flujo en redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html">
   4.2 Programación lineal (PL) y método símplex
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4.3 Ejemplo del método símplex de redes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html">
   4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4.5/Metodo_primal_dual_de_BL.html">
   4.5 Método primal-dual de barrera logarítmica (BL)
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  V. Optimización de código
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../V.optimizacion_de_codigo/5.1/introduccion_optimizacion_de_codigo.html">
   5.1 Introducción optimización de código
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  VI. Algoritmos de optimización convexa
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.1/Problemas_UCO.html">
   6.1 Problemas tipo
   <em>
    Unconstrained Convex Optimization
   </em>
   (UCO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.2/Problemas_CECO.html">
   6.2 Problemas tipo
   <em>
    Constrained Equality Convex Optimization
   </em>
   (CECO)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../VI.algoritmos_optimizacion_convexa/6.3/Problemas_CIECO.html">
   6.3 Problemas tipo
   <em>
    Constrained Equality and Inequality Convex Optimization
   </em>
   (CIECO)
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/IV.optimizacion_en_redes_y_prog_lineal/4.3/Ejemplo_metodo_simplex_de_redes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/palmoreck/dockerfiles-for-binder/jupyterlab_optimizacion_2?urlpath=lab/tree/analisis-numerico-computo-cientifico/libro_optimizacion/temas/IV.optimizacion_en_redes_y_prog_lineal/4.3/Ejemplo_metodo_simplex_de_redes.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arcos-basicos-y-no-basicos">
   Arcos básicos y no básicos
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ejemplo">
     Ejemplo
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tecnica-de-la-cota-superior">
   Técnica de la cota superior
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#inicio-del-ejemplo">
   Inicio del ejemplo
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#revision-de-cual-arco-no-basico-sustituye-a-un-arco-basico">
     Revisión de cuál arco no básico sustituye a un arco básico
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#revision-de-cual-arco-basico-es-sustituido">
     Revisión de cuál arco básico es sustituido
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iteracion-siguiente">
   Iteración siguiente
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Revisión de cuál arco no básico sustituye a un arco básico
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Revisión de cuál arco básico es sustituido
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Técnica de la cota superior
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   Iteración siguiente
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Revisión de cuál arco no básico sustituye a un arco básico
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Revisión de cuál arco básico es sustituido
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     Técnica de la cota superior
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id8">
   Iteración siguiente
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     Revisión de cuál arco no básico sustituye a un arco básico
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#finalizando-el-ejemplo">
   Finalizando el ejemplo
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="ejemplo-del-metodo-simplex-de-redes">
<span id="ejmetsimplexredes"></span><h1>4.3 Ejemplo del método símplex de redes<a class="headerlink" href="#ejemplo-del-metodo-simplex-de-redes" title="Permalink to this headline">¶</a></h1>
<div class="admonition-notas-para-contenedor-de-docker admonition">
<p class="admonition-title">Notas para contenedor de docker:</p>
<p>Comando de docker para ejecución de la nota de forma local:</p>
<p>nota: cambiar <code class="docutils literal notranslate"><span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;</span></code> por la ruta de directorio que se desea mapear a <code class="docutils literal notranslate"><span class="pre">/datos</span></code> dentro del contenedor de docker.</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span> <span class="pre">--rm</span> <span class="pre">-v</span> <span class="pre">&lt;ruta</span> <span class="pre">a</span> <span class="pre">mi</span> <span class="pre">directorio&gt;:/datos</span> <span class="pre">--name</span> <span class="pre">jupyterlab_optimizacion_2</span> <span class="pre">-p</span> <span class="pre">8888:8888</span> <span class="pre">-p</span> <span class="pre">8787:8787</span> <span class="pre">-d</span> <span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code></p>
<p>password para jupyterlab: <code class="docutils literal notranslate"><span class="pre">qwerty</span></code></p>
<p>Detener el contenedor de docker:</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">stop</span> <span class="pre">jupyterlab_optimizacion_2</span></code></p>
<p>Documentación de la imagen de docker <code class="docutils literal notranslate"><span class="pre">palmoreck/jupyterlab_optimizacion_2:3.0.0</span></code> en <a class="reference external" href="https://github.com/palmoreck/dockerfiles/tree/master/jupyterlab/optimizacion_2">liga</a>.</p>
</div>
<hr class="docutils" />
<div class="tip admonition">
<p class="admonition-title">Al final de esta nota el y la lectora:</p>
<ul class="simple">
<li><p>Aplicará el método de símplex de redes para resolver un problema de flujo con costo mínimo.</p></li>
<li><p>Relacionará definiciones revisadas en las notas de redes y programación lineal con técnicas que se utilizan en el método símplex para manejar cotas superiores y selección de variables no básicas y variables básicas. No se entrará en detalles de implementación, se trabajará sobre la red misma.</p></li>
</ul>
</div>
<div class="sidebar">
<p class="sidebar-title">El método símplex de redes …</p>
<p>El problema de flujo con costo mínimo tiene una posición central entre los modelos de optimización de redes, pues abarca una clase amplia de aplicaciones y su solución es muy eficiente. La razón por la que el problema de flujo con costo mínimo se puede resolver eficientemente es que su formulación es un programa lineal y es posible resolverlo con una versión simplificada del método símplex llamada método símplex de redes.</p>
<p>A grandes rasgos el método símplex de redes realiza los mismos pasos que el método símplex en cada iteración: encontrar la variable básica entrante, determinar la variable básica que sale y obtener la nueva solución básica factible (BF) con el fin de moverse de la solución BF actual a una adyacente mejor. Sin embargo, ejecuta estos pasos en una forma que explota la estructura especial de la red del problema.</p>
</div>
<p>En esta nota se revisa un ejemplo del uso del método símplex aplicado a problemas de redes con capacidades (variables de decisión con cotas superiores) y resolver un problema de flujo con costo mínimo. Se utilizarán las <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#dgflujoredes"><span class="std std-ref">Definiciones generales de flujo en redes</span></a> y  el ejemplo de <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejflujoenredesypl"><span class="std std-ref">flujo en redes</span></a> añadiendo capacidad a los arcos <span class="math notranslate nohighlight">\((A, B)\)</span> y <span class="math notranslate nohighlight">\((C, E)\)</span> igual a <span class="math notranslate nohighlight">\(10\)</span> y <span class="math notranslate nohighlight">\(80\)</span> respectivamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">pprint</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                               <span class="n">G_to_plot</span><span class="p">,</span> <span class="n">nodes_position</span><span class="p">,</span>
                                               <span class="n">nodes_position_modified</span><span class="p">,</span>
                                               <span class="n">node_labels</span><span class="p">,</span>
                                               <span class="n">string_for_edges_trouble_to_visualize</span><span class="p">,</span>
                                               <span class="n">list_of_edges_trouble_to_visualize</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auxiliary function to plot graph that have two nodes with arcs in both directions,</span>
<span class="sd">    e.g: (A,B) and (B,A).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">figsize_tuple</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize_tuple</span><span class="p">)</span>
        
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                           <span class="n">edgelist</span><span class="o">=</span><span class="n">G_to_plot</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                                 <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                           <span class="n">edgelist</span><span class="o">=</span><span class="n">list_of_edges_trouble_to_visualize</span><span class="p">)</span>
    
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                                 <span class="n">edge_labels</span><span class="o">=</span><span class="n">string_for_edges_trouble_to_visualize</span><span class="p">,</span>
                                 <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position_modified</span><span class="p">,</span> 
                            <span class="n">labels</span><span class="o">=</span><span class="n">node_labels</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_to_plot</span><span class="p">,</span>
               <span class="n">nodes_position</span><span class="p">,</span>
               <span class="n">nodes_position_modified</span><span class="p">,</span>
               <span class="n">nodes_labels</span><span class="p">,</span>
               <span class="n">edge_labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auxiliary function to plot graph with nodes that have edges with one direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
  
    <span class="k">if</span> <span class="n">figsize_tuple</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize_tuple</span><span class="p">)</span>
        
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span>
                                 <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span>
                                 <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position_modified</span><span class="p">,</span>
                            <span class="n">labels</span><span class="o">=</span><span class="n">nodes_labels</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">fill_edge_for_graph_of_upper_bounds</span><span class="p">(</span><span class="n">G_to_be_filled</span><span class="p">,</span> <span class="n">edge_to_be_added</span><span class="p">,</span> <span class="n">dict_reference</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auxiliary function to create metadata of edge thata will be added in graph of upper bounds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G_to_be_filled</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_reference</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">G_to_be_filled</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_reference</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">G_to_be_filled</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_reference</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">add_edge_to_graph_of_upper_bounds</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
                                      <span class="n">edge_to_be_added</span><span class="p">,</span>
                                      <span class="n">dict_edge_labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that will add an input edge to graph of upper bounds.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                          <span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">dict_edge_labels</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dict_edge_labels</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_reference</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">dict_edge_labels</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_reference</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">dict_edge_labels</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_reference</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">fill_edge_for_graph_of_upper_bounds</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
                                        <span class="n">edge_to_be_added</span><span class="p">,</span> 
                                        <span class="n">dict_edge_labels</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">])</span>
    <span class="n">netflow_node1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span> <span class="s2">&quot;netflow&quot;</span><span class="p">)[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">netflow_node_and_netflow1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">netflow_node2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span> <span class="s2">&quot;netflow&quot;</span><span class="p">)[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">netflow_node_and_netflow2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span> <span class="p">{</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">netflow_node1</span><span class="p">,</span>
                                                                                <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">netflow_node_and_netflow1</span><span class="p">},</span>
                                                          <span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">netflow_node2</span><span class="p">,</span>
                                                                                <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">netflow_node_and_netflow2</span><span class="p">}</span>
                                                         <span class="p">})</span>
    <span class="k">return</span> <span class="n">G_simplex_edges_upper_bounds</span>
<span class="k">def</span> <span class="nf">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_to_plot</span><span class="p">,</span>
                          <span class="n">nodes_position</span><span class="p">,</span>
                          <span class="n">nodes_position_modified</span><span class="p">,</span>
                          <span class="n">nodes_labels</span><span class="p">,</span>
                          <span class="n">edge_labels</span><span class="p">,</span>
                          <span class="n">edge_to_be_added</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auxiliary function to plot graph with cycle. The graph have edges with one direction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">figsize_tuple</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize_tuple</span><span class="p">)</span>
        
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                           <span class="n">edgelist</span><span class="o">=</span><span class="n">G_to_plot</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                           <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                           <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">],</span>
                           <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                           <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>    
    
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span>
                                 <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span>
                                 <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position_modified</span><span class="p">,</span>
                            <span class="n">labels</span><span class="o">=</span><span class="n">nodes_labels</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">plot_graph_with_cycle_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                                     <span class="n">G_to_plot</span><span class="p">,</span>
                                                     <span class="n">nodes_position</span><span class="p">,</span>
                                                     <span class="n">nodes_position_modified</span><span class="p">,</span>
                                                     <span class="n">nodes_labels</span><span class="p">,</span>
                                                     <span class="n">edge_labels</span><span class="p">,</span>
                                                     <span class="n">edge_to_be_added</span><span class="p">,</span>
                                                     <span class="n">string_for_edges_trouble_to_visualize</span>
                                                     <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auxiliary function to plot graph with cycle. The graph have edges with both directions,</span>
<span class="sd">    e.g: (A,B) and (B,A).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">figsize_tuple</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize_tuple</span><span class="p">)</span>
        
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                           <span class="n">edgelist</span><span class="o">=</span><span class="n">G_to_plot</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span>
                                 <span class="n">edge_labels</span><span class="o">=</span><span class="n">edge_labels</span><span class="p">,</span>
                                 <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>    
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_and_pos</span><span class="p">,</span> 
                           <span class="n">min_target_margin</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3, rad = 0.1&quot;</span><span class="p">,</span>
                           <span class="n">edgelist</span><span class="o">=</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">],</span>
                           <span class="n">width</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                           <span class="n">style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>    
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edge_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                                <span class="n">edge_labels</span><span class="o">=</span><span class="n">string_for_edges_trouble_to_visualize</span><span class="p">,</span>
                                <span class="n">font_size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> 
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_labels</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position_modified</span><span class="p">,</span>
                            <span class="n">labels</span><span class="o">=</span><span class="n">nodes_labels</span><span class="p">)</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G_to_plot</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">nodes_position</span><span class="p">,</span> 
                           <span class="n">node_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_full</span><span class="p">,</span> <span class="n">G_spanning_tree</span><span class="p">,</span> <span class="n">edge_to_be_added</span><span class="p">,</span> <span class="n">edge_labels</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that recieves spanning tree and add an edge to it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G_cycle</span> <span class="o">=</span> <span class="n">G_spanning_tree</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">G_cycle</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">G_cycle</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_full</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">G_cycle</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_full</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">G_cycle</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">edge_labels_new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels</span><span class="p">)</span>
    <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_cycle</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_cycle</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_cycle</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">G_cycle</span><span class="p">,</span> <span class="n">edge_labels_new</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">edge_label_change_for_basic_edge_subs</span><span class="p">(</span><span class="n">c_d</span><span class="p">,</span> <span class="n">edge_labels_reference</span><span class="p">,</span> <span class="n">edge_to_be_added</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that change labels of edges that are in a cycle after adding edge to </span>
<span class="sd">    spanning tree and will be augmented their flow.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">edge_labels_with_flow_change</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">edge_labels_with_flow_change</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_reference</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">edge_labels_with_flow_change</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">c_d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="n">edge_to_be_added</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">c_d</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
                    <span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]),</span>
                                                                           <span class="s2">&quot;+ $flow^+$&quot;</span><span class="p">])</span>
                    <span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span> 
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]),</span>
                                                                           <span class="s2">&quot;- $flow^+$&quot;</span><span class="p">])</span>
                    <span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]),</span>
                                                                       <span class="s2">&quot;$flow^+$&quot;</span><span class="p">])</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="k">return</span> <span class="n">edge_labels_with_flow_change</span>
<span class="k">def</span> <span class="nf">get_spanning_tree_from_spanning_tree_reference</span><span class="p">(</span><span class="n">G_spanning_tree_reference</span><span class="p">,</span> 
                                                   <span class="n">edge_to_remove</span><span class="p">,</span>
                                                   <span class="n">edge_to_add</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that output new spanning tree from a reference spanning tree. </span>
<span class="sd">    Removes edge an add new edge to reference spanning tree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G_spanning_tree</span> <span class="o">=</span> <span class="n">G_spanning_tree_reference</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">G_spanning_tree</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">edge_to_remove</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_to_remove</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">G_spanning_tree</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">G_spanning_tree</span>
<span class="k">def</span> <span class="nf">increase_flow_from_edge_labels_with_flow_change</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span>
                                                    <span class="n">G_spanning_tree_reference</span><span class="p">,</span>
                                                    <span class="n">G_spanning_tree</span><span class="p">,</span>
                                                    <span class="n">edge_to_add</span><span class="p">,</span>
                                                    <span class="n">edge_labels_with_flow_change</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that increases and decreases flow for each edge that are in a cycle.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">list_edges_spanning_tree</span> <span class="o">=</span> <span class="n">G_spanning_tree</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
    <span class="n">edge_labels_spanning_tree</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_spanning_tree</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="n">edge_to_add</span><span class="p">:</span>
            <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">G_spanning_tree_reference</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="k">if</span> <span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
                <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">flow_plus</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">edge_labels_with_flow_change</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;bool&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
                    <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">flow_plus</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
    
        <span class="k">if</span> <span class="n">e</span> <span class="o">==</span> <span class="n">edge_to_add</span><span class="p">:</span>
            <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_reference</span><span class="p">[</span><span class="n">edge_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
            <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_reference</span><span class="p">[</span><span class="n">edge_to_add</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_add</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
            <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_plus</span> 
            
    
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_spanning_tree</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
        <span class="n">G_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">==</span><span class="n">edge_to_add</span><span class="p">:</span>
            <span class="n">G_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
            <span class="n">G_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_spanning_tree</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>    
    
    <span class="k">return</span> <span class="p">(</span><span class="n">G_spanning_tree</span><span class="p">,</span> <span class="n">edge_labels_spanning_tree</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">fix_orientation</span><span class="p">(</span><span class="n">c_d</span><span class="p">,</span> <span class="n">edge</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Auxiliary function that changes orientation acoording to direction of edge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">c_d</span><span class="p">[</span><span class="n">edge</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">c_d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">c_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
                <span class="n">c_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;reverse&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;forward&quot;</span>
<span class="k">def</span> <span class="nf">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">c_d</span><span class="p">,</span> <span class="n">e_w_d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that computes unit cost per increment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">m_number_of_edges_simplex_cycle</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">e_w_d</span><span class="p">)</span>
    <span class="n">weights_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">m_number_of_edges_simplex_cycle</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">c_d</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">c_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;forward&quot;</span><span class="p">:</span>
            <span class="n">weights_array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">e_w_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">weights_array</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="n">e_w_d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">weights_array</span>
<span class="k">def</span> <span class="nf">get_new_network_after_upper_bound_technique</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span> <span class="n">edge_to_be_removed</span><span class="p">,</span>
                                                <span class="n">edge_to_be_added</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that output new network after upper bound technique.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">G_new</span> <span class="o">=</span> <span class="n">G_reference</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">G_new</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">edge_to_be_removed</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_to_be_removed</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">G_new</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">list_edges_new</span> <span class="o">=</span> <span class="n">G_new</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
    <span class="n">value_for_netflow_change</span> <span class="o">=</span> <span class="n">G_reference</span><span class="p">[</span><span class="n">edge_to_be_removed</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_removed</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    
    <span class="n">edge_labels_reference</span> <span class="o">=</span> <span class="n">G_reference</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
    <span class="n">edge_labels_new</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_new</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">e</span> <span class="o">!=</span> <span class="n">edge_to_be_added</span><span class="p">:</span>
            <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_reference</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">G_reference</span><span class="p">[</span><span class="n">edge_to_be_removed</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_removed</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
            <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_reference</span><span class="p">[</span><span class="n">edge_to_be_removed</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_removed</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    
    
    <span class="n">G_new</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span>   <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">G_new</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_new</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    
    <span class="n">new_netflow_1</span> <span class="o">=</span> <span class="n">value_for_netflow_change</span> <span class="o">+</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span> <span class="s2">&quot;netflow&quot;</span><span class="p">)[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">new_netflow_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_reference</span><span class="p">,</span> <span class="s2">&quot;netflow&quot;</span><span class="p">)[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">-</span> <span class="n">value_for_netflow_change</span>
    
    <span class="n">node_and_netflow_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_1</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
    <span class="n">node_and_netflow_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_2</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
    
    <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G_new</span><span class="p">,</span> <span class="p">{</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_1</span><span class="p">,</span>
                                                         <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">node_and_netflow_1</span><span class="p">},</span>
                                        <span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_2</span><span class="p">,</span>
                                                              <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">node_and_netflow_2</span><span class="p">}</span>
                                    <span class="p">})</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">G_new</span><span class="p">,</span> <span class="n">edge_labels_new</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">update_netflows_after_upper_bound_technique</span><span class="p">(</span><span class="n">G</span><span class="p">,</span>
                                                <span class="n">value_for_netflow_change</span><span class="p">,</span>
                                                <span class="n">edge_of_nodes_that_will_change_netflow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function that update netflows of each node after upper bound technique.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">new_netflow_1</span> <span class="o">=</span> <span class="n">value_for_netflow_change</span> <span class="o">+</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s2">&quot;netflow&quot;</span><span class="p">)[</span><span class="n">edge_of_nodes_that_will_change_netflow</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">new_netflow_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s2">&quot;netflow&quot;</span><span class="p">)[</span><span class="n">edge_of_nodes_that_will_change_netflow</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">-</span> <span class="n">value_for_netflow_change</span>
    
    <span class="n">new_node_and_netflow_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_of_nodes_that_will_change_netflow</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_1</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
    <span class="n">new_node_and_netflow_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">edge_of_nodes_that_will_change_netflow</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_2</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
    <span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="p">{</span><span class="n">edge_of_nodes_that_will_change_netflow</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_1</span><span class="p">,</span>
                                                                           <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">new_node_and_netflow_1</span><span class="p">},</span>
                               <span class="n">edge_of_nodes_that_will_change_netflow</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_2</span><span class="p">,</span>
                                                                           <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">new_node_and_netflow_2</span><span class="p">}</span>
                               <span class="p">})</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes_pos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.18181818181818182</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.18181818181818182</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.36363636363636365</span><span class="p">,</span> <span class="mf">0.5454545454545454</span><span class="p">]]</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">]</span>

<span class="n">nodes_and_pos</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">nodes_pos</span><span class="p">))</span>

<span class="n">G_min_cost_flow</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;A [50]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;B [40]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>   <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;C [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;D [-30]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;E [-60]&quot;</span><span class="p">)</span>

<span class="n">edge_labels_min_cost_flow</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">},</span>
                             <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="s2">&quot;inf&quot;</span><span class="p">}</span>
                            <span class="p">}</span>


<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_labels_min_cost_flow</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>


<span class="n">n1</span> <span class="o">=</span> <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s1">&#39;D&#39;</span><span class="p">]</span>
<span class="n">n2</span> <span class="o">=</span> <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>

<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;inf&quot;</span>

<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span><span class="o">=</span> <span class="s2">&quot;inf&quot;</span>


<span class="n">stri1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">stri2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span>
<span class="n">stri3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stri1</span><span class="p">,</span> <span class="n">stri2</span><span class="p">,</span> <span class="n">stri3</span><span class="p">])}</span>

<span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)]</span>
    
<span class="n">node_labels_min_cost_flow</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">nodes_pos_modified</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">y_off</span> <span class="o">=</span> <span class="mf">0.03</span>

<span class="n">nodes_and_pos_modified</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">nodes_and_pos</span><span class="p">)</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_off</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span>  <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                         <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_off</span><span class="p">]</span>
        

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_9_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_9_0.png" />
</div>
</div>
<p>En la red anterior el arco <span class="math notranslate nohighlight">\((D, E)\)</span> tiene costo igual a <span class="math notranslate nohighlight">\(3\)</span> y el arco <span class="math notranslate nohighlight">\((E, D)\)</span> tiene costo igual a <span class="math notranslate nohighlight">\(2\)</span>.</p>
<p>Al lado de cada nodo en corchetes se presenta el flujo neto generado por el nodo. Los nodos origen tienen un flujo neto positivo y en la red son los nodos “A” y “B” (por ejemplo fábricas). Los nodos destino tienen un flujo neto negativo que en la red son los nodos “D” y “E” (por ejemplo clientes). El único nodo de transbordo es el nodo “C” que tiene flujo neto igual a cero (centro de distribución por ejemplo). Los valores de los costos se muestran en los arcos.</p>
<p>Entonces el modelo de PL que minimiza el costo de transferencia de flujo de modo que el <strong>flujo neto</strong> satisfaga lo representado en la red, considerando el flujo neto como el flujo total que sale del nodo menos el flujo total que entra al nodo es:</p>
<div class="math notranslate nohighlight">
\[\displaystyle \min 2 x_{AB} + 4 x_{AC} + 9 x_{AD} + 3 x_{BC} + x_{CE} + 3 x_{DE} + 2x_{ED}\]</div>
<div class="math notranslate nohighlight">
\[\text{sujeto a: }\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
&amp;x_{AB}&amp;  + &amp;x_{AC}&amp; + &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 50 \nonumber \\
&amp;-x_{AB}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{BC}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 40 \nonumber \\
&amp;&amp;        - &amp;x_{AC}&amp;   &amp;&amp;       - &amp;x_{BC}&amp; + &amp;x_{CE}&amp;   &amp;&amp;         &amp;&amp;       &amp;=&amp; 0 \nonumber \\
&amp;&amp;          &amp;&amp;       - &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{DE}&amp; - &amp;x_{ED}&amp; &amp;=&amp; -30 \nonumber \\
&amp;&amp;          &amp;&amp;         &amp;&amp;         &amp;&amp;       - &amp;x_{CE}&amp; - &amp;x_{DE}&amp; + &amp;x_{ED}&amp; &amp;=&amp; -60 \nonumber
\end{eqnarray}
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[x_{AB} \leq 10, x_{CE} \leq 80\]</div>
<div class="math notranslate nohighlight">
\[x_{ij} \geq 0 \forall i,j\]</div>
<p>La primer restricción de igualdad representa el flujo neto para el nodo <span class="math notranslate nohighlight">\(A\)</span> y la última el flujo neto para el nodo <span class="math notranslate nohighlight">\(E\)</span>. A tales ecuaciones de las restricciones de igualdad se les conoce con el nombre de <strong>ecuaciones de conservación de flujo</strong>.</p>
<div class="cell tag_margin tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_19_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_19_0.png" />
</div>
</div>
<p>La red solución (omitiendo arcos con flujo igual a cero) es:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_min_cost_flow_solution</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_min_cost_flow_solution</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;A [50]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow_solution</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;B [40]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow_solution</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>   <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;C [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow_solution</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;D [-30]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow_solution</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;E [-60]&quot;</span><span class="p">)</span>

<span class="n">edge_flows</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="mi">40</span><span class="p">,</span>
              <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="mi">10</span><span class="p">,</span>
              <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="mi">40</span><span class="p">,</span>
              <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="mi">80</span><span class="p">,</span>            
              <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="mi">20</span>
              <span class="p">}</span>

<span class="n">G_min_cost_flow_solution</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_flows</span><span class="p">)</span>
<span class="n">node_labels_min_cost_flow_solution</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow_solution</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_min_cost_flow_solution</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_min_cost_flow_solution</span><span class="p">,</span>
           <span class="n">edge_flows</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_21_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_21_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Tal solución se puede verificar utilizando el paquete <em>Networkx</em> y ejecutar las instrucciones en el ejemplo de <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#ejredflujocostomin"><span class="std std-ref">flujo con costo mínimo</span></a>, en estas instrucciones se utiliza la función <a class="reference external" href="https://networkx.org/documentation/stable/reference/algorithms/flow.html#network-simplex">network_simplex</a>.</p>
</div>
<p>La designación del flujo anterior entre todos los nodos incurre en un costo de <span class="math notranslate nohighlight">\(490\)</span>.</p>
<p>Podemos revisar el contenido de información de los nodos y de los arcos con las siguientes funciones respectivamente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">nodes</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>NodeDataView({&#39;A&#39;: {&#39;netflow&#39;: 50, &#39;node_and_netflow&#39;: &#39;A [50]&#39;}, &#39;B&#39;: {&#39;netflow&#39;: 40, &#39;node_and_netflow&#39;: &#39;B [40]&#39;}, &#39;C&#39;: {&#39;netflow&#39;: 0, &#39;node_and_netflow&#39;: &#39;C [0]&#39;}, &#39;D&#39;: {&#39;netflow&#39;: -30, &#39;node_and_netflow&#39;: &#39;D [-30]&#39;}, &#39;E&#39;: {&#39;netflow&#39;: -60, &#39;node_and_netflow&#39;: &#39;E [-60]&#39;}})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OutEdgeDataView([(&#39;A&#39;, &#39;B&#39;, {&#39;capacity&#39;: 10, &#39;weight&#39;: 2}), (&#39;A&#39;, &#39;C&#39;, {&#39;capacity&#39;: &#39;inf&#39;, &#39;weight&#39;: 4}), (&#39;A&#39;, &#39;D&#39;, {&#39;capacity&#39;: &#39;inf&#39;, &#39;weight&#39;: 9}), (&#39;B&#39;, &#39;C&#39;, {&#39;capacity&#39;: &#39;inf&#39;, &#39;weight&#39;: 3}), (&#39;C&#39;, &#39;E&#39;, {&#39;capacity&#39;: 80, &#39;weight&#39;: 1}), (&#39;D&#39;, &#39;E&#39;, {&#39;capacity&#39;: &#39;inf&#39;, &#39;weight&#39;: 3}), (&#39;E&#39;, &#39;D&#39;, {&#39;capacity&#39;: &#39;inf&#39;, &#39;weight&#39;: 2})])
</pre></div>
</div>
</div>
</div>
<div class="section" id="arcos-basicos-y-no-basicos">
<h2>Arcos básicos y no básicos<a class="headerlink" href="#arcos-basicos-y-no-basicos" title="Permalink to this headline">¶</a></h2>
<p>Supóngase que se tienen <span class="math notranslate nohighlight">\(n\)</span> nodos en una red. Se tienen las siguientes definiciones y resultados:</p>
<ul class="simple">
<li><p>Toda solución básica factible (BF) tiene <span class="math notranslate nohighlight">\(n-1\)</span> variables básicas y representan el flujo por el arco respectivo. Esto resulta de tener una matriz de incidencia con rank igual a <span class="math notranslate nohighlight">\(n-1\)</span>, ver <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#matincidnodoarco"><span class="std std-ref">representación de redes: matriz de incidencia nodo-arco</span></a>.</p></li>
<li><p>Los <span class="math notranslate nohighlight">\(n-1\)</span> arcos correspondientes a las variables básicas se les nombra <strong>arcos básicos</strong> y los que corresponden a las variables no básicas son <strong>arcos no básicos.</strong></p></li>
<li><p>Cualquier conjunto de <span class="math notranslate nohighlight">\(n-1\)</span> arcos forma un <em>spanning tree</em>, ver <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#arboryspantree"><span class="std std-ref">arborescencia y spanning tree</span></a>.</p></li>
<li><p>Un <em>spanning tree</em> solución se obtiene igualando las variables correspondientes a sus <em>nontree arcs</em> a cero y las variables correspondientes a sus <em>tree arcs</em> de acuerdo al sistema de ecuaciones lineales conformado por las restricciones de los nodos (flujos netos).</p></li>
<li><p>Un <em>spanning tree</em> solución factible es un <em>spanning tree</em> solución cuyos arcos satisfacen todas las demás restricciones (por ejemplo no negatividad y cotas superiores).</p></li>
<li><p>Las soluciones básicas son <em>spanning trees</em> solución y las soluciones BF son <em>spanning trees</em> solución factibles.</p></li>
</ul>
<div class="section" id="ejemplo">
<h3>Ejemplo<a class="headerlink" href="#ejemplo" title="Permalink to this headline">¶</a></h3>
<p>Tomando como ejemplo la red anterior y el PL asociado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_AB</span><span class="p">,</span> <span class="n">x_AC</span><span class="p">,</span> <span class="n">x_AD</span><span class="p">,</span> <span class="n">x_BC</span><span class="p">,</span> <span class="n">x_CE</span><span class="p">,</span> <span class="n">x_DE</span><span class="p">,</span> <span class="n">x_ED</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s2">&quot;x_AB, x_AC, x_AD, x_BC, x_CE, x_DE, x_ED&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">([</span><span class="n">x_AB</span><span class="p">,</span> <span class="n">x_AC</span><span class="p">,</span> <span class="n">x_AD</span><span class="p">,</span> <span class="n">x_BC</span><span class="p">,</span> <span class="n">x_CE</span><span class="p">,</span> <span class="n">x_DE</span><span class="p">,</span> <span class="n">x_ED</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">sympy</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{x_AB: x_BC - 40, x_AC: -x_BC - x_DE + x_ED + 60, x_AD: x_DE - x_ED + 30, x_CE
: -x_DE + x_ED + 60}
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
&amp;x_{AB}&amp;  + &amp;x_{AC}&amp; + &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 50 \nonumber \\
&amp;-x_{AB}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{BC}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 40 \nonumber \\
&amp;&amp;        - &amp;x_{AC}&amp;   &amp;&amp;       - &amp;x_{BC}&amp; + &amp;x_{CE}&amp;   &amp;&amp;         &amp;&amp;       &amp;=&amp; 0 \nonumber \\
&amp;&amp;          &amp;&amp;       - &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{DE}&amp; - &amp;x_{ED}&amp; &amp;=&amp; -30 \nonumber \\
&amp;&amp;          &amp;&amp;         &amp;&amp;         &amp;&amp;       - &amp;x_{CE}&amp; - &amp;x_{DE}&amp; + &amp;x_{ED}&amp; &amp;=&amp; -60 \nonumber
\end{eqnarray}
\)</span></p>
<p><span class="math notranslate nohighlight">\(x_{AB} \leq 10, x_{CE} \leq 80\)</span>, <span class="math notranslate nohighlight">\(x_{ij} \geq 0 \forall i,j\)</span></p>
</div>
<p>Una solución no factible del PL pues no cumple con la cota <span class="math notranslate nohighlight">\(x_{AB} \geq 0\)</span> es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_solutions_to_linear_system_of_equations</span><span class="p">(</span><span class="n">xBC</span><span class="p">,</span> <span class="n">xDE</span><span class="p">,</span> <span class="n">xED</span><span class="p">):</span>
    <span class="n">xAB</span><span class="o">=</span> <span class="n">xBC</span> <span class="o">-</span> <span class="mi">40</span> 
    <span class="n">xAC</span><span class="o">=</span> <span class="o">-</span><span class="n">xBC</span> <span class="o">-</span> <span class="n">xDE</span> <span class="o">+</span> <span class="n">xED</span> <span class="o">+</span> <span class="mi">60</span> 
    <span class="n">xAD</span><span class="o">=</span> <span class="n">xDE</span> <span class="o">-</span> <span class="n">xED</span> <span class="o">+</span> <span class="mi">30</span>
    <span class="n">xCE</span><span class="o">=</span> <span class="o">-</span><span class="n">xDE</span> <span class="o">+</span> <span class="n">xED</span> <span class="o">+</span> <span class="mi">60</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xAB</span><span class="p">,</span> <span class="n">xAC</span><span class="p">,</span> <span class="n">xAD</span><span class="p">,</span> <span class="n">xBC</span><span class="p">,</span> <span class="n">xCE</span><span class="p">,</span> <span class="n">xDE</span><span class="p">,</span> <span class="n">xED</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xBC</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">xDE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">xED</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">xAB</span><span class="p">,</span> <span class="n">xAC</span><span class="p">,</span> <span class="n">xAD</span><span class="p">,</span> <span class="n">xBC</span><span class="p">,</span> <span class="n">xCE</span><span class="p">,</span> <span class="n">xDE</span><span class="p">,</span> <span class="n">xED</span> <span class="o">=</span> <span class="n">get_solutions_to_linear_system_of_equations</span><span class="p">(</span><span class="n">xBC</span><span class="p">,</span> <span class="n">xDE</span><span class="p">,</span> <span class="n">xED</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">xAB</span><span class="p">,</span> <span class="n">xAC</span><span class="p">,</span> <span class="n">xAD</span><span class="p">,</span> <span class="n">xBC</span><span class="p">,</span> <span class="n">xCE</span><span class="p">,</span> <span class="n">xDE</span><span class="p">,</span> <span class="n">xED</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-40 60 30 0 60 0 0
</pre></div>
</div>
</div>
</div>
<p>El <em>spanning tree</em> solución no factible con sus <em>nontree</em> arcs iguales a cero asociado es (omitiendo arcos con flujo igual a cero) el siguiente, se muestra en el margen la red original para referencia:</p>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_43_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_43_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_spanning_tree_infeasible</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_spanning_tree_infeasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;A [50]&quot;</span><span class="p">)</span>
<span class="n">G_spanning_tree_infeasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;B [40]&quot;</span><span class="p">)</span>
<span class="n">G_spanning_tree_infeasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>   <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;C [0]&quot;</span><span class="p">)</span>
<span class="n">G_spanning_tree_infeasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;D [-30]&quot;</span><span class="p">)</span>
<span class="n">G_spanning_tree_infeasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;E [-60]&quot;</span><span class="p">)</span>

<span class="n">edge_flows_infeasible</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">):</span> <span class="n">xAB</span><span class="p">,</span>
                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="n">xAC</span><span class="p">,</span>
                         <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="n">xAD</span><span class="p">,</span>
                         <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="n">xCE</span><span class="p">,</span>            
                         <span class="p">}</span>

<span class="n">G_spanning_tree_infeasible</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_flows_infeasible</span><span class="p">)</span>
<span class="n">node_labels_infeasible</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_spanning_tree_infeasible</span><span class="p">,</span> 
                                                <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_spanning_tree_infeasible</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_infeasible</span><span class="p">,</span>
           <span class="n">edge_flows_infeasible</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_44_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_44_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><span class="math notranslate nohighlight">\(
\begin{eqnarray}
&amp;x_{AB}&amp;  + &amp;x_{AC}&amp; + &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 50 \nonumber \\
&amp;-x_{AB}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{BC}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 40 \nonumber \\
&amp;&amp;        - &amp;x_{AC}&amp;   &amp;&amp;       - &amp;x_{BC}&amp; + &amp;x_{CE}&amp;   &amp;&amp;         &amp;&amp;       &amp;=&amp; 0 \nonumber \\
&amp;&amp;          &amp;&amp;       - &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{DE}&amp; - &amp;x_{ED}&amp; &amp;=&amp; -30 \nonumber \\
&amp;&amp;          &amp;&amp;         &amp;&amp;         &amp;&amp;       - &amp;x_{CE}&amp; - &amp;x_{DE}&amp; + &amp;x_{ED}&amp; &amp;=&amp; -60 \nonumber
\end{eqnarray}
\)</span></p>
<p><span class="math notranslate nohighlight">\(x_{AB} \leq 10, x_{CE} \leq 80\)</span>, <span class="math notranslate nohighlight">\(x_{ij} \geq 0 \forall i,j\)</span></p>
</div>
<p>Una solución factible al PL es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xBC</span> <span class="o">=</span> <span class="mi">40</span> 
<span class="n">xDE</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">xED</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">xAB</span><span class="p">,</span> <span class="n">xAC</span><span class="p">,</span> <span class="n">xAD</span><span class="p">,</span> <span class="n">xBC</span><span class="p">,</span> <span class="n">xCE</span><span class="p">,</span> <span class="n">xDE</span><span class="p">,</span> <span class="n">xED</span> <span class="o">=</span> <span class="n">get_solutions_to_linear_system_of_equations</span><span class="p">(</span><span class="n">xBC</span><span class="p">,</span> <span class="n">xDE</span><span class="p">,</span> <span class="n">xED</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">xAB</span><span class="p">,</span> <span class="n">xAC</span><span class="p">,</span> <span class="n">xAD</span><span class="p">,</span> <span class="n">xBC</span><span class="p">,</span> <span class="n">xCE</span><span class="p">,</span> <span class="n">xDE</span><span class="p">,</span> <span class="n">xED</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0 20 30 40 60 0 0
</pre></div>
</div>
</div>
</div>
<p>El <em>spanning tree</em> solución factible con sus <em>nontree</em> arcs iguales a cero asociado es (omitiendo arcos con flujo igual a cero) el siguiente, se muestra en el margen la red original para referencia::</p>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_50_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_50_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_spanning_tree_feasible</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_spanning_tree_feasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;A [50]&quot;</span><span class="p">)</span>
<span class="n">G_spanning_tree_feasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;B [40]&quot;</span><span class="p">)</span>
<span class="n">G_spanning_tree_feasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>   <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;C [0]&quot;</span><span class="p">)</span>
<span class="n">G_spanning_tree_feasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;D [-30]&quot;</span><span class="p">)</span>
<span class="n">G_spanning_tree_feasible</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;E [-60]&quot;</span><span class="p">)</span>

<span class="n">edge_flows_feasible</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="n">xAC</span><span class="p">,</span>
                       <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">):</span> <span class="n">xAD</span><span class="p">,</span>
                       <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">):</span> <span class="n">xBC</span><span class="p">,</span>
                       <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="n">xCE</span>
                       <span class="p">}</span>

<span class="n">G_spanning_tree_feasible</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_flows_feasible</span><span class="p">)</span>
<span class="n">node_labels_feasible</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_spanning_tree_feasible</span><span class="p">,</span> 
                                              <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_spanning_tree_feasible</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_feasible</span><span class="p">,</span>
           <span class="n">edge_flows_feasible</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_51_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_51_0.png" />
</div>
</div>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>El método símplex de redes se mueve de un <em>spanning tree</em> solución factible a otro <em>spanning tree</em> solución factible iterativamente.</p>
</div>
</div>
</div>
<div class="section" id="tecnica-de-la-cota-superior">
<h2>Técnica de la cota superior<a class="headerlink" href="#tecnica-de-la-cota-superior" title="Permalink to this headline">¶</a></h2>
<p>En este ejemplo se tienen cotas superiores como: <span class="math notranslate nohighlight">\(x_{AB} \leq 10\)</span> o <span class="math notranslate nohighlight">\(x_{CE} \leq 80\)</span> (capacidades de los arcos) por lo que se debe adaptar el método símplex descrito en el <a class="reference internal" href="../4.2/Programacion_lineal_y_metodo_simplex.html#ejmetsimplexaplicadoejprototipo"><span class="std std-ref">ejemplo del método símplex</span></a> con la técnica de la cota superior. Recuérdese que el método símplex descrito se aplicó a PL’s que tienen restricciones de igualdad y restricciones de no negatividad.</p>
<p>La idea de la técnica es considerar que el <strong>arco básico</strong> que debido a un incremento llegue a un flujo igual al de su cota superior, sea <strong>reemplazado</strong> por un arco en dirección contraria con la misma capacidad y con costo igual al <strong>negativo</strong> del arco original. Tales arcos los nombramos <strong>arcos inversos</strong>. Además los flujos netos de los nodos deben ajustarse a este cambio.</p>
<div class="admonition-comentarios admonition">
<p class="admonition-title">Comentarios</p>
<ul class="simple">
<li><p>Una interpretación de sustituir el arco que tiene un flujo igual a su cota superior por otro en dirección contraria es que el flujo del arco en dirección contraria “cancela” el flujo del arco original. Además un costo igual al negativo del arco original se interpreta como un “ahorro” en la transferencia del flujo.</p></li>
<li><p>El arco original se mantiene como básico con flujo igual a su cota superior y el arco en dirección contraria se considera como no básico. En iteraciones posteriores el arco original aunque es básico no se considera en el análisis para ser sustituido.</p></li>
<li><p>Recuérdese que en el método símplex si al modificar el valor de una variable básica que tiene un valor positivo llega a su cota inferior entonces es una candidata a salir del conjunto de variables básicas. Con cotas superiores las variables básicas que tienen un valor positivo menor a sus cotas, si modifican su valor de modo que llegan a tales cotas también son candidatas a salir del conjunto de variables básicas. Con la técnica de la cota superior se sustituyen estas variables por arcos inversos y “no contribuyen” con análisis posterior alguno hasta que sus arcos inversos modifiquen su valor o se finalice el método.</p></li>
</ul>
</div>
</div>
<div class="section" id="inicio-del-ejemplo">
<h2>Inicio del ejemplo<a class="headerlink" href="#inicio-del-ejemplo" title="Permalink to this headline">¶</a></h2>
<p>Para comprender la técnica de la cota superior supóngase que en alguna iteración <span class="math notranslate nohighlight">\(x_{AB}\)</span> se convirtió en la variable básica que será sustituida pues alcanzó su cota superior de <span class="math notranslate nohighlight">\(10\)</span>. Por tanto el arco <span class="math notranslate nohighlight">\(x_{AB}\)</span> se sustituye por <span class="math notranslate nohighlight">\(x_{AB} = 10 - y_{AB}\)</span> con <span class="math notranslate nohighlight">\(y_{AB}=0\)</span> y por tanto es una variable no básica “nueva”. Entonces se sustituye el arco <span class="math notranslate nohighlight">\((A,B)\)</span> por el arco inverso <span class="math notranslate nohighlight">\((B,A)\)</span> el cual tiene un flujo de <span class="math notranslate nohighlight">\(y_{AB}\)</span> con capacidad de <span class="math notranslate nohighlight">\(10\)</span> y un costo unitario de <span class="math notranslate nohighlight">\(-2\)</span>. También <span class="math notranslate nohighlight">\(b_B\)</span> aumenta de <span class="math notranslate nohighlight">\(40\)</span> a <span class="math notranslate nohighlight">\(50\)</span> y <span class="math notranslate nohighlight">\(b_A\)</span> disminuye de <span class="math notranslate nohighlight">\(50\)</span> a <span class="math notranslate nohighlight">\(40\)</span>:</p>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Los ajustes <span class="math notranslate nohighlight">\(b_A, b_B\)</span> que se realizan tienen que ver con obtener sistemas de ecuaciones lineales equivalentes con las restricciones de flujo neto del PL.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_netflow_B</span> <span class="o">=</span> <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="s2">&quot;netflow&quot;</span><span class="p">)[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">new_netflow_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>50
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new_netflow_A</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="s2">&quot;netflow&quot;</span><span class="p">)[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">new_netflow_A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Red original del problema:</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_64_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_64_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_remove_from_network</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">edge_to_add_new_network</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex</span><span class="p">,</span><span class="n">edge_labels_simplex</span> <span class="o">=</span> <span class="n">get_new_network_after_upper_bound_technique</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">edge_to_remove_from_network</span><span class="p">,</span>
                                                                            <span class="n">edge_to_add_new_network</span><span class="p">)</span>

<span class="n">node_labels_simplex</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">string_for_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span>

<span class="n">list_of_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_66_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_66_0.png" />
</div>
</div>
<p>Para futura referencia el arco <span class="math notranslate nohighlight">\((A,B)\)</span> que alcanzó la cota superior lo guardamos en la red <code class="docutils literal notranslate"><span class="pre">G_simplex_edges_upper_bounds</span></code> (e iremos guardando los arcos que lleguen a tales cotas):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_in_graph_of_upper_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_labels_simplex_upper_bounds</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">G_simplex_edges_upper_bounds</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">edge_to_be_added_in_graph_of_upper_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">edge_to_be_added_in_graph_of_upper_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">G_simplex_edges_upper_bounds</span> <span class="o">=</span> <span class="n">add_edge_to_graph_of_upper_bounds</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span>
                                                                 <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
                                                                 <span class="n">edge_to_be_added_in_graph_of_upper_bounds</span><span class="p">,</span>
                                                                 <span class="n">edge_labels_simplex_upper_bounds</span><span class="p">)</span>

<span class="n">node_labels_simplex_upper_bounds</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_upper_bounds</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_upper_bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_69_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_69_0.png" />
</div>
</div>
<p>Considérese el siguiente <em>spanning tree</em> solución factible de la red a la que se le aplicó la técnica de la cota superior y que se muestra en el margen para referencia:</p>
<div class="cell tag_margin tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_71_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_71_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

<span class="n">list_edges_spanning_tree_1</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">edge_labels_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_spanning_tree_1</span><span class="p">:</span>
    <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
     
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>


<span class="n">node_labels_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                            <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>
    
<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_72_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_72_0.png" />
</div>
</div>
<p>Los valores anteriores de flujo se pueden obtener resolviendo las siguientes ecuaciones de igualdad que resultan con el cambio <span class="math notranslate nohighlight">\(x_{AB} = 10 - y_{AB}\)</span> y considerando arcos no básicos: <span class="math notranslate nohighlight">\(y_{AB}, x_{AC}, x_{ED}\)</span> que tienen valor igual a <span class="math notranslate nohighlight">\(0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
&amp;-y_{AB}&amp;  + &amp;x_{AC}&amp; + &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 40 \nonumber \\
&amp;y_{AB}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{BC}&amp;   &amp;&amp;         &amp;&amp;         &amp;&amp;       &amp;=&amp; 50 \nonumber \\
&amp;&amp;        - &amp;x_{AC}&amp;   &amp;&amp;       - &amp;x_{BC}&amp; + &amp;x_{CE}&amp;   &amp;&amp;         &amp;&amp;       &amp;=&amp; 0 \nonumber \\
&amp;&amp;          &amp;&amp;       - &amp;x_{AD}&amp;   &amp;&amp;         &amp;&amp;       + &amp;x_{DE}&amp; - &amp;x_{ED}&amp; &amp;=&amp; -30 \nonumber \\
&amp;&amp;          &amp;&amp;         &amp;&amp;         &amp;&amp;       - &amp;x_{CE}&amp; - &amp;x_{DE}&amp; + &amp;x_{ED}&amp; &amp;=&amp; -60 \nonumber
\end{eqnarray}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> <span class="s2">&quot;flow&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;D&#39;): 40, (&#39;B&#39;, &#39;C&#39;): 50, (&#39;C&#39;, &#39;E&#39;): 50, (&#39;D&#39;, &#39;E&#39;): 10}
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Observación</p>
<p>Aunque es un poco extraña la notación <span class="math notranslate nohighlight">\(y_{AB}\)</span> para representar al arco inverso <span class="math notranslate nohighlight">\((B, A)\)</span> (pues pensaríamos en usar <span class="math notranslate nohighlight">\(y_{BA}\)</span>) esto se asigna con tal notación para mantener la forma de los sistemas de ecuaciones lineales de las restricciones de igualdad. En el sistema anterior el lugar donde se encontraba <span class="math notranslate nohighlight">\(x_{AB}\)</span> se sustituye por <span class="math notranslate nohighlight">\(y_{AB}\)</span>.</p>
</div>
<div class="section" id="revision-de-cual-arco-no-basico-sustituye-a-un-arco-basico">
<h3>Revisión de cuál arco no básico sustituye a un arco básico<a class="headerlink" href="#revision-de-cual-arco-no-basico-sustituye-a-un-arco-basico" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_margin tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_78_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_78_0.png" />
</div>
</div>
<div class="cell tag_margin tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_79_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_79_0.png" />
</div>
</div>
<p>Identificamos los arcos no básicos que son los que no están en el <em>spanning tree</em> solución factible que se obtuvo. En el margen se muestra la red de referencia y el <em>spanning tree</em> solución factible, entonces los arcos no básicos son: <span class="math notranslate nohighlight">\((B,A), (A,C), (E,D)\)</span>. Recuérdese que el arco <span class="math notranslate nohighlight">\((B,A)\)</span> se representa con la variable <span class="math notranslate nohighlight">\(y_{AB}\)</span>. La idea es que al añadir un arco al <em>spanning tree</em> solución factible se obtendrá un ciclo no dirigido. En este ciclo no dirigido se realiza un análisis de cuál arco es el que tiene una tasa más alta de mejoramiento en la función objetivo.</p>
<p><strong>Arco <span class="math notranslate nohighlight">\((B,A)\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_1</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_1</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_1</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>
<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_83_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_83_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recordar la definición de <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#ciclofund"><span class="std std-ref">ciclo fundamental</span></a>.</p>
</div>
<p>Entonces se forma un ciclo no dirigido. La orientación del ciclo se hereda de la dirección del arco añadido, en este caso en sentido de las manecillas del reloj:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_1_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_1</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> <span class="n">edge_to_be_added_1</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;D&#39;): &#39;forward&#39;,
 (&#39;B&#39;, &#39;A&#39;): &#39;forward&#39;,
 (&#39;B&#39;, &#39;C&#39;): &#39;reverse&#39;,
 (&#39;C&#39;, &#39;E&#39;): &#39;reverse&#39;,
 (&#39;D&#39;, &#39;E&#39;): &#39;forward&#39;}
</pre></div>
</div>
</div>
</div>
<p>Se calcula el costo unitario de incrementar el flujo por una unidad. Para los “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges_and_weights_simplex_cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edges_and_weights_simplex_cycle_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;D&#39;): 9, (&#39;B&#39;, &#39;A&#39;): -2, (&#39;B&#39;, &#39;C&#39;): 3, (&#39;C&#39;, &#39;E&#39;): 1, (&#39;D&#39;, &#39;E&#39;): 3}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_1</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((A,C)\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_2</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_2</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_93_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_93_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_2_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_2</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> <span class="n">edge_to_be_added_2</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): &#39;forward&#39;,
 (&#39;A&#39;, &#39;D&#39;): &#39;reverse&#39;,
 (&#39;C&#39;, &#39;E&#39;): &#39;forward&#39;,
 (&#39;D&#39;, &#39;E&#39;): &#39;reverse&#39;}
</pre></div>
</div>
</div>
</div>
<p>Se calcula el costo unitario de incrementar el flujo por una unidad. Para los “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges_and_weights_simplex_cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edges_and_weights_simplex_cycle_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): 4, (&#39;A&#39;, &#39;D&#39;): 9, (&#39;B&#39;, &#39;C&#39;): 3, (&#39;C&#39;, &#39;E&#39;): 1, (&#39;D&#39;, &#39;E&#39;): 3}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_2</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-7.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((E,D)\)</span>:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_3</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_3</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_3</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>

<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;$flow^+$&quot;</span>
<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">][</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>

<span class="n">stri1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">stri2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span>
<span class="n">stri3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},{</span><span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]})</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">string_for_edges_trouble_to_visualize</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stri1</span><span class="p">,</span> <span class="n">stri2</span><span class="p">,</span> <span class="n">stri3</span><span class="p">])}</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                                 <span class="n">G_simplex_cycle_3</span><span class="p">,</span>
                                                 <span class="n">nodes_and_pos</span><span class="p">,</span>
                                                 <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                                 <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
                                                 <span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span>
                                                 <span class="n">edge_to_be_added_3</span><span class="p">,</span>
                                                 <span class="n">string_for_edges_trouble_to_visualize</span>
                                                 <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_101_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_101_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_3_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_3</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> <span class="n">edge_to_be_added_3</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;D&#39;, &#39;E&#39;): &#39;forward&#39;, (&#39;E&#39;, &#39;D&#39;): &#39;forward&#39;}
</pre></div>
</div>
</div>
</div>
<p>Se calcula el costo unitario de incrementar el flujo por una unidad. Para los “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edges_and_weights_simplex_cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edges_and_weights_simplex_cycle_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;D&#39;): 9, (&#39;B&#39;, &#39;C&#39;): 3, (&#39;C&#39;, &#39;E&#39;): 1, (&#39;D&#39;, &#39;E&#39;): 3, (&#39;E&#39;, &#39;D&#39;): 2}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_3</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p>En resúmen:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Arco</p></th>
<th class="text-align:center head"><p>Costo por incrementar una unidad de flujo en el arco</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>(B,A)</p></td>
<td class="text-align:center"><p>6</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(A,C)</p></td>
<td class="text-align:center"><p>-7</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(E,D)</p></td>
<td class="text-align:center"><p>5</p></td>
</tr>
</tbody>
</table>
<p>Entonces el arco no básico que tiene la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> es <span class="math notranslate nohighlight">\((A,C)\)</span>.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Si no hay arcos no básicos que mejoren <span class="math notranslate nohighlight">\(f_o\)</span> entonces la solución actual es óptima.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">edge_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;A&#39;, &#39;C&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="revision-de-cual-arco-basico-es-sustituido">
<h3>Revisión de cuál arco básico es sustituido<a class="headerlink" href="#revision-de-cual-arco-basico-es-sustituido" title="Permalink to this headline">¶</a></h3>
<p>Tomando la red que resultó de añadir el arco no básico al <em>spanning tree</em> solución factible, la revisión de cuál arco básico es sustituido se determina incrementando el flujo de la red lo más posible hasta que uno de los arcos básicos llege a su cota inferior o superior. Denotemos al incremento como la cantidad <span class="math notranslate nohighlight">\(\text{flow}^+\)</span> y para los arcos que son “forward” se suma tal cantidad al flujo actual y para los que son “reverse” se resta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_labels_simplex_cycle_2_with_flow_change</span> <span class="o">=</span> <span class="n">edge_label_change_for_basic_edge_subs</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> 
                                                                                     <span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span> 
                                                                                     <span class="n">edge_to_be_added_2</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edge_labels_simplex_cycle_2_with_flow_change</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): {&#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: &#39;$flow^+$&#39;, &#39;weight&#39;: 4},
 (&#39;A&#39;, &#39;D&#39;): {&#39;bool&#39;: &#39;-&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;40- $flow^+$&#39;,
              &#39;weight&#39;: 9},
 (&#39;B&#39;, &#39;C&#39;): {&#39;bool&#39;: 0, &#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: 50, &#39;weight&#39;: 3},
 (&#39;C&#39;, &#39;E&#39;): {&#39;bool&#39;: &#39;+&#39;, &#39;capacity&#39;: 80, &#39;flow&#39;: &#39;50+ $flow^+$&#39;, &#39;weight&#39;: 1},
 (&#39;D&#39;, &#39;E&#39;): {&#39;bool&#39;: &#39;-&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;10- $flow^+$&#39;,
              &#39;weight&#39;: 3}}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_114_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_114_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_2_with_flow_change</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_115_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_115_0.png" />
</div>
</div>
<p>Como se debe cumplir la no negatividad y la cota superior, para los arcos en los que se aumenta y tienen cota superior se tiene</p>
<div class="math notranslate nohighlight">
\[x_{CE} = 50 + \text{flow}^+ \leq 80\]</div>
<p>y para los arcos en los que se disminuye:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
x_{AD} = 40 - \text{flow}^+ &amp;\geq&amp; 0 \nonumber \\
x_{DE} = 10 - \text{flow}^+ &amp;\geq&amp; 0
\end{eqnarray}
\end{split}\]</div>
<p>Por lo que:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{eqnarray}
\text{flow}^+ &amp;\leq&amp; 30 \quad \text{que se obtuvo del arco } x_{CE} \nonumber \\
\text{flow}^+ &amp;\leq&amp; 40 \quad \text{que se obtuvo del arco } x_{AD} \nonumber \\
\text{flow}^+ &amp;\leq&amp; 10 \quad \text{que se obtuvo del arco } x_{DE} \nonumber
\end{eqnarray}
\end{split}\]</div>
<p>El mínimo es <span class="math notranslate nohighlight">\(10\)</span>, entonces <span class="math notranslate nohighlight">\(\text{flow}^+ = 10\)</span> y el arco básico que será sustituido es <span class="math notranslate nohighlight">\((D,E)\)</span>. Como su flujo llega a cero <strong>no</strong> lo guardamos en la red <code class="docutils literal notranslate"><span class="pre">G_simplex_edges_upper_bounds</span></code>.</p>
<p>El nuevo <em>spanning tree</em> solución factible es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flow_plus</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_remove_spanning_tree_2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">edge_to_add_spanning_tree_2</span> <span class="o">=</span> <span class="n">edge_to_be_added_2</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">edge_to_add_spanning_tree_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;A&#39;, &#39;C&#39;)
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se incrementa el flujo de la red únicamente en el ciclo por <span class="math notranslate nohighlight">\(\text{flow}^+ = 10\)</span> y se elimina el arco <span class="math notranslate nohighlight">\((D,E)\)</span>.</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_2_with_flow_change</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_128_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_128_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_spanning_tree_2</span> <span class="o">=</span> <span class="n">get_spanning_tree_from_spanning_tree_reference</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                                           <span class="n">edge_to_remove_spanning_tree_2</span><span class="p">,</span>
                                                                           <span class="n">edge_to_add_spanning_tree_2</span><span class="p">)</span>

<span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> <span class="n">edge_labels_simplex_spanning_tree_2</span> <span class="o">=</span> <span class="n">increase_flow_from_edge_labels_with_flow_change</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span>
                                                                                                                 <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span>
                                                                                                                 <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span>
                                                                                                                 <span class="n">edge_to_add_spanning_tree_2</span><span class="p">,</span>
                                                                                                                 <span class="n">edge_labels_simplex_cycle_2_with_flow_change</span><span class="p">)</span>
<span class="n">node_labels_simplex_spanning_tree_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                            <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>
<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_129_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_129_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="iteracion-siguiente">
<h2>Iteración siguiente<a class="headerlink" href="#iteracion-siguiente" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_131_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_131_0.png" />
</div>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_132_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_132_0.png" />
</div>
</div>
<p>Identificamos los arcos no básicos que son los que no están en el <em>spanning tree</em> solución factible que se obtuvo al final de la iteración anterior. En el margen se muestra la red de referencia y el <em>spanning tree</em> solución factible, entonces los arcos no básicos son <span class="math notranslate nohighlight">\((B, A), (D, E), (E,D)\)</span>.</p>
<div class="section" id="id1">
<h3>Revisión de cuál arco no básico sustituye a un arco básico<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p><strong>Arco <span class="math notranslate nohighlight">\((B, A)\)</span></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_1</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_1</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_1</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_137_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_137_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Recordar la definición de <a class="reference internal" href="../4.1/Definiciones_generales_de_flujo_en_redes.html#ciclofund"><span class="std std-ref">ciclo fundamental</span></a>.</p>
</div>
<p>Entonces se forma un ciclo no dirigido. Se calcula el costo unitario de incrementar el flujo por una unidad. Para los arcos “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_1_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_1</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> <span class="n">edge_to_be_added_1</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_1</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((D, E)\)</span></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_2</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_2</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_143_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_143_0.png" />
</div>
</div>
<p>Entonces se forma un ciclo no dirigido. Se calcula el costo unitario de incrementar el flujo por una unidad. Para los arcos “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_2_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_2</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> <span class="n">edge_to_be_added_2</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_2</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7.0
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((E, D)\)</span></strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_3</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_3</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_3</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_2</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_3</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_148_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_148_0.png" />
</div>
</div>
<p>Entonces se forma un ciclo no dirigido. Se calcula el costo unitario de incrementar el flujo por una unidad. Para los arcos “forward” se suma y para los “reverse” se restan los costos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_3_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_3</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> <span class="n">edge_to_be_added_3</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_3</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-2.0
</pre></div>
</div>
</div>
</div>
<p>En resúmen:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Arco</p></th>
<th class="text-align:center head"><p>Costo por incrementar una unidad de flujo en el arco</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>(B,A)</p></td>
<td class="text-align:center"><p>-1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(D,E)</p></td>
<td class="text-align:center"><p>7</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(E,D)</p></td>
<td class="text-align:center"><p>-2</p></td>
</tr>
</tbody>
</table>
<p>Entonces el arco no básico que tiene la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> es <span class="math notranslate nohighlight">\((E,D)\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Si no hay arcos no básicos que mejoren <span class="math notranslate nohighlight">\(f_o\)</span> entonces la solución actual es óptima.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">edge_to_be_added_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;E&#39;, &#39;D&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Revisión de cuál arco básico es sustituido<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Tomando la red que resultó de añadir el arco no básico al <em>spanning tree</em> solución factible, se determina incrementando el flujo de la red lo más posible hasta que uno de los arcos básicos llege a su cota inferior o superior.
Se denota como la cantidad <span class="math notranslate nohighlight">\(flow^+\)</span> y para los arcos que son “forward” se suma tal cantidad al flujo actual y para los que son “reverse” se resta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_labels_simplex_cycle_3_with_flow_change</span> <span class="o">=</span> <span class="n">edge_label_change_for_basic_edge_subs</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> 
                                                                                     <span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span> 
                                                                                     <span class="n">edge_to_be_added_3</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edge_labels_simplex_cycle_3_with_flow_change</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): {&#39;bool&#39;: &#39;+&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;10+ $flow^+$&#39;,
              &#39;weight&#39;: 4},
 (&#39;A&#39;, &#39;D&#39;): {&#39;bool&#39;: &#39;-&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;30- $flow^+$&#39;,
              &#39;weight&#39;: 9},
 (&#39;B&#39;, &#39;C&#39;): {&#39;bool&#39;: 0, &#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: 50, &#39;weight&#39;: 3},
 (&#39;C&#39;, &#39;E&#39;): {&#39;bool&#39;: &#39;+&#39;, &#39;capacity&#39;: 80, &#39;flow&#39;: &#39;60+ $flow^+$&#39;, &#39;weight&#39;: 1},
 (&#39;E&#39;, &#39;D&#39;): {&#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: &#39;$flow^+$&#39;, &#39;weight&#39;: 2}}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_3</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_158_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_158_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_3</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_3_with_flow_change</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_159_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_159_0.png" />
</div>
</div>
<p>Como se debe cumplir la no negatividad y la cota superior, para los arcos en los que se aumenta y tienen cota superior se tiene:</p>
<div class="math notranslate nohighlight">
\[
x_{CE} = 60 + \text{flow}^+ \leq 80
\]</div>
<p>y para los arcos en los que se disminuye:</p>
<div class="math notranslate nohighlight">
\[
x_{AD} = 30 - \text{flow}^+ \geq 0
\]</div>
<p>Por lo que:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\text{flow}^+ &amp;\leq&amp; 20 \quad \text{que se obtuvo del arco } x_{CE} \nonumber \\
\text{flow}^+ &amp;\leq&amp; 30 \quad \text{que se obtuvo del arco } x_{AD} \nonumber \\
\end{eqnarray}
\end{split}\]</div>
<p>El mínimo es 20, entonces <span class="math notranslate nohighlight">\(\text{flow}^+=20\)</span> y el arco básico que será sustituido es <span class="math notranslate nohighlight">\((C,E)\)</span>.</p>
</div>
<div class="section" id="id3">
<h3>Técnica de la cota superior<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>Al modificar el flujo con <span class="math notranslate nohighlight">\(\text{flow}^+=20\)</span> se tiene que el arco <span class="math notranslate nohighlight">\((C,E)\)</span> tiene un flujo igual a <span class="math notranslate nohighlight">\(80\)</span> con lo que llegó a su capacidad máxima. Entonces se intercambia el arco <span class="math notranslate nohighlight">\((C, E)\)</span> por el arco <span class="math notranslate nohighlight">\((E, C)\)</span> con costo unitario igual al negativo de <span class="math notranslate nohighlight">\((C, E)\)</span>, misma capacidad y con flujo igual igual <span class="math notranslate nohighlight">\(0\)</span>. Surge una nueva variable no básica <span class="math notranslate nohighlight">\(y_{CE} = 0\)</span> y <span class="math notranslate nohighlight">\(x_{CE} = 80 - y_{CE}\)</span>. <span class="math notranslate nohighlight">\(b_E\)</span> se le aumenta <span class="math notranslate nohighlight">\(80\)</span> y <span class="math notranslate nohighlight">\(b_C\)</span> se le resta <span class="math notranslate nohighlight">\(80\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_remove_from_network</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">edge_to_add_new_network</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex2</span><span class="p">,</span><span class="n">edge_labels_simplex2</span> <span class="o">=</span> <span class="n">get_new_network_after_upper_bound_technique</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="n">edge_to_remove_from_network</span><span class="p">,</span>
                                                                              <span class="n">edge_to_add_new_network</span><span class="p">)</span>

<span class="n">node_labels_simplex</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">string_for_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span>

<span class="n">list_of_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span>


<span class="n">node_labels_simplex2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex2</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex2</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_169_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_169_0.png" />
</div>
</div>
<p>Para futura referencia el arco <span class="math notranslate nohighlight">\((C,E)\)</span> que alcanzó la cota superior lo guardamos en la red <code class="docutils literal notranslate"><span class="pre">G_simplex_edges_upper_bounds</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_in_graph_of_upper_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">edge_to_be_added_in_graph_of_upper_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">edge_to_be_added_in_graph_of_upper_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">G_simplex_edges_upper_bounds</span> <span class="o">=</span> <span class="n">add_edge_to_graph_of_upper_bounds</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span>
                                                                 <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
                                                                 <span class="n">edge_to_be_added_in_graph_of_upper_bounds</span><span class="p">,</span>
                                                                 <span class="n">edge_labels_simplex_upper_bounds</span><span class="p">)</span>

<span class="n">node_labels_simplex_upper_bounds</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_upper_bounds</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_upper_bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_172_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_172_0.png" />
</div>
</div>
<p>El nuevo <em>spanning tree</em> factible es:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flow_plus</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_remove_spanning_tree_3</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">edge_to_add_spanning_tree_3</span> <span class="o">=</span> <span class="n">edge_to_be_added_3</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">edge_to_add_spanning_tree_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;E&#39;, &#39;D&#39;)
</pre></div>
</div>
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se incrementa el flujo de la red únicamente en el ciclo por <span class="math notranslate nohighlight">\(\text{flow}^+ = 20\)</span> y se elimina el arco <span class="math notranslate nohighlight">\((C,E)\)</span>.</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_3</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_2</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_3_with_flow_change</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_178_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_178_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_spanning_tree_3</span> <span class="o">=</span> <span class="n">get_spanning_tree_from_spanning_tree_reference</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span> 
                                                                           <span class="n">edge_to_remove_spanning_tree_3</span><span class="p">,</span>
                                                                           <span class="n">edge_to_add_spanning_tree_3</span><span class="p">)</span>

<span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> <span class="n">edge_labels_simplex_spanning_tree_3</span> <span class="o">=</span> <span class="n">increase_flow_from_edge_labels_with_flow_change</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span>
                                                                                                                 <span class="n">G_simplex_spanning_tree_2</span><span class="p">,</span>
                                                                                                                 <span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span>
                                                                                                                 <span class="n">edge_to_add_spanning_tree_3</span><span class="p">,</span>
                                                                                                                 <span class="n">edge_labels_simplex_cycle_3_with_flow_change</span><span class="p">)</span>
<span class="n">value_capacity</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="n">edge_to_remove_from_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_remove_from_network</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
<span class="n">update_netflows_after_upper_bound_technique</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span>
                                            <span class="n">value_capacity</span><span class="p">,</span>
                                            <span class="n">edge_to_remove_from_network</span><span class="p">)</span>
<span class="n">node_labels_simplex_spanning_tree_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> 
                                                            <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>
<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_179_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_179_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>Iteración siguiente<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_margin tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex2</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex2</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_181_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_181_0.png" />
</div>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_182_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_182_0.png" />
</div>
</div>
<p>Identificamos los arcos no básicos que son los que no están en el <em>spanning tree</em> solución factible que se obtuvo al final de la iteración anterior. En el margen se muestra la red y el <em>spanning tree</em> solución factible, entonces los arcos no básicos son <span class="math notranslate nohighlight">\((B,A), (E,C), (D,E)\)</span>.</p>
<div class="section" id="id5">
<h3>Revisión de cuál arco no básico sustituye a un arco básico<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p><strong>Arco <span class="math notranslate nohighlight">\((B, A)\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_1</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_1</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_1</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">)</span>


<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_187_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_187_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_1_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_1</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> <span class="n">edge_to_be_added_1</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_1</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-1.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((E, C)\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_2</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_2</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_191_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_191_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_2_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_2</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> <span class="n">edge_to_be_added_2</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_2</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((D, E)\)</span></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_3</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_3</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_3</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">)</span>


<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_3</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s1">&#39;D&#39;</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>


<span class="n">stri1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">stri2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span>
<span class="n">stri3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},{</span><span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]})</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">string_for_edges_trouble_to_visualize</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stri1</span><span class="p">,</span> <span class="n">stri2</span><span class="p">,</span> <span class="n">stri3</span><span class="p">])}</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                                 <span class="n">G_simplex_cycle_3</span><span class="p">,</span>
                                                 <span class="n">nodes_and_pos</span><span class="p">,</span>
                                                 <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                                 <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
                                                 <span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span>
                                                 <span class="n">edge_to_be_added_3</span><span class="p">,</span>
                                                 <span class="n">string_for_edges_trouble_to_visualize</span>
                                                 <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_195_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_195_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_3_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_3</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> <span class="n">edge_to_be_added_3</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_3</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p>En resúmen:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Arco</p></th>
<th class="text-align:center head"><p>Costo por incrementar una unidad de flujo en el arco</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>(B,A)</p></td>
<td class="text-align:center"><p>-1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(E,C)</p></td>
<td class="text-align:center"><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(D,E)</p></td>
<td class="text-align:center"><p>5</p></td>
</tr>
</tbody>
</table>
<p>Entonces el arco no básico que tiene la tasa más alta de mejoramiento de <span class="math notranslate nohighlight">\(f_o\)</span> es <span class="math notranslate nohighlight">\((B,A)\)</span>.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Si no hay arcos no básicos que mejoren <span class="math notranslate nohighlight">\(f_o\)</span> entonces la solución actual es óptima.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">edge_to_be_added_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;B&#39;, &#39;A&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id6">
<h3>Revisión de cuál arco básico es sustituido<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Se denota como la cantidad <span class="math notranslate nohighlight">\(\text{flow}^+\)</span> y para los arcos que son “forward” se suma tal cantidad al flujo actual y para los que son “reverse” se resta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_labels_simplex_cycle_1_with_flow_change</span> <span class="o">=</span> <span class="n">edge_label_change_for_basic_edge_subs</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> 
                                                                                     <span class="n">edge_labels_simplex_cycle_1</span><span class="p">,</span>
                                                                                     <span class="n">edge_to_be_added_1</span><span class="p">)</span>
<span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">edge_labels_simplex_cycle_1_with_flow_change</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(&#39;A&#39;, &#39;C&#39;): {&#39;bool&#39;: &#39;+&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;30+ $flow^+$&#39;,
              &#39;weight&#39;: 4},
 (&#39;A&#39;, &#39;D&#39;): {&#39;bool&#39;: 0, &#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: 10, &#39;weight&#39;: 9},
 (&#39;B&#39;, &#39;A&#39;): {&#39;capacity&#39;: 10, &#39;flow&#39;: &#39;$flow^+$&#39;, &#39;weight&#39;: -2},
 (&#39;B&#39;, &#39;C&#39;): {&#39;bool&#39;: &#39;-&#39;,
              &#39;capacity&#39;: &#39;inf&#39;,
              &#39;flow&#39;: &#39;50- $flow^+$&#39;,
              &#39;weight&#39;: 3},
 (&#39;E&#39;, &#39;D&#39;): {&#39;bool&#39;: 0, &#39;capacity&#39;: &#39;inf&#39;, &#39;flow&#39;: 20, &#39;weight&#39;: 2}}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_204_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_204_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_1_with_flow_change</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_205_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_205_0.png" />
</div>
</div>
<p>Como se debe cumplir la no negatividad y la cota superior, para los arcos en los que se aumenta y tienen cota superior se tiene:</p>
<div class="math notranslate nohighlight">
\[y_{AB} = \text{flow}^+ \leq 10\]</div>
<p>y para los arcos en los que se disminuye:</p>
<div class="math notranslate nohighlight">
\[x_{BC} = 50 - \text{flow}^+ \geq 0\]</div>
<p>Por lo que:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\text{flow}^+ \leq 10 \quad \text{que se obtuvo del arco } y_{AB} \nonumber \\
\text{flow}^+ \leq 50 \quad \text{que se obtuvo del arco } x_{BC} 
\end{eqnarray}
\end{split}\]</div>
<p>El mínimo es <span class="math notranslate nohighlight">\(10\)</span>, entonces <span class="math notranslate nohighlight">\(\text{flow}^+=10\)</span> y el arco que será sustituido es <span class="math notranslate nohighlight">\((B, A)\)</span>.</p>
</div>
<div class="section" id="id7">
<h3>Técnica de la cota superior<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Al modificar el flujo con <span class="math notranslate nohighlight">\(\text{flow}^+=10\)</span> se tiene que el arco <span class="math notranslate nohighlight">\((B,A)\)</span> tiene un flujo igual a <span class="math notranslate nohighlight">\(10\)</span> con lo que llegó a su capacidad máxima. Entonces se intercambia el arco <span class="math notranslate nohighlight">\((B,A)\)</span> por el arco <span class="math notranslate nohighlight">\((A,B)\)</span> con costo unitario igual al negativo de <span class="math notranslate nohighlight">\((B,A)\)</span>, misma capacidad y con flujo igual igual 0. Las asignaciones en las variables son <span class="math notranslate nohighlight">\(y_{AB}=10\)</span> y <span class="math notranslate nohighlight">\(x_{AB} = 10 - y_{AB} = 10 - 10 = 0\)</span>. <span class="math notranslate nohighlight">\(b_A\)</span> se le aumenta <span class="math notranslate nohighlight">\(10\)</span> y <span class="math notranslate nohighlight">\(b_B\)</span> se le resta <span class="math notranslate nohighlight">\(10\)</span>.</p>
<div class="admonition-comentario admonition">
<p class="admonition-title">Comentario</p>
<p>Una variable nueva que se haya añadido por la técnica de la cota superior que alcance un valor igual a su capacidad puede eliminarse. En este caso <span class="math notranslate nohighlight">\(y_{AB} = 10\)</span> por lo que alcanzó un flujo igual a su capacidad y puede eliminarse.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_remove_from_network</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">edge_to_add_new_network</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex3</span><span class="p">,</span><span class="n">edge_labels_simplex3</span> <span class="o">=</span> <span class="n">get_new_network_after_upper_bound_technique</span><span class="p">(</span><span class="n">G_simplex2</span><span class="p">,</span> <span class="n">edge_to_remove_from_network</span><span class="p">,</span>
                                                                              <span class="n">edge_to_add_new_network</span><span class="p">)</span>

<span class="n">node_labels_simplex</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex3</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">string_for_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span>

<span class="n">list_of_edges_trouble_to_visualize_simplex</span> <span class="o">=</span> <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span>


<span class="n">node_labels_simplex3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex3</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex3</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex3</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_217_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_217_0.png" />
</div>
</div>
<p><strong>También recuérdese que el arco <span class="math notranslate nohighlight">\((A, B)\)</span> tenía flujo <span class="math notranslate nohighlight">\(x_{AB}\)</span> igual a su capacidad</strong>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][</span><span class="s1">&#39;B&#39;</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10
</pre></div>
</div>
</div>
</div>
<p>Como el arco <span class="math notranslate nohighlight">\((A,B)\)</span> después de la actualización ahora tiene un flujo igual a cero se quita de la red <code class="docutils literal notranslate"><span class="pre">G_simplex_edges_upper_bounds</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_removed_in_graph_of_upper_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">edge_to_be_removed_in_graph_of_upper_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                         <span class="n">edge_to_be_removed_in_graph_of_upper_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">edge_to_be_removed_in_graph_of_upper_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="n">edge_to_be_removed_in_graph_of_upper_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">edge_labels_simplex_upper_bounds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">edge_to_be_removed_in_graph_of_upper_bounds</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;weight&#39;: 2, &#39;capacity&#39;: 10, &#39;flow&#39;: 10}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node_labels_simplex_upper_bounds</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">node_labels_simplex_upper_bounds</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_upper_bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_222_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_222_0.png" />
</div>
</div>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><em>Spanning tree</em> solución factible anterior dado que el arco que entra es el mismo que sale.</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_224_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_224_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flow_plus</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_remove_spanning_tree_4</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">edge_to_add_spanning_tree_4</span> <span class="o">=</span> <span class="n">edge_to_be_added_1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">edge_to_add_spanning_tree_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;B&#39;, &#39;A&#39;)
</pre></div>
</div>
</div>
</div>
<p>Como el arco que entra es el mismo que sale … sólo se incrementa el flujo de acuerdo al análisis previo para el <em>spanning tree</em> solución factible anterior el cual se muestra en el margen.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Se incrementa el flujo de la red únicamente en el ciclo por <span class="math notranslate nohighlight">\(\text{flow}^+ = 10\)</span> y se elimina el arco <span class="math notranslate nohighlight">\((B,A)\)</span>.</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_3</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_1_with_flow_change</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_230_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_230_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_spanning_tree_4</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span> <span class="n">edge_labels_simplex_spanning_tree_4</span> <span class="o">=</span> <span class="n">increase_flow_from_edge_labels_with_flow_change</span><span class="p">(</span><span class="n">G_simplex3</span><span class="p">,</span>
                                                                                                                 <span class="n">G_simplex_spanning_tree_3</span><span class="p">,</span>
                                                                                                                 <span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span>
                                                                                                                 <span class="n">edge_to_add_spanning_tree_4</span><span class="p">,</span>
                                                                                                                 <span class="n">edge_labels_simplex_cycle_1_with_flow_change</span><span class="p">)</span>

<span class="n">value_capacity</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="p">[</span><span class="n">edge_to_remove_from_network</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_remove_from_network</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
<span class="n">update_netflows_after_upper_bound_technique</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span>
                                            <span class="n">value_capacity</span><span class="p">,</span>
                                            <span class="n">edge_to_remove_from_network</span><span class="p">)</span>

<span class="n">node_labels_simplex_spanning_tree_4</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span> 
                                                            <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_4</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_231_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_231_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="id8">
<h2>Iteración siguiente<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex3</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex3</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_233_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_233_0.png" />
</div>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_4</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_234_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_234_0.png" />
</div>
</div>
<p>Identificamos los arcos no básicos que son los que no están en el <em>spanning tree</em> solución factible que se obtuvo al final de la iteración anterior. En el margen se muestra la red y el <em>spanning tree</em> solución factible, entonces los arcos no básicos son <span class="math notranslate nohighlight">\((A,B), (E,C), (D, E)\)</span>.</p>
<div class="section" id="id9">
<h3>Revisión de cuál arco no básico sustituye a un arco básico<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p><strong>Arco <span class="math notranslate nohighlight">\((A,B)\)</span>.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_1</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_1</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex3</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_1</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_4</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_4</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_1</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_239_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_239_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_1_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_1</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> <span class="n">edge_to_be_added_1</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_1</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_1_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_1</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((E,C)\)</span>.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_2</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_2</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex3</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_2</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_4</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">plot_graph_with_cycle</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">nodes_and_pos</span><span class="p">,</span>
                      <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                      <span class="n">node_labels_simplex_spanning_tree_4</span><span class="p">,</span>
                      <span class="n">edge_labels_simplex_cycle_2</span><span class="p">,</span>
                      <span class="n">edge_to_be_added_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_243_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_243_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_2_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_2</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> <span class="n">edge_to_be_added_2</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_2</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_2</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_2_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_2</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.0
</pre></div>
</div>
</div>
</div>
<p><strong>Arco <span class="math notranslate nohighlight">\((D,E)\)</span>.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added_3</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">edge_labels_simplex_cycle_3</span> <span class="o">=</span> <span class="n">add_edge_from_spanning_tree</span><span class="p">(</span><span class="n">G_simplex3</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span> 
                                                                             <span class="n">edge_to_be_added_3</span><span class="p">,</span>
                                                                             <span class="n">edge_labels_simplex_spanning_tree_4</span><span class="p">)</span>

<span class="n">n1</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_4</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="s1">&#39;D&#39;</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
<span class="n">n2</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>


<span class="n">stri1</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">n1</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]},)</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">stri2</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\n\n</span><span class="s1">&#39;</span>
<span class="n">stri3</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">({</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]},</span> <span class="p">{</span><span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;capacity&quot;</span><span class="p">]},{</span><span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">n2</span><span class="p">[</span><span class="s2">&quot;flow&quot;</span><span class="p">]})</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">string_for_edges_trouble_to_visualize</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">):</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stri1</span><span class="p">,</span> <span class="n">stri2</span><span class="p">,</span> <span class="n">stri3</span><span class="p">])}</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_cycle_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                                 <span class="n">G_simplex_cycle_3</span><span class="p">,</span>
                                                 <span class="n">nodes_and_pos</span><span class="p">,</span>
                                                 <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                                 <span class="n">node_labels_simplex_spanning_tree_4</span><span class="p">,</span>
                                                 <span class="n">edge_labels_simplex_cycle_3</span><span class="p">,</span>
                                                 <span class="n">edge_to_be_added_3</span><span class="p">,</span>
                                                 <span class="n">string_for_edges_trouble_to_visualize</span>
                                                 <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_247_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_247_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">find_cycle</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="n">cycle_3_d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span> <span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cycle_3</span><span class="p">}</span>
<span class="n">fix_orientation</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> <span class="n">edge_to_be_added_3</span><span class="p">)</span>

<span class="n">edges_and_weights_simplex_cycle_3</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_edge_attributes</span><span class="p">(</span><span class="n">G_simplex_cycle_3</span><span class="p">,</span> <span class="s2">&quot;weight&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">compute_cost_for_unit_increment</span><span class="p">(</span><span class="n">cycle_3_d</span><span class="p">,</span> 
                                             <span class="n">edges_and_weights_simplex_cycle_3</span><span class="p">))</span>
     <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.0
</pre></div>
</div>
</div>
</div>
<p>En resúmen:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Arco</p></th>
<th class="text-align:center head"><p>Costo por incrementar una unidad de flujo en el arco</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>(A,B)</p></td>
<td class="text-align:center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>(E,C)</p></td>
<td class="text-align:center"><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-align:center"><p>(D,E)</p></td>
<td class="text-align:center"><p>5</p></td>
</tr>
</tbody>
</table>
<p>Entonces no hay arcos no básicos que mejoren a <span class="math notranslate nohighlight">\(f_o\)</span> por lo que la solución actual es óptima.</p>
</div>
</div>
<div class="section" id="finalizando-el-ejemplo">
<h2>Finalizando el ejemplo<a class="headerlink" href="#finalizando-el-ejemplo" title="Permalink to this headline">¶</a></h2>
<p>La solución BF óptima corresponde al <em>spanning tree</em> solución factible dado por:</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_4</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_4</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_253_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_253_0.png" />
</div>
</div>
<p>LLegando a este punto debemos comparar la red original que tiene los arcos originales y la última red que debido a la técnica de la cota superior cambió a tales arcos. Se presenta a continuación la última red y en el margen a la red original.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p>Red original del problema:</p>
</div>
<div class="cell tag_hide-input tag_margin docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_min_cost_flow</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_min_cost_flow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_256_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_256_0.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">plot_graph_with_edges_trouble_to_visualize</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span>
                                           <span class="n">G_simplex3</span><span class="p">,</span> <span class="n">nodes_and_pos</span><span class="p">,</span>
                                           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
                                           <span class="n">node_labels_simplex3</span><span class="p">,</span>
                                           <span class="n">string_for_edges_trouble_to_visualize_simplex</span><span class="p">,</span>
                                           <span class="n">list_of_edges_trouble_to_visualize_simplex</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_257_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_257_0.png" />
</div>
</div>
<p>Hay que revisar las redes anteriores y el último <em>spanning tree</em> solución factible con el objetivo de: incluir en el <em>spanning tree</em> solución factible aquellos arcos que sean arcos con flujo igual a su cota superior y que pertenezcan a la red original. Tales arcos que serán incluidos tendrán un flujo igual a su capacidad <strong>menos</strong> los valores de los arcos inversos que se produjeron por la técnica de la cota superior.</p>
<p>Para lo anterior podemos consultar <code class="docutils literal notranslate"><span class="pre">G_simplex_edges_upper_bounds</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">node_labels_simplex_upper_bounds</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_upper_bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_260_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_260_0.png" />
</div>
</div>
<p>Observamos que todos los arcos conservan su dirección original salvo el <span class="math notranslate nohighlight">\((C,E)\)</span> que fue cambiado por <span class="math notranslate nohighlight">\((E,C)\)</span>. Como se tiene la relación: <span class="math notranslate nohighlight">\(y_{CE} = 80 - x_{CE}\)</span> y <span class="math notranslate nohighlight">\(y_{CE}\)</span> es un arco no básico con valor de <span class="math notranslate nohighlight">\(0\)</span> entonces: <span class="math notranslate nohighlight">\(y_{CE} = 0\)</span> y <span class="math notranslate nohighlight">\(x_{CE}=80\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;C&#39;, &#39;E&#39;, {&#39;weight&#39;: 1, &#39;capacity&#39;: 80, &#39;flow&#39;: 80})]
</pre></div>
</div>
</div>
</div>
<p>por lo que la red final queda (omitiendo arcos con flujo igual a cero):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_to_be_added</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_4</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_4</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">G_simplex_4</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">edge_labels_simplex_4</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_simplex_spanning_tree_4</span><span class="p">)</span>

<span class="n">edge_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">]</span><span class="o">=</span><span class="p">{}</span>

<span class="n">edge_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="n">edge_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>

<span class="n">edge_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>


<span class="n">G_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="n">G_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
<span class="n">G_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> 


<span class="n">node_labels_simplex_4</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_4</span><span class="p">,</span> 
                                               <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">node_attributes_upper_bounds</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">node_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">node_attributes_upper_bounds</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="n">node_labels_simplex_4</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">node_attributes_upper_bounds</span><span class="p">[</span><span class="n">edge_to_be_added</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_4</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_4</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_265_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_265_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">G_simplex_4</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[(&#39;A&#39;, &#39;D&#39;, {&#39;capacity&#39;: &#39;inf&#39;, &#39;weight&#39;: 9, &#39;flow&#39;: 10}), (&#39;A&#39;, &#39;C&#39;, {&#39;flow&#39;: 40, &#39;weight&#39;: 4, &#39;capacity&#39;: &#39;inf&#39;}), (&#39;B&#39;, &#39;C&#39;, {&#39;capacity&#39;: &#39;inf&#39;, &#39;weight&#39;: 3, &#39;flow&#39;: 40}), (&#39;C&#39;, &#39;E&#39;, {&#39;weight&#39;: 1, &#39;capacity&#39;: 80, &#39;flow&#39;: 80}), (&#39;E&#39;, &#39;D&#39;, {&#39;flow&#39;: 20, &#39;weight&#39;: 2, &#39;capacity&#39;: &#39;inf&#39;})]
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicio</p>
<p>Resuelve el siguiente problema de flujo con costo mínimo visualizando cada paso del método símplex de redes como el ejemplo anterior y muestra la red solución.</p>
</div>
<p><strong>Red original:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes_pos</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.09090909090909091</span><span class="p">,</span> <span class="mf">0.5454545454545454</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.2727272727272727</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.2727272727272727</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.7272727272727273</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.5454545454545454</span><span class="p">,</span> <span class="mf">0.2727272727272727</span><span class="p">],</span>
             <span class="p">[</span><span class="mf">0.8181818181818182</span><span class="p">,</span> <span class="mf">0.5454545454545454</span><span class="p">]]</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">nodes_and_pos</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">nodes_pos</span><span class="p">))</span>

<span class="n">G_min_cost_flow</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">9</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;1 [9]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;2 [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;3 [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;4 [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>  <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;5 [0]&quot;</span><span class="p">)</span>
<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">netflow</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="n">node_and_netflow</span><span class="o">=</span><span class="s2">&quot;6 [-9]&quot;</span><span class="p">)</span>


<span class="n">edge_labels_min_cost_flow</span> <span class="o">=</span> <span class="p">{(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span>
                             <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
                             <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
                             <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
                             <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
                             <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span>
                             <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
                             <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
                             <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span> <span class="p">{</span><span class="s2">&quot;weight&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;capacity&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
                            <span class="p">}</span>

<span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">edge_labels_min_cost_flow</span><span class="p">)</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    <span class="n">G_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>

<span class="n">nodes_and_pos_modified</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">nodes_and_pos</span><span class="p">)</span>

<span class="n">node_labels_min_cost_flow</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">y_off</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="n">x_off</span> <span class="o">=</span> <span class="mf">0.04</span>

<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x_off</span><span class="p">,</span> 
                                        <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                            <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_off</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">or</span> <span class="n">node</span> <span class="o">==</span><span class="mi">5</span><span class="p">:</span>
                <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
                                                <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">y_off</span><span class="p">]</span>  
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_off</span><span class="p">,</span> 
                                                <span class="n">nodes_and_pos_modified</span><span class="p">[</span><span class="n">node</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>                

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_min_cost_flow</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_min_cost_flow</span><span class="p">,</span>
           <span class="n">edge_labels_min_cost_flow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_269_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_269_0.png" />
</div>
</div>
<p>Supóngase que en alguna iteración se aplicó la técnica de la cota superior a más de un arco por lo que la red modificada quedó como sigue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_inverse1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">edge_inverse2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">edge_inverse3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="n">tuple_edges_inverse</span> <span class="o">=</span> <span class="p">(</span><span class="n">edge_inverse1</span><span class="p">,</span> <span class="n">edge_inverse2</span><span class="p">,</span> <span class="n">edge_inverse3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex</span> <span class="o">=</span> <span class="n">G_min_cost_flow</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">G_simplex</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">G_simplex</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">G_simplex</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tuple_edges_inverse</span><span class="p">:</span>
    <span class="n">G_simplex</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">list_edges_simplex</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">edge_labels_simplex</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_simplex</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">e</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tuple_edges_inverse</span><span class="p">:</span>
        <span class="n">edge_labels_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_min_cost_flow</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
        
        
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tuple_edges_inverse</span><span class="p">:</span>
    <span class="n">edge_labels_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">edge_labels_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">edge_labels_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_min_cost_flow</span><span class="p">[(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>
    

<span class="n">new_netflow_1</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">new_netflow_2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">new_netflow_3</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">new_netflow_4</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>
<span class="n">new_netflow_5</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">new_netflow_6</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>

<span class="n">node_and_netflow_1</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_1</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
<span class="n">node_and_netflow_2</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_2</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
<span class="n">node_and_netflow_3</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_3</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
<span class="n">node_and_netflow_4</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_4</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
<span class="n">node_and_netflow_5</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;5&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_5</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>
<span class="n">node_and_netflow_6</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;6&#39;</span><span class="p">,</span> <span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">new_netflow_6</span><span class="p">),</span><span class="s1">&#39;]&#39;</span><span class="p">])</span>

    
<span class="n">nx</span><span class="o">.</span><span class="n">set_node_attributes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_1</span><span class="p">,</span>
                                       <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">node_and_netflow_1</span><span class="p">},</span>
                                   <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_2</span><span class="p">,</span>
                                       <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">node_and_netflow_2</span><span class="p">},</span>
                                   <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_3</span><span class="p">,</span>
                                      <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">node_and_netflow_3</span><span class="p">},</span>
                                   <span class="mi">4</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_4</span><span class="p">,</span>
                                      <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">node_and_netflow_4</span><span class="p">},</span>
                                   <span class="mi">5</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_5</span><span class="p">,</span>
                                      <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">node_and_netflow_5</span><span class="p">},</span>
                                   <span class="mi">6</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;netflow&quot;</span><span class="p">:</span> <span class="n">new_netflow_6</span><span class="p">,</span>
                                      <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">:</span> <span class="n">node_and_netflow_6</span><span class="p">}})</span>



<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_simplex</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span> <span class="o">=</span>   <span class="n">edge_labels_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
    <span class="n">G_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;capacity&quot;</span><span class="p">]</span>


<span class="n">node_labels_simplex</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex</span><span class="p">,</span> 
                                             <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex</span><span class="p">,</span>
           <span class="n">edge_labels_simplex</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_272_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_272_0.png" />
</div>
</div>
<p>Utilizar el siguiente <em>spanning tree</em> solución factible inicial:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">tuple_edges_inverse</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tuple_edges_inverse</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
<span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="n">tuple_edges_inverse</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">tuple_edges_inverse</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>


<span class="n">node_labels_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span> 
                                                             <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>
<span class="n">list_edges_spanning_tree_1</span> <span class="o">=</span> <span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">edge_labels_simplex_spanning_tree_1</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_spanning_tree_1</span><span class="p">:</span>
    <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
    
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">G_simplex_spanning_tree_1</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
    <span class="n">G_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span>
        
<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_spanning_tree_1</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_simplex_spanning_tree_1</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_spanning_tree_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_274_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_274_0.png" />
</div>
</div>
<p>Y el siguiente conjunto de <em>nontree arcs</em> del <em>spanning tree</em> solución factible anterior:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G_non_tree_arcs_1</span> <span class="o">=</span> <span class="n">G_simplex</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">G_non_tree_arcs_1</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">G_non_tree_arcs_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">G_non_tree_arcs_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">G_non_tree_arcs_1</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">list_edges_non_tree_arcs</span> <span class="o">=</span> <span class="n">G_non_tree_arcs_1</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>

<span class="n">edge_labels_non_tree_arcs</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">list_edges_non_tree_arcs</span><span class="p">:</span>
    <span class="n">edge_labels_non_tree_arcs</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_simplex</span><span class="p">[</span><span class="n">e</span><span class="p">])</span>
    <span class="n">edge_labels_non_tree_arcs</span><span class="p">[</span><span class="n">e</span><span class="p">][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        

<span class="n">edge_labels_non_tree_arcs</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_simplex</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="n">edge_labels_non_tree_arcs</span><span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">edge_labels_simplex</span><span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>
<span class="n">edge_labels_non_tree_arcs</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">edge_labels_non_tree_arcs</span><span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)][</span><span class="s2">&quot;flow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>    
    
<span class="n">node_labels_non_tree_arcs</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_non_tree_arcs_1</span><span class="p">,</span> 
                                                   <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>
    
<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_non_tree_arcs_1</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos_modified</span><span class="p">,</span>
           <span class="n">node_labels_non_tree_arcs</span><span class="p">,</span>
           <span class="n">edge_labels_non_tree_arcs</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_276_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_276_0.png" />
</div>
</div>
<p>Los arcos que tienen un flujo igual al valor de sus cotas superiores son: <span class="math notranslate nohighlight">\((1,3), (3, 5), (4, 6)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tuple_edges_in_upper_bounds</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edge_labels_simplex_upper_bounds</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">G_simplex_edges_upper_bounds</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">tuple_edges_in_upper_bounds</span><span class="p">:</span>
    <span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">G_simplex_edges_upper_bounds</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="n">G_simplex_edges_upper_bounds</span> <span class="o">=</span> <span class="n">add_edge_to_graph_of_upper_bounds</span><span class="p">(</span><span class="n">G_min_cost_flow</span><span class="p">,</span>
                                                                     <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
                                                                     <span class="n">e</span><span class="p">,</span>
                                                                     <span class="n">edge_labels_simplex_upper_bounds</span><span class="p">)</span>
    
<span class="n">node_labels_simplex_upper_bounds</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span> <span class="s2">&quot;node_and_netflow&quot;</span><span class="p">)</span>

<span class="n">figsize_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plot_graph</span><span class="p">(</span><span class="n">figsize_tuple</span><span class="p">,</span> <span class="n">G_simplex_edges_upper_bounds</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">nodes_and_pos</span><span class="p">,</span>
           <span class="n">node_labels_simplex_upper_bounds</span><span class="p">,</span>
           <span class="n">edge_labels_simplex_upper_bounds</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/Ejemplo_metodo_simplex_de_redes_279_0.png" src="../../_images/Ejemplo_metodo_simplex_de_redes_279_0.png" />
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">Ejercicios</p>
<p>1.Resuelve los ejercicios y preguntas de la nota.</p>
</div>
<p><strong>Referencias:</strong></p>
<ol class="simple">
<li><p>F. Hillier, G. Lieberman, Introduction to Operations Research, Mc Graw Hill, 2014.</p></li>
<li><p>R. K. Ahuja, T. L. Magnanti, J. B. Orlin, Network Flows, Theory, Algorithms and Applications, Prentice Hall, 1993.</p></li>
</ol>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "palmoreck/dockerfiles-for-binder",
            ref: "jupyterlab_optimizacion_2",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./IV.optimizacion_en_redes_y_prog_lineal/4.3"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../4.2/Programacion_lineal_y_metodo_simplex.html" title="previous page">4.2 Programación lineal (PL) y método símplex</a>
    <a class='right-next' id="next-link" href="../4.4/Dualidad_lema_de_Farkas_condiciones_KKT_de_optimalidad.html" title="next page">4.4 Dualidad, lema de Farkas y condiciones de Karush-Kuhn-Tucker (KKT) de optimalidad</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Erick Palacios Moreno<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>